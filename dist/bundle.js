!function(Q,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("ecstatic",[],n):"object"==typeof exports?exports.ecstatic=n():Q.ecstatic=n()}(window,(function(){return function(Q){var n=window.webpackHotUpdateecstatic;window.webpackHotUpdateecstatic=function(Q,e){!function(Q,n){if(!r[Q]||!a[Q])return;for(var e in a[Q]=!1,n)Object.prototype.hasOwnProperty.call(n,e)&&(o[e]=n[e]);0==--G&&0===u&&Z()}(Q,e),n&&n(Q,e)};var e,t=!0,B="e0d207f43be4a8ab5529",i={},F=[],s=[];function U(Q){var n=p[Q];if(!n)return W;var t=function(t){return n.hot.active?(p[t]?-1===p[t].parents.indexOf(Q)&&p[t].parents.push(Q):(F=[Q],e=t),-1===n.children.indexOf(t)&&n.children.push(t)):(console.warn("[HMR] unexpected require("+t+") from disposed module "+Q),F=[]),W(t)},B=function(Q){return{configurable:!0,enumerable:!0,get:function(){return W[Q]},set:function(n){W[Q]=n}}};for(var i in W)Object.prototype.hasOwnProperty.call(W,i)&&"e"!==i&&"t"!==i&&Object.defineProperty(t,i,B(i));return t.e=function(Q){return"ready"===d&&g("prepare"),u++,W.e(Q).then(n,(function(Q){throw n(),Q}));function n(){u--,"prepare"===d&&(y[Q]||V(Q),0===u&&0===G&&Z())}},t.t=function(Q,n){return 1&n&&(Q=t(Q)),W.t(Q,-2&n)},t}function c(n){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:e!==n,active:!0,accept:function(Q,n){if(void 0===Q)t._selfAccepted=!0;else if("function"==typeof Q)t._selfAccepted=Q;else if("object"==typeof Q)for(var e=0;e<Q.length;e++)t._acceptedDependencies[Q[e]]=n||function(){};else t._acceptedDependencies[Q]=n||function(){}},decline:function(Q){if(void 0===Q)t._selfDeclined=!0;else if("object"==typeof Q)for(var n=0;n<Q.length;n++)t._declinedDependencies[Q[n]]=!0;else t._declinedDependencies[Q]=!0},dispose:function(Q){t._disposeHandlers.push(Q)},addDisposeHandler:function(Q){t._disposeHandlers.push(Q)},removeDisposeHandler:function(Q){var n=t._disposeHandlers.indexOf(Q);n>=0&&t._disposeHandlers.splice(n,1)},invalidate:function(){switch(this._selfInvalidated=!0,d){case"idle":(o={})[n]=Q[n],g("ready");break;case"ready":E(n);break;case"prepare":case"check":case"dispose":case"apply":(C=C||[]).push(n)}},check:X,apply:R,status:function(Q){if(!Q)return d;I.push(Q)},addStatusHandler:function(Q){I.push(Q)},removeStatusHandler:function(Q){var n=I.indexOf(Q);n>=0&&I.splice(n,1)},data:i[n]};return e=void 0,t}var I=[],d="idle";function g(Q){d=Q;for(var n=0;n<I.length;n++)I[n].call(null,Q)}var l,o,b,C,G=0,u=0,y={},a={},r={};function x(Q){return+Q+""===Q?+Q:Q}function X(Q){if("idle"!==d)throw new Error("check() is only allowed in idle status");return t=Q,g("check"),(n=1e4,n=n||1e4,new Promise((function(Q,e){if("undefined"==typeof XMLHttpRequest)return e(new Error("No browser support"));try{var t=new XMLHttpRequest,B=W.p+"hot/hot-update.json";t.open("GET",B,!0),t.timeout=n,t.send(null)}catch(Q){return e(Q)}t.onreadystatechange=function(){if(4===t.readyState)if(0===t.status)e(new Error("Manifest request to "+B+" timed out."));else if(404===t.status)Q();else if(200!==t.status&&304!==t.status)e(new Error("Manifest request to "+B+" failed."));else{try{var n=JSON.parse(t.responseText)}catch(Q){return void e(Q)}Q(n)}}}))).then((function(Q){if(!Q)return g(L()?"ready":"idle"),null;a={},y={},r=Q.c,b=Q.h,g("prepare");var n=new Promise((function(Q,n){l={resolve:Q,reject:n}}));o={};return V(0),"prepare"===d&&0===u&&0===G&&Z(),n}));var n}function V(Q){var n;r[Q]?(a[Q]=!0,G++,(n=document.createElement("script")).charset="utf-8",n.src=W.p+"hot/hot-update.js",document.head.appendChild(n)):y[Q]=!0}function Z(){g("ready");var Q=l;if(l=null,Q)if(t)Promise.resolve().then((function(){return R(t)})).then((function(n){Q.resolve(n)}),(function(n){Q.reject(n)}));else{var n=[];for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&n.push(x(e));Q.resolve(n)}}function R(n){if("ready"!==d)throw new Error("apply() is only allowed in ready status");return function n(t){var s,U,c,I,d;function l(Q){for(var n=[Q],e={},t=n.map((function(Q){return{chain:[Q],id:Q}}));t.length>0;){var B=t.pop(),i=B.id,F=B.chain;if((I=p[i])&&(!I.hot._selfAccepted||I.hot._selfInvalidated)){if(I.hot._selfDeclined)return{type:"self-declined",chain:F,moduleId:i};if(I.hot._main)return{type:"unaccepted",chain:F,moduleId:i};for(var s=0;s<I.parents.length;s++){var U=I.parents[s],c=p[U];if(c){if(c.hot._declinedDependencies[i])return{type:"declined",chain:F.concat([U]),moduleId:i,parentId:U};-1===n.indexOf(U)&&(c.hot._acceptedDependencies[i]?(e[U]||(e[U]=[]),G(e[U],[i])):(delete e[U],n.push(U),t.push({chain:F.concat([U]),id:U})))}}}}return{type:"accepted",moduleId:Q,outdatedModules:n,outdatedDependencies:e}}function G(Q,n){for(var e=0;e<n.length;e++){var t=n[e];-1===Q.indexOf(t)&&Q.push(t)}}L();var u={},y=[],a={},X=function(){console.warn("[HMR] unexpected require("+Z.moduleId+") to disposed module")};for(var V in o)if(Object.prototype.hasOwnProperty.call(o,V)){var Z;d=x(V),Z=o[V]?l(d):{type:"disposed",moduleId:V};var R=!1,E=!1,A=!1,N="";switch(Z.chain&&(N="\nUpdate propagation: "+Z.chain.join(" -> ")),Z.type){case"self-declined":t.onDeclined&&t.onDeclined(Z),t.ignoreDeclined||(R=new Error("Aborted because of self decline: "+Z.moduleId+N));break;case"declined":t.onDeclined&&t.onDeclined(Z),t.ignoreDeclined||(R=new Error("Aborted because of declined dependency: "+Z.moduleId+" in "+Z.parentId+N));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(Z),t.ignoreUnaccepted||(R=new Error("Aborted because "+d+" is not accepted"+N));break;case"accepted":t.onAccepted&&t.onAccepted(Z),E=!0;break;case"disposed":t.onDisposed&&t.onDisposed(Z),A=!0;break;default:throw new Error("Unexception type "+Z.type)}if(R)return g("abort"),Promise.reject(R);if(E)for(d in a[d]=o[d],G(y,Z.outdatedModules),Z.outdatedDependencies)Object.prototype.hasOwnProperty.call(Z.outdatedDependencies,d)&&(u[d]||(u[d]=[]),G(u[d],Z.outdatedDependencies[d]));A&&(G(y,[Z.moduleId]),a[d]=X)}var m,h=[];for(U=0;U<y.length;U++)d=y[U],p[d]&&p[d].hot._selfAccepted&&a[d]!==X&&!p[d].hot._selfInvalidated&&h.push({module:d,parents:p[d].parents.slice(),errorHandler:p[d].hot._selfAccepted});g("dispose"),Object.keys(r).forEach((function(Q){!1===r[Q]&&function(Q){delete installedChunks[Q]}(Q)}));var S,D,H=y.slice();for(;H.length>0;)if(d=H.pop(),I=p[d]){var v={},f=I.hot._disposeHandlers;for(c=0;c<f.length;c++)(s=f[c])(v);for(i[d]=v,I.hot.active=!1,delete p[d],delete u[d],c=0;c<I.children.length;c++){var T=p[I.children[c]];T&&((m=T.parents.indexOf(d))>=0&&T.parents.splice(m,1))}}for(d in u)if(Object.prototype.hasOwnProperty.call(u,d)&&(I=p[d]))for(D=u[d],c=0;c<D.length;c++)S=D[c],(m=I.children.indexOf(S))>=0&&I.children.splice(m,1);g("apply"),void 0!==b&&(B=b,b=void 0);for(d in o=void 0,a)Object.prototype.hasOwnProperty.call(a,d)&&(Q[d]=a[d]);var Y=null;for(d in u)if(Object.prototype.hasOwnProperty.call(u,d)&&(I=p[d])){D=u[d];var z=[];for(U=0;U<D.length;U++)if(S=D[U],s=I.hot._acceptedDependencies[S]){if(-1!==z.indexOf(s))continue;z.push(s)}for(U=0;U<z.length;U++){s=z[U];try{s(D)}catch(Q){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:d,dependencyId:D[U],error:Q}),t.ignoreErrored||Y||(Y=Q)}}}for(U=0;U<h.length;U++){var k=h[U];d=k.module,F=k.parents,e=d;try{W(d)}catch(Q){if("function"==typeof k.errorHandler)try{k.errorHandler(Q)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:d,error:n,originalError:Q}),t.ignoreErrored||Y||(Y=n),Y||(Y=Q)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:d,error:Q}),t.ignoreErrored||Y||(Y=Q)}}if(Y)return g("fail"),Promise.reject(Y);if(C)return n(t).then((function(Q){return y.forEach((function(n){Q.indexOf(n)<0&&Q.push(n)})),Q}));return g("idle"),new Promise((function(Q){Q(y)}))}(n=n||{})}function L(){if(C)return o||(o={}),C.forEach(E),C=void 0,!0}function E(n){Object.prototype.hasOwnProperty.call(o,n)||(o[n]=Q[n])}var p={};function W(n){if(p[n])return p[n].exports;var e=p[n]={i:n,l:!1,exports:{},hot:c(n),parents:(s=F,F=[],s),children:[]};return Q[n].call(e.exports,e,e.exports,U(n)),e.l=!0,e.exports}return W.m=Q,W.c=p,W.d=function(Q,n,e){W.o(Q,n)||Object.defineProperty(Q,n,{enumerable:!0,get:e})},W.r=function(Q){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(Q,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Q,"__esModule",{value:!0})},W.t=function(Q,n){if(1&n&&(Q=W(Q)),8&n)return Q;if(4&n&&"object"==typeof Q&&Q&&Q.__esModule)return Q;var e=Object.create(null);if(W.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:Q}),2&n&&"string"!=typeof Q)for(var t in Q)W.d(e,t,function(n){return Q[n]}.bind(null,t));return e},W.n=function(Q){var n=Q&&Q.__esModule?function(){return Q.default}:function(){return Q};return W.d(n,"a",n),n},W.o=function(Q,n){return Object.prototype.hasOwnProperty.call(Q,n)},W.p="/static/",W.h=function(){return B},U(0)(W.s=0)}([function(Q,n,e){Q.exports=e(1)},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, "World", function() { return /* reexport */ World_World; });\n__webpack_require__.d(__webpack_exports__, "createEntity", function() { return /* reexport */ createEntity; });\n__webpack_require__.d(__webpack_exports__, "createSystem", function() { return /* reexport */ createSystem; });\n\n// CONCATENATED MODULE: ./src/ComponentCollection.ts\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nclass ComponentCollection {\n  constructor() {\n    _defineProperty(this, "components", new Map());\n\n    _defineProperty(this, "add", component => {\n      this.components.set(component.type, component);\n    });\n\n    _defineProperty(this, "update", (cType, func) => {\n      if (this.components.has(cType)) {\n        const c = this.components.get(cType);\n\n        if (c) {\n          const updatedComponent = func(c);\n          this.components.set(cType, updatedComponent);\n        }\n      }\n    });\n\n    _defineProperty(this, "remove", cType => {\n      this.components.delete(cType);\n    });\n\n    _defineProperty(this, "get", cType => {\n      if (!this.components.has(cType)) {\n        throw new Error(`ComponentCollection does not have component of type ${cType}`);\n      }\n\n      return this.components.get(cType);\n    });\n\n    _defineProperty(this, "has", cType => {\n      if (Array.isArray(cType)) {\n        return cType.every(ct => this.components.has(ct) === true);\n      } else {\n        return this.components.has(cType);\n      }\n    });\n  }\n\n  get componentTypes() {\n    return [...this.components.keys()];\n  }\n\n  get size() {\n    return this.components.size;\n  }\n\n}\n// CONCATENATED MODULE: ./src/World.ts\nfunction World_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\nclass World_World {\n  constructor() {\n    World_defineProperty(this, "componentCollections", new Map());\n\n    World_defineProperty(this, "entities", new Map());\n\n    World_defineProperty(this, "entitiesByCTypes", new Map());\n\n    World_defineProperty(this, "entitiesByTags", new Map());\n\n    World_defineProperty(this, "find", predicate => {\n      for (const entity of this.entities.values()) {\n        if (predicate(entity)) {\n          return entity;\n        }\n      }\n\n      return null;\n    });\n\n    World_defineProperty(this, "findAll", predicate => {\n      const results = [];\n\n      for (const entity of this.entities.values()) {\n        if (predicate(entity)) {\n          results.push(entity);\n        }\n      }\n\n      return results;\n    });\n\n    World_defineProperty(this, "locate", cTypes => {\n      for (const entity of this.entities.values()) {\n        if (entity.components.has(cTypes)) {\n          return entity;\n        }\n      }\n\n      return null;\n    });\n\n    World_defineProperty(this, "locateAll", cTypes => {\n      const results = [];\n\n      for (const entity of this.entities.values()) {\n        if (entity.components.has(cTypes)) {\n          results.push(entity);\n        }\n      }\n\n      return results;\n    });\n\n    World_defineProperty(this, "grab", cType => {\n      const entity = this.locate(cType);\n\n      if (entity) {\n        const cc = this.componentCollections.get(entity.id) || new ComponentCollection();\n        const component = cc.get(cType);\n        return {\n          entity,\n          component\n        };\n      }\n\n      return null;\n    });\n\n    World_defineProperty(this, "grabBy", (cType, predicate) => {\n      const entities = this.locateAll(cType);\n\n      for (const entity of entities) {\n        const cc = this.componentCollections.get(entity.id) || new ComponentCollection();\n        const component = cc.get(cType);\n\n        if (predicate(component)) {\n          return {\n            component,\n            entity\n          };\n        }\n      }\n\n      return null;\n    });\n\n    World_defineProperty(this, "grabAll", cType => {\n      return this.locateAll(cType).map(entity => ({\n        entity,\n        component: entity.components.get(cType)\n      }));\n    });\n\n    World_defineProperty(this, "get", (eid, cType) => {\n      const cc = this.componentCollections.get(eid) || new ComponentCollection();\n      return cc.get(cType);\n    });\n\n    World_defineProperty(this, "getTagged", tag => {\n      const tagEntityIds = this.entitiesByTags.get(tag);\n\n      if (tagEntityIds) {\n        const entityId = tagEntityIds.values().next().value;\n        const entity = this.entities.get(entityId);\n\n        if (entity) {\n          return entity;\n        }\n      }\n\n      return null;\n    });\n\n    World_defineProperty(this, "getAllTagged", tag => {\n      let entities = []; // eslint-disable-line\n\n      const tagEntityIds = this.entitiesByTags.get(tag);\n\n      if (tagEntityIds) {\n        for (const entityId of tagEntityIds) {\n          const entity = this.entities.get(entityId);\n\n          if (entity) {\n            entities.push(entity);\n          }\n        }\n      }\n\n      return entities;\n    });\n\n    World_defineProperty(this, "set", (eid, component) => {\n      const cc = this.componentCollections.get(eid) || new ComponentCollection();\n      cc.add(component);\n      this.componentCollections.set(eid, cc);\n\n      for (const [ctArr, entitySet] of this.entitiesByCTypes) {\n        if (ctArr.every(cc.has)) {\n          entitySet.add(eid);\n        }\n      }\n\n      return this;\n    });\n\n    World_defineProperty(this, "remove", (eid, cType) => {\n      const cc = this.componentCollections.get(eid) || new ComponentCollection(); // remove entity from current entitiesByCTypes\n\n      for (const [ctArr, entitySet] of this.entitiesByCTypes) {\n        if (ctArr.every(cc.has)) {\n          entitySet.delete(eid);\n        }\n      }\n\n      cc.remove(cType); // Move entityId to new CTypes if needed.\n\n      for (const [ctArr, entitySet] of this.entitiesByCTypes) {\n        if (ctArr.every(cc.has)) {\n          entitySet.add(eid);\n        }\n      }\n    });\n  }\n\n  /**\n   * Internal method used in setting up a new system.\n   */\n  registerSystem(cTypes) {\n    this.entitiesByCTypes.set(cTypes, new Set());\n    return this;\n  }\n\n  registerEntity(entity) {\n    const cc = new ComponentCollection();\n    this.componentCollections.set(entity.id, cc);\n    this.entities.set(entity.id, entity);\n    return this;\n  }\n  /**\n   * Remove all components that belong to an entity.\n   */\n\n\n  clearEntityComponents(eid) {\n    this.componentCollections.set(eid, new ComponentCollection());\n\n    for (const entitySet of this.entitiesByCTypes.values()) {\n      if (entitySet.has(eid)) {\n        entitySet.delete(eid);\n      }\n    }\n\n    return this;\n  }\n  /**\n   * Destroys an entity.\n   * Same as entity.destroy().\n   */\n\n\n  destroyEntity(eid) {\n    this.componentCollections.delete(eid);\n    this.entities.delete(eid);\n\n    for (const entitySet of this.entitiesByCTypes.values()) {\n      if (entitySet.has(eid)) {\n        entitySet.delete(eid);\n      }\n    } // remove any tag associations with destroyed entities.\n\n\n    for (const [tag, entitySet] of this.entitiesByTags) {\n      if (entitySet.has(eid)) {\n        entitySet.delete(eid);\n      }\n\n      if (entitySet.size === 0) {\n        this.entitiesByTags.delete(tag);\n      }\n    }\n\n    return this;\n  }\n\n}\n// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/rng.js\n// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\n// getRandomValues needs to be invoked in a context where "this" is a Crypto implementation. Also,\n// find the complete implementation of crypto (msCrypto) on IE11.\nvar getRandomValues = typeof crypto !== \'undefined\' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== \'undefined\' && typeof msCrypto.getRandomValues === \'function\' && msCrypto.getRandomValues.bind(msCrypto);\nvar rnds8 = new Uint8Array(16);\nfunction rng() {\n  if (!getRandomValues) {\n    throw new Error(\'crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported\');\n  }\n\n  return getRandomValues(rnds8);\n}\n// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/bytesToUuid.js\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\n\nfor (var bytesToUuid_i = 0; bytesToUuid_i < 256; ++bytesToUuid_i) {\n  byteToHex.push((bytesToUuid_i + 0x100).toString(16).substr(1));\n}\n\nfunction bytesToUuid(buf, offset_) {\n  var offset = offset_ || 0; // Note: Be careful editing this code!  It\'s been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n\n  return (byteToHex[buf[offset + 0]] + byteToHex[buf[offset + 1]] + byteToHex[buf[offset + 2]] + byteToHex[buf[offset + 3]] + \'-\' + byteToHex[buf[offset + 4]] + byteToHex[buf[offset + 5]] + \'-\' + byteToHex[buf[offset + 6]] + byteToHex[buf[offset + 7]] + \'-\' + byteToHex[buf[offset + 8]] + byteToHex[buf[offset + 9]] + \'-\' + byteToHex[buf[offset + 10]] + byteToHex[buf[offset + 11]] + byteToHex[buf[offset + 12]] + byteToHex[buf[offset + 13]] + byteToHex[buf[offset + 14]] + byteToHex[buf[offset + 15]]).toLowerCase();\n}\n\n/* harmony default export */ var esm_browser_bytesToUuid = (bytesToUuid);\n// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/v4.js\n\n\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return esm_browser_bytesToUuid(rnds);\n}\n\n/* harmony default export */ var esm_browser_v4 = (v4);\n// CONCATENATED MODULE: ./src/Entity.ts\nfunction Entity_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\nclass Entity_Entity {\n  constructor(world) {\n    Entity_defineProperty(this, "_id", void 0);\n\n    Entity_defineProperty(this, "_world", void 0);\n\n    this._id = esm_browser_v4();\n    this._world = world;\n    /*\n    Registering with the World.\n    */\n\n    this._world.registerEntity(this);\n  }\n  /**\n   * Add a component to an Entity, doh.\n   */\n\n\n  add(component) {\n    this._world.set(this._id, component);\n\n    return this;\n  }\n  /**\n   * Add a tag to a component\n   */\n\n\n  addTag(tag) {\n    const entitySet = this._world.entitiesByTags.has(tag) ? this._world.entitiesByTags.get(tag) : new Set();\n\n    if (entitySet) {\n      entitySet.add(this._id);\n\n      this._world.entitiesByTags.set(tag, entitySet);\n    }\n\n    return this;\n  }\n  /**\n   * Determines if an entity has a component related to it.\n   */\n\n\n  has(cType) {\n    const cc = this._world.componentCollections.get(this._id) || new ComponentCollection();\n    return cc.has(cType);\n  }\n  /**\n   * Check to see if an entity tagged with a given tag.\n   */\n\n\n  hasTag(tag) {\n    if (this._world.entitiesByTags.has(tag)) {\n      const entitySet = this._world.entitiesByTags.get(tag);\n\n      if (entitySet) {\n        return entitySet.has(this._id);\n      }\n    }\n\n    return false;\n  }\n  /**\n   * Get a component that belongs to an entity.\n   */\n\n\n  get(cType) {\n    const cc = this._world.componentCollections.get(this._id) || new ComponentCollection();\n    const component = cc.get(cType);\n    return component;\n  }\n  /**\n   * Get all components that have been added to an entity, via a ComponentCollection\n   */\n\n\n  getAll() {\n    return this._world.componentCollections.get(this._id) || new ComponentCollection();\n  }\n\n  remove(cType) {\n    this._world.remove(this._id, cType);\n\n    return this;\n  }\n  /**\n   * Remove a tag from an entity\n   */\n\n\n  removeTag(tag) {\n    if (this._world.entitiesByTags.has(tag)) {\n      const entitySet = this._world.entitiesByTags.get(tag);\n\n      if (entitySet) {\n        entitySet.delete(this._id);\n\n        if (entitySet.size === 0) {\n          this._world.entitiesByTags.delete(tag);\n        }\n      }\n    }\n\n    return this;\n  }\n  /** Clears all components from an Entity */\n\n\n  clear() {\n    this._world.clearEntityComponents(this._id);\n\n    return this;\n  }\n  /**\n   * Remove all tags on an entity\n   */\n\n\n  clearTags() {\n    for (const [tag, entitySet] of this._world.entitiesByTags.entries()) {\n      entitySet.delete(this._id);\n\n      if (entitySet.size === 0) {\n        this._world.entitiesByTags.delete(tag);\n      }\n    }\n\n    return this;\n  }\n\n  destroy() {\n    this._world.destroyEntity(this._id);\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  get world() {\n    return this._world;\n  }\n  /**\n   * Get all components that have been added to an entity, via a ComponentCollection.\n   * Does the same thing as entityInstance.getAll().\n   */\n\n\n  get components() {\n    return this._world.componentCollections.get(this._id) || new ComponentCollection();\n  }\n  /**\n   * Retrieves all the tags that have been added to this entity.\n   */\n\n\n  get tags() {\n    const tags = new Set();\n\n    for (const [tag, entitySet] of this._world.entitiesByTags.entries()) {\n      if (entitySet.has(this._id)) {\n        tags.add(tag);\n      }\n    }\n\n    return tags;\n  }\n\n}\nfunction createEntity(world) {\n  const entity = new Entity_Entity(world);\n  return entity;\n}\n// CONCATENATED MODULE: ./src/System.ts\n\n\n\n/**\n * This is how you create a System.\n * @example\n * ```\n * createSystem(world, [\'ComponentType\'], ({ entity }) => \'Do fun system things here.\')\n * ```\n */\nfunction createSystem(world, cTypes, systemFunc) {\n  world.registerSystem(cTypes);\n  return () => {\n    let index = 0;\n    const size = world.entitiesByCTypes.size; // Used for matching the array of ComponentTypes which is the key\n    // of where the ComponentCollection is, with the array of ComponentTypes\n    // that are passes.\n    // Might be nice in the future to go back to a ref check on cTypes, but\n    // for now this doesn\'t seem to be that much of a perf hit.\n    // for (const ct of world.entitiesByCTypes.keys()) {\n    //   if (cTypes.length === ct.length && cTypes.every(c => ct.includes(c))) {\n    //     for (const eid of world.entitiesByCTypes.get(cTypes)) {\n    //       const args: SystemFuncArgs<CT> = {\n    //         entity: world.entities.get(eid),\n    //         components: world.componentCollections.get(eid),\n    //         world,\n    //         index,\n    //         size,\n    //         isFirst: index === 0,\n    //         isLast: index + 1 === size,\n    //       }\n    //       systemFunc(args);\n    //       index += 1;\n    //     }\n    //   }\n    // }\n\n    const cTypeArrs = world.entitiesByCTypes.get(cTypes) || new Set();\n\n    for (const eid of cTypeArrs) {\n      const args = {\n        entity: world.entities.get(eid) || new Entity_Entity(world),\n        components: world.componentCollections.get(eid) || new ComponentCollection(),\n        world,\n        index,\n        size,\n        isFirst: index === 0,\n        isLast: index + 1 === size\n      };\n      systemFunc(args);\n      index += 1;\n    }\n  };\n}\n// CONCATENATED MODULE: ./src/index.ts\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9lY3N0YXRpYy8uL3NyYy9Db21wb25lbnRDb2xsZWN0aW9uLnRzPzUxYzQiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9zcmMvV29ybGQudHM/Y2MwYiIsIndlYnBhY2s6Ly9lY3N0YXRpYy8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvcm5nLmpzP2Q4ZjgiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL2J5dGVzVG9VdWlkLmpzP2I2OTEiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3Y0LmpzP2VjMjYiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9zcmMvRW50aXR5LnRzP2FjNjgiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9zcmMvU3lzdGVtLnRzPzMyNDgiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9zcmMvaW5kZXgudHM/ZmZiNCJdLCJuYW1lcyI6WyJDb21wb25lbnRDb2xsZWN0aW9uIiwiTWFwIiwiY29tcG9uZW50IiwiY29tcG9uZW50cyIsInNldCIsInR5cGUiLCJjVHlwZSIsImZ1bmMiLCJoYXMiLCJjIiwiZ2V0IiwidXBkYXRlZENvbXBvbmVudCIsImRlbGV0ZSIsIkVycm9yIiwiQXJyYXkiLCJpc0FycmF5IiwiZXZlcnkiLCJjdCIsImNvbXBvbmVudFR5cGVzIiwia2V5cyIsInNpemUiLCJXb3JsZCIsInByZWRpY2F0ZSIsImVudGl0eSIsImVudGl0aWVzIiwidmFsdWVzIiwicmVzdWx0cyIsInB1c2giLCJjVHlwZXMiLCJsb2NhdGUiLCJjYyIsImNvbXBvbmVudENvbGxlY3Rpb25zIiwiaWQiLCJsb2NhdGVBbGwiLCJtYXAiLCJlaWQiLCJ0YWciLCJ0YWdFbnRpdHlJZHMiLCJlbnRpdGllc0J5VGFncyIsImVudGl0eUlkIiwibmV4dCIsInZhbHVlIiwiYWRkIiwiY3RBcnIiLCJlbnRpdHlTZXQiLCJlbnRpdGllc0J5Q1R5cGVzIiwicmVtb3ZlIiwicmVnaXN0ZXJTeXN0ZW0iLCJTZXQiLCJyZWdpc3RlckVudGl0eSIsImNsZWFyRW50aXR5Q29tcG9uZW50cyIsImRlc3Ryb3lFbnRpdHkiLCJFbnRpdHkiLCJjb25zdHJ1Y3RvciIsIndvcmxkIiwiX2lkIiwidXVpZHY0IiwiX3dvcmxkIiwiYWRkVGFnIiwiaGFzVGFnIiwiZ2V0QWxsIiwicmVtb3ZlVGFnIiwiY2xlYXIiLCJjbGVhclRhZ3MiLCJlbnRyaWVzIiwiZGVzdHJveSIsInRhZ3MiLCJjcmVhdGVFbnRpdHkiLCJjcmVhdGVTeXN0ZW0iLCJzeXN0ZW1GdW5jIiwiaW5kZXgiLCJjVHlwZUFycnMiLCJhcmdzIiwiaXNGaXJzdCIsImlzTGFzdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFFZSxNQUFNQSxtQkFBTixDQUE4QjtBQUFBO0FBQUEsd0NBQ0UsSUFBSUMsR0FBSixFQURGOztBQUFBLGlDQUdwQ0MsU0FBRCxJQUFvQztBQUN4QyxXQUFLQyxVQUFMLENBQWdCQyxHQUFoQixDQUFvQkYsU0FBUyxDQUFDRyxJQUE5QixFQUFvQ0gsU0FBcEM7QUFDRCxLQUwwQzs7QUFBQSxvQ0FPbEMsQ0FBQ0ksS0FBRCxFQUFZQyxJQUFaLEtBQWdFO0FBQ3ZFLFVBQUksS0FBS0osVUFBTCxDQUFnQkssR0FBaEIsQ0FBb0JGLEtBQXBCLENBQUosRUFBZ0M7QUFDOUIsY0FBTUcsQ0FBQyxHQUFHLEtBQUtOLFVBQUwsQ0FBZ0JPLEdBQWhCLENBQW9CSixLQUFwQixDQUFWOztBQUVBLFlBQUlHLENBQUosRUFBTztBQUNMLGdCQUFNRSxnQkFBZ0IsR0FBR0osSUFBSSxDQUFDRSxDQUFELENBQTdCO0FBQ0EsZUFBS04sVUFBTCxDQUFnQkMsR0FBaEIsQ0FBb0JFLEtBQXBCLEVBQTJCSyxnQkFBM0I7QUFDRDtBQUNGO0FBQ0YsS0FoQjBDOztBQUFBLG9DQWtCakNMLEtBQUQsSUFBcUI7QUFDNUIsV0FBS0gsVUFBTCxDQUFnQlMsTUFBaEIsQ0FBdUJOLEtBQXZCO0FB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QUEvQixLQUF1QyxJQUFJbkMsbUJBQUosRUFGcEI7QUFHL0JzRCxhQUgrQjtBQUkvQmdCLGFBSitCO0FBSy9CbEQsWUFMK0I7QUFNL0JxRCxlQUFPLEVBQUVILEtBQUssS0FBSyxDQU5ZO0FBTy9CSSxjQUFNLEVBQUVKLEtBQUssR0FBRyxDQUFSLEtBQWNsRDtBQVBTLE9BQWpDO0FBVUFpRCxnQkFBVSxDQUFDRyxJQUFELENBQVY7QUFFQUYsV0FBSyxJQUFJLENBQVQ7QUFDRDtBQUNGLEdBOUNEO0FBK0NELEM7O0FDNUdEO0FBQ0E7QUFDQSIsImZpbGUiOiIxLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9Db21wb25lbnQnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21wb25lbnRDb2xsZWN0aW9uPENUPiB7XG4gIHByaXZhdGUgY29tcG9uZW50czogTWFwPENULCBDb21wb25lbnQ8Q1Q+PiA9IG5ldyBNYXAoKTtcblxuICBhZGQgPSAoY29tcG9uZW50OiBDb21wb25lbnQ8Q1Q+KTogdm9pZCA9PiB7XG4gICAgdGhpcy5jb21wb25lbnRzLnNldChjb21wb25lbnQudHlwZSwgY29tcG9uZW50KTtcbiAgfVxuXG4gIHVwZGF0ZSA9IChjVHlwZTogQ1QsIGZ1bmM6IChjOiBDb21wb25lbnQ8Q1Q+KSA9PiBDb21wb25lbnQ8Q1Q+KTogdm9pZCA9PiB7XG4gICAgaWYgKHRoaXMuY29tcG9uZW50cy5oYXMoY1R5cGUpKSB7XG4gICAgICBjb25zdCBjID0gdGhpcy5jb21wb25lbnRzLmdldChjVHlwZSk7XG5cbiAgICAgIGlmIChjKSB7XG4gICAgICAgIGNvbnN0IHVwZGF0ZWRDb21wb25lbnQgPSBmdW5jKGMpO1xuICAgICAgICB0aGlzLmNvbXBvbmVudHMuc2V0KGNUeXBlLCB1cGRhdGVkQ29tcG9uZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcmVtb3ZlID0gKGNUeXBlOiBDVCk6IHZvaWQgPT4ge1xuICAgIHRoaXMuY29tcG9uZW50cy5kZWxldGUoY1R5cGUpO1xuICB9XG5cbiAgZ2V0ID0gPEM+KGNUeXBlOiBDVCk6IEMgPT4ge1xuICAgIGlmICghdGhpcy5jb21wb25lbnRzLmhhcyhjVHlwZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ29tcG9uZW50Q29sbGVjdGlvbiBkb2VzIG5vdCBoYXZlIGNvbXBvbmVudCBvZiB0eXBlICR7Y1R5cGV9YClcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRoaXMuY29tcG9uZW50cy5nZXQoY1R5cGUpIGFzIHVua25vd24gYXMgQztcbiAgfVxuXG4gIGhhcyA9IChjVHlwZTogQ1QgfCBDVFtdKTogYm9vbGVhbiA9PiB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoY1R5cGUpKSB7XG4gICAgICByZXR1cm4gY1R5cGUuZXZlcnkoKGN0KSA9PiB0aGlzLmNvbXBvbmVudHMuaGFzKGN0KSA9PT0gdHJ1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudHMuaGFzKGNUeXBlKVxuICAgIH1cbiAgfVxuXG4gIGdldCBjb21wb25lbnRUeXBlcygpOiBDVFtdIHtcbiAgICByZXR1cm4gWy4uLnRoaXMuY29tcG9uZW50cy5rZXlzKCldO1xuICB9XG5cbiAgZ2V0IHNpemUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jb21wb25lbnRzLnNpemU7XG4gIH1cbn1cbiIsImltcG9ydCBFbnRpdHksIHsgRW50aXR5SWQgfSBmcm9tICcuL0VudGl0eSc7XG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICcuL0NvbXBvbmVudCc7XG5pbXBvcnQgQ29tcG9uZW50Q29sbGVjdGlvbiBmcm9tICcuL0NvbXBvbmVudENvbGxlY3Rpb24nO1xuaW1wb3J0IHsgVGFnIH0gZnJvbSAnLi9UYWcnO1xuXG50eXBlIEZpbmRQcmVkaWNhdGU8Q1Q+ID0gKGVudGl0eTogRW50aXR5PENUPikgPT4gYm9vbGVhbjtcblxudHlwZSBHcmFiUHJlZGljYXRlPEM+ID0gKGNvbXBvbmVudDogQykgPT4gYm9vbGVhbjtcblxuaW50ZXJmYWNlIFNpbmdsZUNvbXBvbmVudFJlc3A8Q1QsIEM+IHtcbiAgZW50aXR5OiBFbnRpdHk8Q1Q+O1xuICBjb21wb25lbnQ6IEM7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFdvcmxkPENUPiB7XG4gIGNvbXBvbmVudENvbGxlY3Rpb25zOiBNYXA8RW50aXR5SWQsIENvbXBvbmVudENvbGxlY3Rpb248Q1Q+PiA9IG5ldyBNYXAoKTtcblxuICBlbnRpdGllczogTWFwPEVudGl0eUlkLCBFbnRpdHk8Q1Q+PiA9IG5ldyBNYXAoKTtcblxuICBlbnRpdGllc0J5Q1R5cGVzOiBNYXA8Q1RbXSwgU2V0PEVudGl0eUlkPj4gPSBuZXcgTWFwKCk7XG5cbiAgZW50aXRpZXNCeVRhZ3M6IE1hcDxUYWcsIFNldDxFbnRpdHlJZD4+ID0gbmV3IE1hcCgpO1xuXG4gIC8qKlxuICAgKiBcImZpbmRzXCIgYSBzaW5nbGUgZW50aXR5IGJhc2VkIG9uIGEgcHJlZGljYXRlXG4gICAqL1xuICBmaW5kID0gKHByZWRpY2F0ZTogRmluZFByZWRpY2F0ZTxDVD4pOiBFbnRpdHk8Q1Q+IHwgbnVsbCA9PiB7XG4gICAgZm9yIChjb25zdCBlbnRpdHkgb2YgdGhpcy5lbnRpdGllcy52YWx1ZXMoKSkge1xuICAgICAgaWYgKHByZWRpY2F0ZShlbnRpdHkpKSB7XG4gICAgICAgIHJldHVybiBlbnRpdHk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG5cbiAgLyoqXG4gICAqIFwiZmluZHNcIiBhbGwgZW50aXRpZXMgYmFzZWQgb24gYSBwcmVkaWNhdGUsIGtpbmRhIGxpa2UgZmlsdGVyLlxuICAgKi9cbiAgZmluZEFsbCA9IChwcmVkaWNhdGU6IEZpbmRQcmVkaWNhdGU8Q1Q+KTogRW50aXR5PENUPltdID0+IHtcbiAgICBjb25zdCByZXN1bHRzOiBFbnRpdHk8Q1Q+W10gPSBbXTtcblxuICAgIGZvciAoY29uc3QgZW50aXR5IG9mIHRoaXMuZW50aXRpZXMudmFsdWVzKCkpIHtcbiAgICAgIGlmIChwcmVkaWNhdGUoZW50aXR5KSkge1xuICAgICAgICByZXN1bHRzLnB1c2goZW50aXR5KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfTtcblxuICAvKipcbiAgICogXCJsb2NhdGVzXCIgYSBzaW5nbGUgZW50aXR5IGJhc2VkIG9uIGl0cyBDb21wb25lbnRzLlxuICAgKi9cbiAgbG9jYXRlID0gKGNUeXBlczogQ1QgfCBDVFtdKTogRW50aXR5PENUPiB8IG51bGwgPT4ge1xuICAgIGZvciAoY29uc3QgZW50aXR5IG9mIHRoaXMuZW50aXRpZXMudmFsdWVzKCkpIHtcbiAgICAgIGlmIChlbnRpdHkuY29tcG9uZW50cy5oYXMoY1R5cGVzKSkge1xuICAgICAgICByZXR1cm4gZW50aXR5O1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIC8qKlxuICAgKiBMb2NhdGVzIGFsbCBlbnRpdGllcyB0aGF0IGNvbnRhaW4gdGhlIGNvbXBvbmVudHMgbmFtZWRcbiAgICovXG4gIGxvY2F0ZUFsbCA9IChjVHlwZXM6IENUIHwgQ1RbXSk6IEVudGl0eTxDVD5bXSA9PiB7XG4gICAgY29uc3QgcmVzdWx0czogRW50aXR5PENUPltdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGVudGl0eSBvZiB0aGlzLmVudGl0aWVzLnZhbHVlcygpKSB7XG4gICAgICBpZiAoZW50aXR5LmNvbXBvbmVudHMuaGFzKGNUeXBlcykpIHtcbiAgICAgICAgcmVzdWx0cy5wdXNoKGVudGl0eSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdyYWJzIHRoZSBmaXJzdCBlbnRpdHksIGFuZCBpdHMgcmVsYXRlZCBjb21wb25lbnQsIHRoYXQgbWF0Y2hlcyB0aGUgY29tcG9uZW50IHR5cGUuXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYFxuICAgKiBjb25zdCB7IGVudGl0eSwgY29tcG9uZW50IH0gPSB3b3JsZC5ncmFiPE15Q29tcG9uZW50PihDb21wb25lbnRzLk15Q29tcG9uZW50KTtcbiAgICogYGBgXG4gICAqL1xuICBncmFiID0gPEM+KGNUeXBlOiBDVCk6IFNpbmdsZUNvbXBvbmVudFJlc3A8Q1QsIEM+IHwgbnVsbCA9PiB7XG4gICAgY29uc3QgZW50aXR5ID0gdGhpcy5sb2NhdGUoY1R5cGUpO1xuXG4gICAgaWYgKGVudGl0eSkge1xuICAgICAgY29uc3QgY2MgPVxuICAgICAgICB0aGlzLmNvbXBvbmVudENvbGxlY3Rpb25zLmdldChlbnRpdHkuaWQpIHx8XG4gICAgICAgIG5ldyBDb21wb25lbnRDb2xsZWN0aW9uPENUPigpO1xuXG4gICAgICBjb25zdCBjb21wb25lbnQgPSBjYy5nZXQ8Qz4oY1R5cGUpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBlbnRpdHksXG4gICAgICAgIGNvbXBvbmVudCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdyYWIgc2luZ2xlIGNvbXBvbmVudCBiYXNlZCBvbiBjb21wb25lbnQgdHlwZSBhbmQgcHJlZGljYXRlLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IHsgZW50aXR5LCBjb21wb25lbnQgfSA9IHdvcmxkLmdyYWJCeShDb21wb25lbnRzLkZpcnN0Q29tcG9uZW50LCAoY29tcCkgPT4gY29tcC5pZCA9PSAnYXdlc29tZScpXG4gICAqIGBgYFxuICAgKi9cbiAgZ3JhYkJ5ID0gPEM+KFxuICAgIGNUeXBlOiBDVCxcbiAgICBwcmVkaWNhdGU6IEdyYWJQcmVkaWNhdGU8Qz5cbiAgKTogU2luZ2xlQ29tcG9uZW50UmVzcDxDVCwgQz4gfCBudWxsID0+IHtcbiAgICBjb25zdCBlbnRpdGllcyA9IHRoaXMubG9jYXRlQWxsKGNUeXBlKTtcblxuICAgIGZvciAoY29uc3QgZW50aXR5IG9mIGVudGl0aWVzKSB7XG4gICAgICBjb25zdCBjYyA9XG4gICAgICAgIHRoaXMuY29tcG9uZW50Q29sbGVjdGlvbnMuZ2V0KGVudGl0eS5pZCkgfHxcbiAgICAgICAgbmV3IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+KCk7XG5cbiAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGNjLmdldDxDPihjVHlwZSk7XG5cbiAgICAgIGlmIChwcmVkaWNhdGUoY29tcG9uZW50KSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGNvbXBvbmVudCxcbiAgICAgICAgICBlbnRpdHksXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdyYWIgYWxsIHRoZSBjb21wb25lbnRzIHByaW1hcmlseSwgYW5kIHRoZSBlbnRpdGllcyBpZiBuZWVkZWRcbiAgICovXG4gIGdyYWJBbGwgPSA8Qz4oY1R5cGU6IENUKTogU2luZ2xlQ29tcG9uZW50UmVzcDxDVCwgQz5bXSA9PiB7XG4gICAgcmV0dXJuIHRoaXMubG9jYXRlQWxsKGNUeXBlKS5tYXAoKGVudGl0eSkgPT4gKHtcbiAgICAgIGVudGl0eSxcbiAgICAgIGNvbXBvbmVudDogKGVudGl0eS5jb21wb25lbnRzLmdldChjVHlwZSkgYXMgdW5rbm93bikgYXMgQyxcbiAgICB9KSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdpdmVuIGFuIGVudGl0eSBpZCBhbmQgY29tcG9uZW50VHlwZSwgcmV0dXJucyBjb21wb25lbnRcbiAgICovXG4gIGdldCA9IDxDPihlaWQ6IEVudGl0eUlkLCBjVHlwZTogQ1QpOiBDID0+IHtcbiAgICBjb25zdCBjYyA9XG4gICAgICB0aGlzLmNvbXBvbmVudENvbGxlY3Rpb25zLmdldChlaWQpIHx8IG5ldyBDb21wb25lbnRDb2xsZWN0aW9uPENUPigpO1xuXG4gICAgcmV0dXJuIGNjLmdldDxDPihjVHlwZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdldCBhbiBlbnRpdHkgdGhhdCBoYXMgYmVlbiB0YWdnZWQgd2l0aCB0aGUgZ2l2ZW4gdGFnLCBvciByZXR1cm4gbnVsbDtcbiAgICovXG4gIGdldFRhZ2dlZCA9ICh0YWc6IFRhZyk6IEVudGl0eTxDVD4gfCBudWxsID0+IHtcbiAgICBjb25zdCB0YWdFbnRpdHlJZHMgPSB0aGlzLmVudGl0aWVzQnlUYWdzLmdldCh0YWcpO1xuXG4gICAgaWYgKHRhZ0VudGl0eUlkcykge1xuICAgICAgY29uc3QgZW50aXR5SWQgPSB0YWdFbnRpdHlJZHMudmFsdWVzKCkubmV4dCgpLnZhbHVlO1xuXG4gICAgICBjb25zdCBlbnRpdHkgPSB0aGlzLmVudGl0aWVzLmdldChlbnRpdHlJZCk7XG5cbiAgICAgIGlmIChlbnRpdHkpIHtcbiAgICAgICAgcmV0dXJuIGVudGl0eTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGdldEFsbFRhZ2dlZCA9ICh0YWc6IFRhZyk6IEVudGl0eTxDVD5bXSA9PiB7XG4gICAgbGV0IGVudGl0aWVzOiBFbnRpdHk8Q1Q+W10gPSBbXTsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gICAgY29uc3QgdGFnRW50aXR5SWRzID0gdGhpcy5lbnRpdGllc0J5VGFncy5nZXQodGFnKTtcblxuICAgIGlmICh0YWdFbnRpdHlJZHMpIHtcbiAgICAgIGZvciAoY29uc3QgZW50aXR5SWQgb2YgdGFnRW50aXR5SWRzKSB7XG4gICAgICAgIGNvbnN0IGVudGl0eSA9IHRoaXMuZW50aXRpZXMuZ2V0KGVudGl0eUlkKTtcbiAgICAgICAgaWYgKGVudGl0eSkge1xuICAgICAgICAgIGVudGl0aWVzLnB1c2goZW50aXR5KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBlbnRpdGllcztcbiAgfVxuXG4gIC8qKlxuICAgKiBTZXQgYSBjb21wb25lbnQgb24gdGhlIGdpdmVuIGVudGl0eVxuICAgKi9cbiAgc2V0ID0gKGVpZDogRW50aXR5SWQsIGNvbXBvbmVudDogQ29tcG9uZW50PENUPik6IFdvcmxkPENUPiA9PiB7XG4gICAgY29uc3QgY2MgPVxuICAgICAgdGhpcy5jb21wb25lbnRDb2xsZWN0aW9ucy5nZXQoZWlkKSB8fCBuZXcgQ29tcG9uZW50Q29sbGVjdGlvbjxDVD4oKTtcblxuICAgIGNjLmFkZChjb21wb25lbnQpO1xuXG4gICAgdGhpcy5jb21wb25lbnRDb2xsZWN0aW9ucy5zZXQoZWlkLCBjYyk7XG5cbiAgICBmb3IgKGNvbnN0IFtjdEFyciwgZW50aXR5U2V0XSBvZiB0aGlzLmVudGl0aWVzQnlDVHlwZXMpIHtcbiAgICAgIGlmIChjdEFyci5ldmVyeShjYy5oYXMpKSB7XG4gICAgICAgIGVudGl0eVNldC5hZGQoZWlkKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlIGEgY29tcG9uZW50IGZyb20gdGhlIGdpdmVuIGVudGl0eS5cbiAgICogTk9URTogVGhpcyB3aWxsIGNoYW5nZSB3aGF0IHN5c3RlbXMgd2lsbCBiZSBjYWxsZWQgb24gdGhlIGVudGl0eS5cbiAgICovXG4gIHJlbW92ZSA9IChlaWQ6IEVudGl0eUlkLCBjVHlwZTogQ1QpOiB2b2lkID0+IHtcbiAgICBjb25zdCBjYyA9XG4gICAgICB0aGlzLmNvbXBvbmVudENvbGxlY3Rpb25zLmdldChlaWQpIHx8IG5ldyBDb21wb25lbnRDb2xsZWN0aW9uPENUPigpO1xuXG4gICAgLy8gcmVtb3ZlIGVudGl0eSBmcm9tIGN1cnJlbnQgZW50aXRpZXNCeUNUeXBlc1xuICAgIGZvciAoY29uc3QgW2N0QXJyLCBlbnRpdHlTZXRdIG9mIHRoaXMuZW50aXRpZXNCeUNUeXBlcykge1xuICAgICAgaWYgKGN0QXJyLmV2ZXJ5KGNjLmhhcykpIHtcbiAgICAgICAgZW50aXR5U2V0LmRlbGV0ZShlaWQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNjLnJlbW92ZShjVHlwZSk7XG5cbiAgICAvLyBNb3ZlIGVudGl0eUlkIHRvIG5ldyBDVHlwZXMgaWYgbmVlZGVkLlxuICAgIGZvciAoY29uc3QgW2N0QXJyLCBlbnRpdHlTZXRdIG9mIHRoaXMuZW50aXRpZXNCeUNUeXBlcykge1xuICAgICAgaWYgKGN0QXJyLmV2ZXJ5KGNjLmhhcykpIHtcbiAgICAgICAgZW50aXR5U2V0LmFkZChlaWQpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogSW50ZXJuYWwgbWV0aG9kIHVzZWQgaW4gc2V0dGluZyB1cCBhIG5ldyBzeXN0ZW0uXG4gICAqL1xuICByZWdpc3RlclN5c3RlbShjVHlwZXM6IENUW10pOiBXb3JsZDxDVD4ge1xuICAgIHRoaXMuZW50aXRpZXNCeUNUeXBlcy5zZXQoY1R5cGVzLCBuZXcgU2V0PEVudGl0eUlkPigpKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcmVnaXN0ZXJFbnRpdHkoZW50aXR5OiBFbnRpdHk8Q1Q+KTogV29ybGQ8Q1Q+IHtcbiAgICBjb25zdCBjYyA9IG5ldyBDb21wb25lbnRDb2xsZWN0aW9uPENUPigpO1xuXG4gICAgdGhpcy5jb21wb25lbnRDb2xsZWN0aW9ucy5zZXQoZW50aXR5LmlkLCBjYyk7XG4gICAgdGhpcy5lbnRpdGllcy5zZXQoZW50aXR5LmlkLCBlbnRpdHkpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGFsbCBjb21wb25lbnRzIHRoYXQgYmVsb25nIHRvIGFuIGVudGl0eS5cbiAgICovXG4gIGNsZWFyRW50aXR5Q29tcG9uZW50cyhlaWQ6IEVudGl0eUlkKTogV29ybGQ8Q1Q+IHtcbiAgICB0aGlzLmNvbXBvbmVudENvbGxlY3Rpb25zLnNldChlaWQsIG5ldyBDb21wb25lbnRDb2xsZWN0aW9uPENUPigpKTtcblxuICAgIGZvciAoY29uc3QgZW50aXR5U2V0IG9mIHRoaXMuZW50aXRpZXNCeUNUeXBlcy52YWx1ZXMoKSkge1xuICAgICAgaWYgKGVudGl0eVNldC5oYXMoZWlkKSkge1xuICAgICAgICBlbnRpdHlTZXQuZGVsZXRlKGVpZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogRGVzdHJveXMgYW4gZW50aXR5LlxuICAgKiBTYW1lIGFzIGVudGl0eS5kZXN0cm95KCkuXG4gICAqL1xuICBkZXN0cm95RW50aXR5KGVpZDogRW50aXR5SWQpOiBXb3JsZDxDVD4ge1xuICAgIHRoaXMuY29tcG9uZW50Q29sbGVjdGlvbnMuZGVsZXRlKGVpZCk7XG4gICAgdGhpcy5lbnRpdGllcy5kZWxldGUoZWlkKTtcblxuICAgIGZvciAoY29uc3QgZW50aXR5U2V0IG9mIHRoaXMuZW50aXRpZXNCeUNUeXBlcy52YWx1ZXMoKSkge1xuICAgICAgaWYgKGVudGl0eVNldC5oYXMoZWlkKSkge1xuICAgICAgICBlbnRpdHlTZXQuZGVsZXRlKGVpZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gcmVtb3ZlIGFueSB0YWcgYXNzb2NpYXRpb25zIHdpdGggZGVzdHJveWVkIGVudGl0aWVzLlxuICAgIGZvciAoY29uc3QgW3RhZywgZW50aXR5U2V0XSBvZiB0aGlzLmVudGl0aWVzQnlUYWdzKSB7XG4gICAgICBpZiAoZW50aXR5U2V0LmhhcyhlaWQpKSB7XG4gICAgICAgIGVudGl0eVNldC5kZWxldGUoZWlkKVxuICAgICAgfVxuXG4gICAgICBpZiAoZW50aXR5U2V0LnNpemUgPT09IDApIHtcbiAgICAgICAgdGhpcy5lbnRpdGllc0J5VGFncy5kZWxldGUodGFnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxufVxuIiwiLy8gVW5pcXVlIElEIGNyZWF0aW9uIHJlcXVpcmVzIGEgaGlnaCBxdWFsaXR5IHJhbmRvbSAjIGdlbmVyYXRvci4gSW4gdGhlIGJyb3dzZXIgd2UgdGhlcmVmb3JlXG4vLyByZXF1aXJlIHRoZSBjcnlwdG8gQVBJIGFuZCBkbyBub3Qgc3VwcG9ydCBidWlsdC1pbiBmYWxsYmFjayB0byBsb3dlciBxdWFsaXR5IHJhbmRvbSBudW1iZXJcbi8vIGdlbmVyYXRvcnMgKGxpa2UgTWF0aC5yYW5kb20oKSkuXG4vLyBnZXRSYW5kb21WYWx1ZXMgbmVlZHMgdG8gYmUgaW52b2tlZCBpbiBhIGNvbnRleHQgd2hlcmUgXCJ0aGlzXCIgaXMgYSBDcnlwdG8gaW1wbGVtZW50YXRpb24uIEFsc28sXG4vLyBmaW5kIHRoZSBjb21wbGV0ZSBpbXBsZW1lbnRhdGlvbiBvZiBjcnlwdG8gKG1zQ3J5cHRvKSBvbiBJRTExLlxudmFyIGdldFJhbmRvbVZhbHVlcyA9IHR5cGVvZiBjcnlwdG8gIT09ICd1bmRlZmluZWQnICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKGNyeXB0bykgfHwgdHlwZW9mIG1zQ3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgbXNDcnlwdG8uZ2V0UmFuZG9tVmFsdWVzID09PSAnZnVuY3Rpb24nICYmIG1zQ3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKG1zQ3J5cHRvKTtcbnZhciBybmRzOCA9IG5ldyBVaW50OEFycmF5KDE2KTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJuZygpIHtcbiAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2NyeXB0by5nZXRSYW5kb21WYWx1ZXMoKSBub3Qgc3VwcG9ydGVkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkI2dldHJhbmRvbXZhbHVlcy1ub3Qtc3VwcG9ydGVkJyk7XG4gIH1cblxuICByZXR1cm4gZ2V0UmFuZG9tVmFsdWVzKHJuZHM4KTtcbn0iLCIvKipcbiAqIENvbnZlcnQgYXJyYXkgb2YgMTYgYnl0ZSB2YWx1ZXMgdG8gVVVJRCBzdHJpbmcgZm9ybWF0IG9mIHRoZSBmb3JtOlxuICogWFhYWFhYWFgtWFhYWC1YWFhYLVhYWFgtWFhYWFhYWFhYWFhYXG4gKi9cbnZhciBieXRlVG9IZXggPSBbXTtcblxuZm9yICh2YXIgaSA9IDA7IGkgPCAyNTY7ICsraSkge1xuICBieXRlVG9IZXgucHVzaCgoaSArIDB4MTAwKS50b1N0cmluZygxNikuc3Vic3RyKDEpKTtcbn1cblxuZnVuY3Rpb24gYnl0ZXNUb1V1aWQoYnVmLCBvZmZzZXRfKSB7XG4gIHZhciBvZmZzZXQgPSBvZmZzZXRfIHx8IDA7IC8vIE5vdGU6IEJlIGNhcmVmdWwgZWRpdGluZyB0aGlzIGNvZGUhICBJdCdzIGJlZW4gdHVuZWQgZm9yIHBlcmZvcm1hbmNlXG4gIC8vIGFuZCB3b3JrcyBpbiB3YXlzIHlvdSBtYXkgbm90IGV4cGVjdC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZC9wdWxsLzQzNFxuXG4gIHJldHVybiAoYnl0ZVRvSGV4W2J1ZltvZmZzZXQgKyAwXV0gKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDFdXSArIGJ5dGVUb0hleFtidWZbb2Zmc2V0ICsgMl1dICsgYnl0ZVRvSGV4W2J1ZltvZmZzZXQgKyAzXV0gKyAnLScgKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDRdXSArIGJ5dGVUb0hleFtidWZbb2Zmc2V0ICsgNV1dICsgJy0nICsgYnl0ZVRvSGV4W2J1ZltvZmZzZXQgKyA2XV0gKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDddXSArICctJyArIGJ5dGVUb0hleFtidWZbb2Zmc2V0ICsgOF1dICsgYnl0ZVRvSGV4W2J1ZltvZmZzZXQgKyA5XV0gKyAnLScgKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDEwXV0gKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDExXV0gKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDEyXV0gKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDEzXV0gKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDE0XV0gKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDE1XV0pLnRvTG93ZXJDYXNlKCk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGJ5dGVzVG9VdWlkOyIsImltcG9ydCBybmcgZnJvbSAnLi9ybmcuanMnO1xuaW1wb3J0IGJ5dGVzVG9VdWlkIGZyb20gJy4vYnl0ZXNUb1V1aWQuanMnO1xuXG5mdW5jdGlvbiB2NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgdmFyIHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgcm5nKSgpOyAvLyBQZXIgNC40LCBzZXQgYml0cyBmb3IgdmVyc2lvbiBhbmQgYGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWRgXG5cbiAgcm5kc1s2XSA9IHJuZHNbNl0gJiAweDBmIHwgMHg0MDtcbiAgcm5kc1s4XSA9IHJuZHNbOF0gJiAweDNmIHwgMHg4MDsgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG5cbiAgaWYgKGJ1Zikge1xuICAgIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICBidWZbb2Zmc2V0ICsgaV0gPSBybmRzW2ldO1xuICAgIH1cblxuICAgIHJldHVybiBidWY7XG4gIH1cblxuICByZXR1cm4gYnl0ZXNUb1V1aWQocm5kcyk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHY0OyIsImltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnO1xuaW1wb3J0IFdvcmxkIGZyb20gJy4vV29ybGQnO1xuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9Db21wb25lbnQnO1xuaW1wb3J0IENvbXBvbmVudENvbGxlY3Rpb24gZnJvbSAnLi9Db21wb25lbnRDb2xsZWN0aW9uJztcbmltcG9ydCB7IFRhZyB9IGZyb20gJy4vVGFnJztcblxuZXhwb3J0IHR5cGUgRW50aXR5SWQgPSBzdHJpbmc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVudGl0eTxDVD4ge1xuICBwcml2YXRlIF9pZDogc3RyaW5nO1xuICBwcml2YXRlIF93b3JsZDogV29ybGQ8Q1Q+O1xuXG4gIGNvbnN0cnVjdG9yKHdvcmxkOiBXb3JsZDxDVD4pIHtcbiAgICB0aGlzLl9pZCA9IHV1aWR2NCgpO1xuICAgIHRoaXMuX3dvcmxkID0gd29ybGQ7XG5cbiAgICAvKlxuICAgIFJlZ2lzdGVyaW5nIHdpdGggdGhlIFdvcmxkLlxuICAgICovXG4gICAgdGhpcy5fd29ybGQucmVnaXN0ZXJFbnRpdHkodGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogQWRkIGEgY29tcG9uZW50IHRvIGFuIEVudGl0eSwgZG9oLlxuICAgKi9cbiAgYWRkKGNvbXBvbmVudDogQ29tcG9uZW50PENUPik6IEVudGl0eTxDVD4ge1xuICAgIHRoaXMuX3dvcmxkLnNldCh0aGlzLl9pZCwgY29tcG9uZW50KTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBhIHRhZyB0byBhIGNvbXBvbmVudFxuICAgKi9cbiAgYWRkVGFnKHRhZzogVGFnKTogRW50aXR5PENUPiB7XG4gICAgY29uc3QgZW50aXR5U2V0ID0gdGhpcy5fd29ybGQuZW50aXRpZXNCeVRhZ3MuaGFzKHRhZylcbiAgICAgID8gdGhpcy5fd29ybGQuZW50aXRpZXNCeVRhZ3MuZ2V0KHRhZylcbiAgICAgIDogbmV3IFNldDxFbnRpdHlJZD4oKTtcblxuICAgIGlmIChlbnRpdHlTZXQpIHtcbiAgICAgIGVudGl0eVNldC5hZGQodGhpcy5faWQpO1xuICAgICAgdGhpcy5fd29ybGQuZW50aXRpZXNCeVRhZ3Muc2V0KHRhZywgZW50aXR5U2V0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIGlmIGFuIGVudGl0eSBoYXMgYSBjb21wb25lbnQgcmVsYXRlZCB0byBpdC5cbiAgICovXG4gIGhhcyhjVHlwZTogQ1QpOiBib29sZWFuIHtcbiAgICBjb25zdCBjYyA9IHRoaXMuX3dvcmxkLmNvbXBvbmVudENvbGxlY3Rpb25zLmdldCh0aGlzLl9pZCkgfHwgbmV3IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+KCk7XG5cbiAgICByZXR1cm4gY2MuaGFzKGNUeXBlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayB0byBzZWUgaWYgYW4gZW50aXR5IHRhZ2dlZCB3aXRoIGEgZ2l2ZW4gdGFnLlxuICAgKi9cbiAgaGFzVGFnKHRhZzogVGFnKTogYm9vbGVhbiB7XG4gICAgaWYgKHRoaXMuX3dvcmxkLmVudGl0aWVzQnlUYWdzLmhhcyh0YWcpKSB7XG4gICAgICBjb25zdCBlbnRpdHlTZXQgPSB0aGlzLl93b3JsZC5lbnRpdGllc0J5VGFncy5nZXQodGFnKTtcbiAgICAgIGlmIChlbnRpdHlTZXQpIHtcbiAgICAgICAgcmV0dXJuIGVudGl0eVNldC5oYXModGhpcy5faWQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYSBjb21wb25lbnQgdGhhdCBiZWxvbmdzIHRvIGFuIGVudGl0eS5cbiAgICovXG4gIGdldDxDPihjVHlwZTogQ1QpOiBDIHtcbiAgICBjb25zdCBjYyA9IHRoaXMuX3dvcmxkLmNvbXBvbmVudENvbGxlY3Rpb25zLmdldCh0aGlzLl9pZCkgfHwgbmV3IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+KCk7XG5cbiAgICBjb25zdCBjb21wb25lbnQgPSBjYy5nZXQ8Qz4oY1R5cGUpO1xuXG4gICAgcmV0dXJuIGNvbXBvbmVudDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYWxsIGNvbXBvbmVudHMgdGhhdCBoYXZlIGJlZW4gYWRkZWQgdG8gYW4gZW50aXR5LCB2aWEgYSBDb21wb25lbnRDb2xsZWN0aW9uXG4gICAqL1xuICBnZXRBbGwoKTogQ29tcG9uZW50Q29sbGVjdGlvbjxDVD4ge1xuICAgIHJldHVybiB0aGlzLl93b3JsZC5jb21wb25lbnRDb2xsZWN0aW9ucy5nZXQodGhpcy5faWQpIHx8IG5ldyBDb21wb25lbnRDb2xsZWN0aW9uPENUPigpO1xuICB9XG5cbiAgcmVtb3ZlKGNUeXBlOiBDVCk6IEVudGl0eTxDVD4ge1xuICAgIHRoaXMuX3dvcmxkLnJlbW92ZSh0aGlzLl9pZCwgY1R5cGUpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGEgdGFnIGZyb20gYW4gZW50aXR5XG4gICAqL1xuICByZW1vdmVUYWcodGFnOiBzdHJpbmcgfCBudW1iZXIpOiBFbnRpdHk8Q1Q+IHtcbiAgICBpZiAodGhpcy5fd29ybGQuZW50aXRpZXNCeVRhZ3MuaGFzKHRhZykpIHtcbiAgICAgIGNvbnN0IGVudGl0eVNldCA9IHRoaXMuX3dvcmxkLmVudGl0aWVzQnlUYWdzLmdldCh0YWcpO1xuICAgICAgXG4gICAgICBpZiAoZW50aXR5U2V0KSB7XG4gICAgICAgIGVudGl0eVNldC5kZWxldGUodGhpcy5faWQpO1xuXG4gICAgICAgIGlmIChlbnRpdHlTZXQuc2l6ZSA9PT0gMCkge1xuICAgICAgICAgIHRoaXMuX3dvcmxkLmVudGl0aWVzQnlUYWdzLmRlbGV0ZSh0YWcpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqIENsZWFycyBhbGwgY29tcG9uZW50cyBmcm9tIGFuIEVudGl0eSAqL1xuICBjbGVhcigpOiBFbnRpdHk8Q1Q+IHtcbiAgICB0aGlzLl93b3JsZC5jbGVhckVudGl0eUNvbXBvbmVudHModGhpcy5faWQpO1xuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgYWxsIHRhZ3Mgb24gYW4gZW50aXR5XG4gICAqL1xuICBjbGVhclRhZ3MoKTogRW50aXR5PENUPiB7XG4gICAgZm9yIChjb25zdCBbdGFnLCBlbnRpdHlTZXRdIG9mIHRoaXMuX3dvcmxkLmVudGl0aWVzQnlUYWdzLmVudHJpZXMoKSkge1xuICAgICAgZW50aXR5U2V0LmRlbGV0ZSh0aGlzLl9pZCk7XG5cbiAgICAgIGlmIChlbnRpdHlTZXQuc2l6ZSA9PT0gMCkge1xuICAgICAgICB0aGlzLl93b3JsZC5lbnRpdGllc0J5VGFncy5kZWxldGUodGFnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5fd29ybGQuZGVzdHJveUVudGl0eSh0aGlzLl9pZCk7XG4gIH1cblxuICBnZXQgaWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5faWQ7XG4gIH1cblxuICBnZXQgd29ybGQoKTogV29ybGQ8Q1Q+IHtcbiAgICByZXR1cm4gdGhpcy5fd29ybGQ7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFsbCBjb21wb25lbnRzIHRoYXQgaGF2ZSBiZWVuIGFkZGVkIHRvIGFuIGVudGl0eSwgdmlhIGEgQ29tcG9uZW50Q29sbGVjdGlvbi5cbiAgICogRG9lcyB0aGUgc2FtZSB0aGluZyBhcyBlbnRpdHlJbnN0YW5jZS5nZXRBbGwoKS5cbiAgICovXG4gIGdldCBjb21wb25lbnRzKCk6IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+IHtcbiAgICByZXR1cm4gdGhpcy5fd29ybGQuY29tcG9uZW50Q29sbGVjdGlvbnMuZ2V0KHRoaXMuX2lkKSB8fCBuZXcgQ29tcG9uZW50Q29sbGVjdGlvbjxDVD4oKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgYWxsIHRoZSB0YWdzIHRoYXQgaGF2ZSBiZWVuIGFkZGVkIHRvIHRoaXMgZW50aXR5LlxuICAgKi9cbiAgZ2V0IHRhZ3MoKTogU2V0PFRhZz4ge1xuICAgIGNvbnN0IHRhZ3MgPSBuZXcgU2V0PFRhZz4oKTtcbiAgICBmb3IgKGNvbnN0IFt0YWcsIGVudGl0eVNldF0gb2YgdGhpcy5fd29ybGQuZW50aXRpZXNCeVRhZ3MuZW50cmllcygpKSB7XG4gICAgICBpZiAoZW50aXR5U2V0Lmhhcyh0aGlzLl9pZCkpIHtcbiAgICAgICAgdGFncy5hZGQodGFnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGFncztcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRW50aXR5PENUPihcbiAgd29ybGQ6IFdvcmxkPENUPixcbik6IEVudGl0eTxDVD4ge1xuICBjb25zdCBlbnRpdHkgPSBuZXcgRW50aXR5PENUPih3b3JsZCk7XG5cbiAgcmV0dXJuIGVudGl0eTtcbn1cblxuXG4iLCJpbXBvcnQgV29ybGQgZnJvbSAnLi9Xb3JsZCc7XG5pbXBvcnQgRW50aXR5IGZyb20gJy4vRW50aXR5JztcbmltcG9ydCBDb21wb25lbnRDb2xsZWN0aW9uIGZyb20gJy4vQ29tcG9uZW50Q29sbGVjdGlvbic7XG5cbmV4cG9ydCB0eXBlIFN5c3RlbSA9ICgpID0+IHZvaWQ7XG5cbi8qKlxuICogQXJndW1lbnRzIHRoYXQgYXJlIHBhc3NlZCBpbnRvIGEgU3lzdGVtIGZ1bmN0aW9uIG9uIGVhY2ggaXRlcmF0aW9uLlxuICogVGhpcyBpcyBob3cgeW91IGFjY2VzIHRoaW5ncyBsaWtlIHRoZSBlbnRpdHkgdGhhdCBwYXJ0aWN1bGFyIGVudGl0eSB0byBhY3Qgb24sXG4gKiBhcyB3ZWxsIGFzIHNvbWUgb3RoZXIgaGVscGZ1bCBwYXJhbXMgbGlrZSBpZiB0aGUgZW50aXR5IGlzIHRoZSBmaXJzdCBvciBsYXN0IGVudGl0eVxuICogaW4gdGhlIGdyb3VwIG9mIGVudGl0aWVzIHRoYXQgYmVpbmcgaXRlcmF0ZWQgb3Zlci5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTeXN0ZW1GdW5jQXJnczxDVD4ge1xuICAvKipcbiAgICogVGhlIGN1cnJlbnQgZW50aXR5IGJlaW5nIGl0ZXJhdGVkLlxuICAgKi9cbiAgZW50aXR5OiBFbnRpdHk8Q1Q+O1xuICAvKipcbiAgICogVGhlIGNvbXBvbmVudHMgdGhhdCBiZWxvbmcgdG8gdGhlIGVudGl0eVxuICAgKi9cbiAgY29tcG9uZW50czogQ29tcG9uZW50Q29sbGVjdGlvbjxDVD47XG4gIC8qKlxuICAgKiBUaGUgV29ybGQgaW5zdGFuY2UuXG4gICAqIFVzZSB0aGlzIHRvIGFjY2VzcyBvdGhlciBlbnRpdGllcy5cbiAgICovXG4gIHdvcmxkOiBXb3JsZDxDVD47XG4gIGluZGV4OiBudW1iZXI7XG4gIHNpemU6IG51bWJlcjtcbiAgLyoqXG4gICAqIElzIHRoZSBmaXJzdCBlbnRpdHkgdG8gYmUgaXRlcmF0ZWQgb24gdGhpcyBydW4gb2YgYSBzeXN0ZW0uXG4gICAqIEhlbHBmdWwgZm9yIHNldHRpbmcgdXAgc3RhdGUgdGhhdCBpcyB0aGUgc2FtZSBmb3IgYWxsIGVudGl0aWVzIG9ubHkgb25jZS5cbiAgICovXG4gIGlzRmlyc3Q6IGJvb2xlYW47XG4gIC8qKlxuICAgKiBJcyB0aGUgbGFzdCBlbnRpdHkgdG8gYmUgaXRlcmF0ZWQgb24gdGhpcyBydW4gb2YgYSBzeXN0ZW0uXG4gICAqIENhbiBiZSBoZWxwZnVsIHRvIHRlYXIgZG93biBhbnl0aGluZyB0aGF0IHNob3VsZCBiZSBkZWFsdCB3aXRoIGFmdGVyIGFsbCB0aGUgZW50aXRlcyBoYXZlIHJhbi5cbiAgICovXG4gIGlzTGFzdDogYm9vbGVhbjtcbn1cblxuLyoqXG4gKiBGdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB3aGVuIGEgc3lzdGVtIGlzIHJ1bi5cbiAqL1xuZXhwb3J0IHR5cGUgU3lzdGVtRnVuYzxDVD4gPSAoXG4gIHN5dGVtRnVuY0FyZ3M6IFN5c3RlbUZ1bmNBcmdzPENUPixcbikgPT4gdm9pZDtcblxuLyoqXG4gKiBUaGlzIGlzIGhvdyB5b3UgY3JlYXRlIGEgU3lzdGVtLlxuICogQGV4YW1wbGVcbiAqIGBgYFxuICogY3JlYXRlU3lzdGVtKHdvcmxkLCBbJ0NvbXBvbmVudFR5cGUnXSwgKHsgZW50aXR5IH0pID0+ICdEbyBmdW4gc3lzdGVtIHRoaW5ncyBoZXJlLicpXG4gKiBgYGBcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVN5c3RlbTxDVD4oXG4gIHdvcmxkOiBXb3JsZDxDVD4sXG4gIGNUeXBlczogQ1RbXSxcbiAgc3lzdGVtRnVuYzogU3lzdGVtRnVuYzxDVD5cbik6IFN5c3RlbSB7XG4gIHdvcmxkLnJlZ2lzdGVyU3lzdGVtKGNUeXBlcyk7XG5cbiAgcmV0dXJuICgpOiB2b2lkID0+IHtcbiAgICBsZXQgaW5kZXggPSAwO1xuICAgIGNvbnN0IHNpemUgPSB3b3JsZC5lbnRpdGllc0J5Q1R5cGVzLnNpemU7XG5cbiAgICAvLyBVc2VkIGZvciBtYXRjaGluZyB0aGUgYXJyYXkgb2YgQ29tcG9uZW50VHlwZXMgd2hpY2ggaXMgdGhlIGtleVxuICAgIC8vIG9mIHdoZXJlIHRoZSBDb21wb25lbnRDb2xsZWN0aW9uIGlzLCB3aXRoIHRoZSBhcnJheSBvZiBDb21wb25lbnRUeXBlc1xuICAgIC8vIHRoYXQgYXJlIHBhc3Nlcy5cbiAgICAvLyBNaWdodCBiZSBuaWNlIGluIHRoZSBmdXR1cmUgdG8gZ28gYmFjayB0byBhIHJlZiBjaGVjayBvbiBjVHlwZXMsIGJ1dFxuICAgIC8vIGZvciBub3cgdGhpcyBkb2Vzbid0IHNlZW0gdG8gYmUgdGhhdCBtdWNoIG9mIGEgcGVyZiBoaXQuXG4gICAgLy8gZm9yIChjb25zdCBjdCBvZiB3b3JsZC5lbnRpdGllc0J5Q1R5cGVzLmtleXMoKSkge1xuICAgIC8vICAgaWYgKGNUeXBlcy5sZW5ndGggPT09IGN0Lmxlbmd0aCAmJiBjVHlwZXMuZXZlcnkoYyA9PiBjdC5pbmNsdWRlcyhjKSkpIHtcbiAgICAvLyAgICAgZm9yIChjb25zdCBlaWQgb2Ygd29ybGQuZW50aXRpZXNCeUNUeXBlcy5nZXQoY1R5cGVzKSkge1xuICAgIC8vICAgICAgIGNvbnN0IGFyZ3M6IFN5c3RlbUZ1bmNBcmdzPENUPiA9IHtcbiAgICAvLyAgICAgICAgIGVudGl0eTogd29ybGQuZW50aXRpZXMuZ2V0KGVpZCksXG4gICAgLy8gICAgICAgICBjb21wb25lbnRzOiB3b3JsZC5jb21wb25lbnRDb2xsZWN0aW9ucy5nZXQoZWlkKSxcbiAgICAvLyAgICAgICAgIHdvcmxkLFxuICAgIC8vICAgICAgICAgaW5kZXgsXG4gICAgLy8gICAgICAgICBzaXplLFxuICAgIC8vICAgICAgICAgaXNGaXJzdDogaW5kZXggPT09IDAsXG4gICAgLy8gICAgICAgICBpc0xhc3Q6IGluZGV4ICsgMSA9PT0gc2l6ZSxcbiAgICAvLyAgICAgICB9XG4gICAgXG4gICAgLy8gICAgICAgc3lzdGVtRnVuYyhhcmdzKTtcbiAgICBcbiAgICAvLyAgICAgICBpbmRleCArPSAxO1xuICAgIC8vICAgICB9XG4gICAgLy8gICB9XG4gICAgLy8gfVxuXG4gICAgY29uc3QgY1R5cGVBcnJzID0gd29ybGQuZW50aXRpZXNCeUNUeXBlcy5nZXQoY1R5cGVzKSB8fCBuZXcgU2V0KCk7XG5cbiAgICBmb3IgKGNvbnN0IGVpZCBvZiBjVHlwZUFycnMpIHtcbiAgICAgIGNvbnN0IGFyZ3M6IFN5c3RlbUZ1bmNBcmdzPENUPiA9IHtcbiAgICAgICAgZW50aXR5OiB3b3JsZC5lbnRpdGllcy5nZXQoZWlkKSB8fCBuZXcgRW50aXR5PENUPih3b3JsZCksXG4gICAgICAgIGNvbXBvbmVudHM6IHdvcmxkLmNvbXBvbmVudENvbGxlY3Rpb25zLmdldChlaWQpIHx8IG5ldyBDb21wb25lbnRDb2xsZWN0aW9uPENUPigpLFxuICAgICAgICB3b3JsZCxcbiAgICAgICAgaW5kZXgsXG4gICAgICAgIHNpemUsXG4gICAgICAgIGlzRmlyc3Q6IGluZGV4ID09PSAwLFxuICAgICAgICBpc0xhc3Q6IGluZGV4ICsgMSA9PT0gc2l6ZSxcbiAgICAgIH1cblxuICAgICAgc3lzdGVtRnVuYyhhcmdzKTtcblxuICAgICAgaW5kZXggKz0gMTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCBXb3JsZCBmcm9tICcuL1dvcmxkJztcbmltcG9ydCB7IGNyZWF0ZUVudGl0eSB9IGZyb20gJy4vRW50aXR5JztcbmltcG9ydCB7IGNyZWF0ZVN5c3RlbSB9IGZyb20gJy4vU3lzdGVtJztcblxuZXhwb3J0IHtcbiAgV29ybGQsXG4gIGNyZWF0ZUVudGl0eSxcbiAgY3JlYXRlU3lzdGVtLFxufTtcbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///1\n')}])}));