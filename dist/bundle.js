!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("ecstatic",[],n):"object"==typeof exports?exports.ecstatic=n():e.ecstatic=n()}(window,(function(){return function(e){var n=window.webpackHotUpdateecstatic;window.webpackHotUpdateecstatic=function(e,Q){!function(e,n){if(!p[e]||!y[e])return;for(var Q in y[e]=!1,n)Object.prototype.hasOwnProperty.call(n,Q)&&(b[Q]=n[Q]);0==--u&&0===r&&X()}(e,Q),n&&n(e,Q)};var Q,t=!0,B="ade155c5c31697d24db2",i={},c=[],s=[];function d(e){var n=R[e];if(!n)return N;var t=function(t){return n.hot.active?(R[t]?-1===R[t].parents.indexOf(e)&&R[t].parents.push(e):(c=[e],Q=t),-1===n.children.indexOf(t)&&n.children.push(t)):(console.warn("[HMR] unexpected require("+t+") from disposed module "+e),c=[]),N(t)},B=function(e){return{configurable:!0,enumerable:!0,get:function(){return N[e]},set:function(n){N[e]=n}}};for(var i in N)Object.prototype.hasOwnProperty.call(N,i)&&"e"!==i&&"t"!==i&&Object.defineProperty(t,i,B(i));return t.e=function(e){return"ready"===l&&o("prepare"),r++,N.e(e).then(n,(function(e){throw n(),e}));function n(){r--,"prepare"===l&&(G[e]||x(e),0===r&&0===u&&X())}},t.t=function(e,n){return 1&n&&(e=t(e)),N.t(e,-2&n)},t}function F(n){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:Q!==n,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var Q=0;Q<e.length;Q++)t._acceptedDependencies[e[Q]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},invalidate:function(){switch(this._selfInvalidated=!0,l){case"idle":(b={})[n]=e[n],o("ready");break;case"ready":L(n);break;case"prepare":case"check":case"dispose":case"apply":(C=C||[]).push(n)}},check:V,apply:Z,status:function(e){if(!e)return l;U.push(e)},addStatusHandler:function(e){U.push(e)},removeStatusHandler:function(e){var n=U.indexOf(e);n>=0&&U.splice(n,1)},data:i[n]};return Q=void 0,t}var U=[],l="idle";function o(e){l=e;for(var n=0;n<U.length;n++)U[n].call(null,e)}var I,b,g,C,u=0,r=0,G={},y={},p={};function a(e){return+e+""===e?+e:e}function V(e){if("idle"!==l)throw new Error("check() is only allowed in idle status");return t=e,o("check"),(n=1e4,n=n||1e4,new Promise((function(e,Q){if("undefined"==typeof XMLHttpRequest)return Q(new Error("No browser support"));try{var t=new XMLHttpRequest,B=N.p+"hot/hot-update.json";t.open("GET",B,!0),t.timeout=n,t.send(null)}catch(e){return Q(e)}t.onreadystatechange=function(){if(4===t.readyState)if(0===t.status)Q(new Error("Manifest request to "+B+" timed out."));else if(404===t.status)e();else if(200!==t.status&&304!==t.status)Q(new Error("Manifest request to "+B+" failed."));else{try{var n=JSON.parse(t.responseText)}catch(e){return void Q(e)}e(n)}}}))).then((function(e){if(!e)return o(E()?"ready":"idle"),null;y={},G={},p=e.c,g=e.h,o("prepare");var n=new Promise((function(e,n){I={resolve:e,reject:n}}));b={};return x(0),"prepare"===l&&0===r&&0===u&&X(),n}));var n}function x(e){var n;p[e]?(y[e]=!0,u++,(n=document.createElement("script")).charset="utf-8",n.src=N.p+"hot/hot-update.js",document.head.appendChild(n)):G[e]=!0}function X(){o("ready");var e=I;if(I=null,e)if(t)Promise.resolve().then((function(){return Z(t)})).then((function(n){e.resolve(n)}),(function(n){e.reject(n)}));else{var n=[];for(var Q in b)Object.prototype.hasOwnProperty.call(b,Q)&&n.push(a(Q));e.resolve(n)}}function Z(n){if("ready"!==l)throw new Error("apply() is only allowed in ready status");return function n(t){var s,d,F,U,l;function I(e){for(var n=[e],Q={},t=n.map((function(e){return{chain:[e],id:e}}));t.length>0;){var B=t.pop(),i=B.id,c=B.chain;if((U=R[i])&&(!U.hot._selfAccepted||U.hot._selfInvalidated)){if(U.hot._selfDeclined)return{type:"self-declined",chain:c,moduleId:i};if(U.hot._main)return{type:"unaccepted",chain:c,moduleId:i};for(var s=0;s<U.parents.length;s++){var d=U.parents[s],F=R[d];if(F){if(F.hot._declinedDependencies[i])return{type:"declined",chain:c.concat([d]),moduleId:i,parentId:d};-1===n.indexOf(d)&&(F.hot._acceptedDependencies[i]?(Q[d]||(Q[d]=[]),u(Q[d],[i])):(delete Q[d],n.push(d),t.push({chain:c.concat([d]),id:d})))}}}}return{type:"accepted",moduleId:e,outdatedModules:n,outdatedDependencies:Q}}function u(e,n){for(var Q=0;Q<n.length;Q++){var t=n[Q];-1===e.indexOf(t)&&e.push(t)}}E();var r={},G=[],y={},V=function(){console.warn("[HMR] unexpected require("+X.moduleId+") to disposed module")};for(var x in b)if(Object.prototype.hasOwnProperty.call(b,x)){var X;l=a(x),X=b[x]?I(l):{type:"disposed",moduleId:x};var Z=!1,L=!1,m=!1,A="";switch(X.chain&&(A="\nUpdate propagation: "+X.chain.join(" -> ")),X.type){case"self-declined":t.onDeclined&&t.onDeclined(X),t.ignoreDeclined||(Z=new Error("Aborted because of self decline: "+X.moduleId+A));break;case"declined":t.onDeclined&&t.onDeclined(X),t.ignoreDeclined||(Z=new Error("Aborted because of declined dependency: "+X.moduleId+" in "+X.parentId+A));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(X),t.ignoreUnaccepted||(Z=new Error("Aborted because "+l+" is not accepted"+A));break;case"accepted":t.onAccepted&&t.onAccepted(X),L=!0;break;case"disposed":t.onDisposed&&t.onDisposed(X),m=!0;break;default:throw new Error("Unexception type "+X.type)}if(Z)return o("abort"),Promise.reject(Z);if(L)for(l in y[l]=b[l],u(G,X.outdatedModules),X.outdatedDependencies)Object.prototype.hasOwnProperty.call(X.outdatedDependencies,l)&&(r[l]||(r[l]=[]),u(r[l],X.outdatedDependencies[l]));m&&(u(G,[X.moduleId]),y[l]=V)}var W,D=[];for(d=0;d<G.length;d++)l=G[d],R[l]&&R[l].hot._selfAccepted&&y[l]!==V&&!R[l].hot._selfInvalidated&&D.push({module:l,parents:R[l].parents.slice(),errorHandler:R[l].hot._selfAccepted});o("dispose"),Object.keys(p).forEach((function(e){!1===p[e]&&function(e){delete installedChunks[e]}(e)}));var h,v,f=G.slice();for(;f.length>0;)if(l=f.pop(),U=R[l]){var S={},H=U.hot._disposeHandlers;for(F=0;F<H.length;F++)(s=H[F])(S);for(i[l]=S,U.hot.active=!1,delete R[l],delete r[l],F=0;F<U.children.length;F++){var T=R[U.children[F]];T&&((W=T.parents.indexOf(l))>=0&&T.parents.splice(W,1))}}for(l in r)if(Object.prototype.hasOwnProperty.call(r,l)&&(U=R[l]))for(v=r[l],F=0;F<v.length;F++)h=v[F],(W=U.children.indexOf(h))>=0&&U.children.splice(W,1);o("apply"),void 0!==g&&(B=g,g=void 0);for(l in b=void 0,y)Object.prototype.hasOwnProperty.call(y,l)&&(e[l]=y[l]);var Y=null;for(l in r)if(Object.prototype.hasOwnProperty.call(r,l)&&(U=R[l])){v=r[l];var k=[];for(d=0;d<v.length;d++)if(h=v[d],s=U.hot._acceptedDependencies[h]){if(-1!==k.indexOf(s))continue;k.push(s)}for(d=0;d<k.length;d++){s=k[d];try{s(v)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:l,dependencyId:v[d],error:e}),t.ignoreErrored||Y||(Y=e)}}}for(d=0;d<D.length;d++){var w=D[d];l=w.module,c=w.parents,Q=l;try{N(l)}catch(e){if("function"==typeof w.errorHandler)try{w.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:l,error:n,originalError:e}),t.ignoreErrored||Y||(Y=n),Y||(Y=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:l,error:e}),t.ignoreErrored||Y||(Y=e)}}if(Y)return o("fail"),Promise.reject(Y);if(C)return n(t).then((function(e){return G.forEach((function(n){e.indexOf(n)<0&&e.push(n)})),e}));return o("idle"),new Promise((function(e){e(G)}))}(n=n||{})}function E(){if(C)return b||(b={}),C.forEach(L),C=void 0,!0}function L(n){Object.prototype.hasOwnProperty.call(b,n)||(b[n]=e[n])}var R={};function N(n){if(R[n])return R[n].exports;var Q=R[n]={i:n,l:!1,exports:{},hot:F(n),parents:(s=c,c=[],s),children:[]};return e[n].call(Q.exports,Q,Q.exports,d(n)),Q.l=!0,Q.exports}return N.m=e,N.c=R,N.d=function(e,n,Q){N.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:Q})},N.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},N.t=function(e,n){if(1&n&&(e=N(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var Q=Object.create(null);if(N.r(Q),Object.defineProperty(Q,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var t in e)N.d(Q,t,function(n){return e[n]}.bind(null,t));return Q},N.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return N.d(n,"a",n),n},N.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},N.p="/static/",N.h=function(){return B},d(0)(N.s=0)}([function(e,n,Q){e.exports=Q(1)},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, "World", function() { return /* reexport */ World_World; });\n__webpack_require__.d(__webpack_exports__, "createEntity", function() { return /* reexport */ createEntity; });\n__webpack_require__.d(__webpack_exports__, "createSystem", function() { return /* reexport */ createSystem; });\n\n// CONCATENATED MODULE: ./src/ComponentCollection.ts\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nclass ComponentCollection {\n  constructor() {\n    _defineProperty(this, "components", new Map());\n\n    _defineProperty(this, "add", component => {\n      this.components.set(component.type, component);\n    });\n\n    _defineProperty(this, "update", (cType, func) => {\n      if (this.components.has(cType)) {\n        const c = this.components.get(cType);\n\n        if (c) {\n          const updatedComponent = func(c);\n          this.components.set(cType, updatedComponent);\n        }\n      }\n    });\n\n    _defineProperty(this, "remove", cType => {\n      this.components.delete(cType);\n    });\n\n    _defineProperty(this, "get", cType => {\n      if (!this.components.has(cType)) {\n        throw new Error(`ComponentCollection does not have component of type ${cType}`);\n      }\n\n      return this.components.get(cType);\n    });\n\n    _defineProperty(this, "has", cType => {\n      if (Array.isArray(cType)) {\n        return cType.every(ct => this.components.has(ct) === true);\n      } else {\n        return this.components.has(cType);\n      }\n    });\n  }\n\n  get componentTypes() {\n    return [...this.components.keys()];\n  }\n\n  get size() {\n    return this.components.size;\n  }\n\n}\n// CONCATENATED MODULE: ./src/World.ts\nfunction World_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\nclass World_World {\n  constructor() {\n    World_defineProperty(this, "componentCollections", new Map());\n\n    World_defineProperty(this, "entities", new Map());\n\n    World_defineProperty(this, "entitiesByCTypes", new Map());\n\n    World_defineProperty(this, "find", predicate => {\n      for (const entity of this.entities.values()) {\n        if (predicate(entity)) {\n          return entity;\n        }\n      }\n\n      return null;\n    });\n\n    World_defineProperty(this, "findAll", predicate => {\n      const results = [];\n\n      for (const entity of this.entities.values()) {\n        if (predicate(entity)) {\n          results.push(entity);\n        }\n      }\n\n      return results;\n    });\n\n    World_defineProperty(this, "locate", cTypes => {\n      for (const entity of this.entities.values()) {\n        if (entity.components.has(cTypes)) {\n          return entity;\n        }\n      }\n\n      return null;\n    });\n\n    World_defineProperty(this, "locateAll", cTypes => {\n      const results = [];\n\n      for (const entity of this.entities.values()) {\n        if (entity.components.has(cTypes)) {\n          results.push(entity);\n        }\n      }\n\n      return results;\n    });\n\n    World_defineProperty(this, "grab", cType => {\n      const entity = this.locate(cType);\n\n      if (entity) {\n        const cc = this.componentCollections.get(entity.id) || new ComponentCollection();\n        const component = cc.get(cType);\n        return {\n          entity,\n          component\n        };\n      }\n\n      return null;\n    });\n\n    World_defineProperty(this, "grabBy", (cType, predicate) => {\n      const entities = this.locateAll(cType);\n\n      for (const entity of entities) {\n        const cc = this.componentCollections.get(entity.id) || new ComponentCollection();\n        const component = cc.get(cType);\n\n        if (predicate(component)) {\n          return {\n            component,\n            entity\n          };\n        }\n      }\n\n      return null;\n    });\n\n    World_defineProperty(this, "grabAll", cType => {\n      return this.locateAll(cType).map(entity => ({\n        entity,\n        component: entity.components.get(cType)\n      }));\n    });\n\n    World_defineProperty(this, "get", (eid, cType) => {\n      const cc = this.componentCollections.get(eid) || new ComponentCollection();\n      return cc.get(cType);\n    });\n\n    World_defineProperty(this, "set", (eid, component) => {\n      const cc = this.componentCollections.get(eid) || new ComponentCollection();\n      cc.add(component);\n      this.componentCollections.set(eid, cc);\n\n      for (const [ctArr, entitySet] of this.entitiesByCTypes) {\n        if (ctArr.every(cc.has)) {\n          entitySet.add(eid);\n        }\n      }\n    });\n\n    World_defineProperty(this, "remove", (eid, cType) => {\n      const cc = this.componentCollections.get(eid) || new ComponentCollection(); // remove entity from current entitiesByCTypes\n\n      for (const [ctArr, entitySet] of this.entitiesByCTypes) {\n        if (ctArr.every(cc.has)) {\n          entitySet.delete(eid);\n        }\n      }\n\n      cc.remove(cType); // Move entityId to new CTypes if needed.\n\n      for (const [ctArr, entitySet] of this.entitiesByCTypes) {\n        if (ctArr.every(cc.has)) {\n          entitySet.add(eid);\n        }\n      }\n    });\n  }\n\n  registerSystem(cTypes) {\n    this.entitiesByCTypes.set(cTypes, new Set());\n  }\n\n  registerEntity(entity) {\n    const cc = new ComponentCollection();\n    this.componentCollections.set(entity.id, cc);\n    this.entities.set(entity.id, entity);\n  }\n\n  clearEntityComponents(eid) {\n    this.componentCollections.set(eid, new ComponentCollection());\n\n    for (const entitySet of this.entitiesByCTypes.values()) {\n      if (entitySet.has(eid)) {\n        entitySet.delete(eid);\n      }\n    }\n  }\n\n  destroyEntity(eid) {\n    this.componentCollections.delete(eid);\n    this.entities.delete(eid);\n\n    for (const entitySet of this.entitiesByCTypes.values()) {\n      if (entitySet.has(eid)) {\n        entitySet.delete(eid);\n      }\n    }\n  }\n\n}\n// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/rng.js\n// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\n// getRandomValues needs to be invoked in a context where "this" is a Crypto implementation. Also,\n// find the complete implementation of crypto (msCrypto) on IE11.\nvar getRandomValues = typeof crypto !== \'undefined\' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== \'undefined\' && typeof msCrypto.getRandomValues === \'function\' && msCrypto.getRandomValues.bind(msCrypto);\nvar rnds8 = new Uint8Array(16);\nfunction rng() {\n  if (!getRandomValues) {\n    throw new Error(\'crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported\');\n  }\n\n  return getRandomValues(rnds8);\n}\n// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/bytesToUuid.js\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\n\nfor (var bytesToUuid_i = 0; bytesToUuid_i < 256; ++bytesToUuid_i) {\n  byteToHex.push((bytesToUuid_i + 0x100).toString(16).substr(1));\n}\n\nfunction bytesToUuid(buf, offset_) {\n  var offset = offset_ || 0; // Note: Be careful editing this code!  It\'s been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n\n  return (byteToHex[buf[offset + 0]] + byteToHex[buf[offset + 1]] + byteToHex[buf[offset + 2]] + byteToHex[buf[offset + 3]] + \'-\' + byteToHex[buf[offset + 4]] + byteToHex[buf[offset + 5]] + \'-\' + byteToHex[buf[offset + 6]] + byteToHex[buf[offset + 7]] + \'-\' + byteToHex[buf[offset + 8]] + byteToHex[buf[offset + 9]] + \'-\' + byteToHex[buf[offset + 10]] + byteToHex[buf[offset + 11]] + byteToHex[buf[offset + 12]] + byteToHex[buf[offset + 13]] + byteToHex[buf[offset + 14]] + byteToHex[buf[offset + 15]]).toLowerCase();\n}\n\n/* harmony default export */ var esm_browser_bytesToUuid = (bytesToUuid);\n// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/v4.js\n\n\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return esm_browser_bytesToUuid(rnds);\n}\n\n/* harmony default export */ var esm_browser_v4 = (v4);\n// CONCATENATED MODULE: ./src/Entity.ts\nfunction Entity_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\nclass Entity_Entity {\n  constructor(world) {\n    Entity_defineProperty(this, "_id", void 0);\n\n    Entity_defineProperty(this, "_world", void 0);\n\n    this._id = esm_browser_v4();\n    this._world = world;\n    /*\n    Registering with the World.\n    */\n\n    this._world.registerEntity(this);\n  }\n  /**\n   * Add a component to an Entity, doh.\n   */\n\n\n  add(component) {\n    this._world.set(this._id, component);\n\n    return this;\n  }\n  /**\n   * Determines if an entity has a component related to it.\n   */\n\n\n  has(cType) {\n    const cc = this._world.componentCollections.get(this._id) || new ComponentCollection();\n    return cc.has(cType);\n  }\n\n  get(cType) {\n    const cc = this._world.componentCollections.get(this._id) || new ComponentCollection();\n    const component = cc.get(cType);\n    return component;\n  }\n\n  getAll() {\n    return this._world.componentCollections.get(this._id) || new ComponentCollection();\n  }\n\n  get components() {\n    return this._world.componentCollections.get(this._id) || new ComponentCollection();\n  }\n\n  remove(cType) {\n    this._world.remove(this._id, cType);\n\n    return this;\n  }\n  /** Clears all components from an Entity */\n\n\n  clear() {\n    this._world.clearEntityComponents(this._id);\n\n    return this;\n  }\n\n  destroy() {\n    this._world.destroyEntity(this._id);\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  get world() {\n    return this._world;\n  }\n\n}\nfunction createEntity(world) {\n  const entity = new Entity_Entity(world);\n  return entity;\n}\n// CONCATENATED MODULE: ./src/System.ts\n\n\nfunction createSystem(world, cTypes, systemFunc) {\n  world.registerSystem(cTypes);\n  return () => {\n    let index = 0;\n    const size = world.entitiesByCTypes.size; // Used for matching the array of ComponentTypes which is the key\n    // of where the ComponentCollection is, with the array of ComponentTypes\n    // that are passes.\n    // Might be nice in the future to go back to a ref check on cTypes, but\n    // for now this doesn\'t seem to be that much of a perf hit.\n    // for (const ct of world.entitiesByCTypes.keys()) {\n    //   if (cTypes.length === ct.length && cTypes.every(c => ct.includes(c))) {\n    //     for (const eid of world.entitiesByCTypes.get(cTypes)) {\n    //       const args: SystemFuncArgs<CT> = {\n    //         entity: world.entities.get(eid),\n    //         components: world.componentCollections.get(eid),\n    //         world,\n    //         index,\n    //         size,\n    //         isFirst: index === 0,\n    //         isLast: index + 1 === size,\n    //       }\n    //       systemFunc(args);\n    //       index += 1;\n    //     }\n    //   }\n    // }\n\n    const cTypeArrs = world.entitiesByCTypes.get(cTypes) || new Set();\n\n    for (const eid of cTypeArrs) {\n      const args = {\n        entity: world.entities.get(eid) || new Entity_Entity(world),\n        components: world.componentCollections.get(eid) || new ComponentCollection(),\n        world,\n        index,\n        size,\n        isFirst: index === 0,\n        isLast: index + 1 === size\n      };\n      systemFunc(args);\n      index += 1;\n    }\n  };\n}\n// CONCATENATED MODULE: ./src/index.ts\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9lY3N0YXRpYy8uL3NyYy9Db21wb25lbnRDb2xsZWN0aW9uLnRzPzUxYzQiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9zcmMvV29ybGQudHM/Y2MwYiIsIndlYnBhY2s6Ly9lY3N0YXRpYy8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvcm5nLmpzP2Q4ZjgiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL2J5dGVzVG9VdWlkLmpzP2I2OTEiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3Y0LmpzP2VjMjYiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9zcmMvRW50aXR5LnRzP2FjNjgiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9zcmMvU3lzdGVtLnRzPzMyNDgiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9zcmMvaW5kZXgudHM/ZmZiNCJdLCJuYW1lcyI6WyJDb21wb25lbnRDb2xsZWN0aW9uIiwiTWFwIiwiY29tcG9uZW50IiwiY29tcG9uZW50cyIsInNldCIsInR5cGUiLCJjVHlwZSIsImZ1bmMiLCJoYXMiLCJjIiwiZ2V0IiwidXBkYXRlZENvbXBvbmVudCIsImRlbGV0ZSIsIkVycm9yIiwiQXJyYXkiLCJpc0FycmF5IiwiZXZlcnkiLCJjdCIsImNvbXBvbmVudFR5cGVzIiwia2V5cyIsInNpemUiLCJXb3JsZCIsInByZWRpY2F0ZSIsImVudGl0eSIsImVudGl0aWVzIiwidmFsdWVzIiwicmVzdWx0cyIsInB1c2giLCJjVHlwZXMiLCJsb2NhdGUiLCJjYyIsImNvbXBvbmVudENvbGxlY3Rpb25zIiwiaWQiLCJsb2NhdGVBbGwiLCJtYXAiLCJlaWQiLCJhZGQiLCJjdEFyciIsImVudGl0eVNldCIsImVudGl0aWVzQnlDVHlwZXMiLCJyZW1vdmUiLCJyZWdpc3RlclN5c3RlbSIsIlNldCIsInJlZ2lzdGVyRW50aXR5IiwiY2xlYXJFbnRpdHlDb21wb25lbnRzIiwiZGVzdHJveUVudGl0eSIsIkVudGl0eSIsImNvbnN0cnVjdG9yIiwid29ybGQiLCJfaWQiLCJ1dWlkdjQiLCJfd29ybGQiLCJnZXRBbGwiLCJjbGVhciIsImRlc3Ryb3kiLCJjcmVhdGVFbnRpdHkiLCJjcmVhdGVTeXN0ZW0iLCJzeXN0ZW1GdW5jIiwiaW5kZXgiLCJjVHlwZUFycnMiLCJhcmdzIiwiaXNGaXJzdCIsImlzTGFzdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFFZSxNQUFNQSxtQkFBTixDQUE4QjtBQUFBO0FBQUEsd0NBQ0UsSUFBSUMsR0FBSixFQURGOztBQUFBLGlDQUdwQ0MsU0FBRCxJQUFvQztBQUN4QyxXQUFLQyxVQUFMLENBQWdCQyxHQUFoQixDQUFvQkYsU0FBUyxDQUFDRyxJQUE5QixFQUFvQ0gsU0FBcEM7QUFDRCxLQUwwQzs7QUFBQSxvQ0FPbEMsQ0FBQ0ksS0FBRCxFQUFZQyxJQUFaLEtBQWdFO0FBQ3ZFLFVBQUksS0FBS0osVUFBTCxDQUFnQkssR0FBaEIsQ0FBb0JGLEtBQXBCLENBQUosRUFBZ0M7QUFDOUIsY0FBTUcsQ0FBQyxHQUFHLEtBQUtOLFVBQUwsQ0FBZ0JPLEdBQWhCLENBQW9CSixLQUFwQixDQUFWOztBQUVBLFlBQUlHLENBQUosRUFBTztBQUNMLGdCQUFNRSxnQkFBZ0IsR0FBR0osSUFBSSxDQUFDRSxDQUFELENBQTdCO0FBQ0EsZUFBS04sVUFBTCxDQUFnQkMsR0FBaEIsQ0FBb0JFLEtBQXBCLEVBQTJCSyxnQkFBM0I7QUFDRDtBQUNGO0FBQ0YsS0FoQjBDOztBQUFBLG9DQWtCakNMLEtBQUQsSUFBcUI7QUFDNUIsV0FBS0gsVUFBTCxDQUFnQlMsTUFBaEIsQ0FBdUJOLEtBQXZCO0FBQ0QsS0FwQjBDOztBQUFBLGlDQXNCakNBLEtBQUosSUFBcUI7QUFDekIsVUFBSSxDQUFDLEtBQUtILFVBQUwsQ0FBZ0JLLEdBQWhCLENBQW9CRixLQUFwQixDQUFMLEVBQWlDO0FBQy9CLGNBQU0sSUFBSU8sS0FBSixD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OUNEO0FBK0NELEM7O0FDMUVEO0FBQ0E7QUFDQSIsImZpbGUiOiIxLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9Db21wb25lbnQnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21wb25lbnRDb2xsZWN0aW9uPENUPiB7XG4gIHByaXZhdGUgY29tcG9uZW50czogTWFwPENULCBDb21wb25lbnQ8Q1Q+PiA9IG5ldyBNYXAoKTtcblxuICBhZGQgPSAoY29tcG9uZW50OiBDb21wb25lbnQ8Q1Q+KTogdm9pZCA9PiB7XG4gICAgdGhpcy5jb21wb25lbnRzLnNldChjb21wb25lbnQudHlwZSwgY29tcG9uZW50KTtcbiAgfVxuXG4gIHVwZGF0ZSA9IChjVHlwZTogQ1QsIGZ1bmM6IChjOiBDb21wb25lbnQ8Q1Q+KSA9PiBDb21wb25lbnQ8Q1Q+KTogdm9pZCA9PiB7XG4gICAgaWYgKHRoaXMuY29tcG9uZW50cy5oYXMoY1R5cGUpKSB7XG4gICAgICBjb25zdCBjID0gdGhpcy5jb21wb25lbnRzLmdldChjVHlwZSk7XG5cbiAgICAgIGlmIChjKSB7XG4gICAgICAgIGNvbnN0IHVwZGF0ZWRDb21wb25lbnQgPSBmdW5jKGMpO1xuICAgICAgICB0aGlzLmNvbXBvbmVudHMuc2V0KGNUeXBlLCB1cGRhdGVkQ29tcG9uZW50KTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcmVtb3ZlID0gKGNUeXBlOiBDVCk6IHZvaWQgPT4ge1xuICAgIHRoaXMuY29tcG9uZW50cy5kZWxldGUoY1R5cGUpO1xuICB9XG5cbiAgZ2V0ID0gPEM+KGNUeXBlOiBDVCk6IEMgPT4ge1xuICAgIGlmICghdGhpcy5jb21wb25lbnRzLmhhcyhjVHlwZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQ29tcG9uZW50Q29sbGVjdGlvbiBkb2VzIG5vdCBoYXZlIGNvbXBvbmVudCBvZiB0eXBlICR7Y1R5cGV9YClcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRoaXMuY29tcG9uZW50cy5nZXQoY1R5cGUpIGFzIHVua25vd24gYXMgQztcbiAgfVxuXG4gIGhhcyA9IChjVHlwZTogQ1QgfCBDVFtdKTogYm9vbGVhbiA9PiB7XG4gICAgaWYgKEFycmF5LmlzQXJyYXkoY1R5cGUpKSB7XG4gICAgICByZXR1cm4gY1R5cGUuZXZlcnkoKGN0KSA9PiB0aGlzLmNvbXBvbmVudHMuaGFzKGN0KSA9PT0gdHJ1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudHMuaGFzKGNUeXBlKVxuICAgIH1cbiAgfVxuXG4gIGdldCBjb21wb25lbnRUeXBlcygpOiBDVFtdIHtcbiAgICByZXR1cm4gWy4uLnRoaXMuY29tcG9uZW50cy5rZXlzKCldO1xuICB9XG5cbiAgZ2V0IHNpemUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5jb21wb25lbnRzLnNpemU7XG4gIH1cbn1cbiIsImltcG9ydCBFbnRpdHksIHsgRW50aXR5SWQgfSBmcm9tICcuL0VudGl0eSc7XG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICcuL0NvbXBvbmVudCc7XG5pbXBvcnQgQ29tcG9uZW50Q29sbGVjdGlvbiBmcm9tICcuL0NvbXBvbmVudENvbGxlY3Rpb24nO1xuXG50eXBlIEZpbmRQcmVkaWNhdGU8Q1Q+ID0gKGVudGl0eTogRW50aXR5PENUPikgPT4gYm9vbGVhbjtcblxudHlwZSBHcmFiUHJlZGljYXRlPEM+ID0gKGNvbXBvbmVudDogQykgPT4gYm9vbGVhbjtcblxuaW50ZXJmYWNlIFNpbmdsZUNvbXBvbmVudFJlc3A8Q1QsIEM+IHtcbiAgZW50aXR5OiBFbnRpdHk8Q1Q+O1xuICBjb21wb25lbnQ6IEM7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFdvcmxkPENUPiB7XG4gIGNvbXBvbmVudENvbGxlY3Rpb25zOiBNYXA8RW50aXR5SWQsIENvbXBvbmVudENvbGxlY3Rpb248Q1Q+PiA9IG5ldyBNYXAoKTtcblxuICBlbnRpdGllczogTWFwPEVudGl0eUlkLCBFbnRpdHk8Q1Q+PiA9IG5ldyBNYXAoKTtcblxuICBlbnRpdGllc0J5Q1R5cGVzOiBNYXA8Q1RbXSwgU2V0PEVudGl0eUlkPj4gPSBuZXcgTWFwKCk7XG5cbiAgLyoqXG4gICAqIFwiZmluZHNcIiBhIHNpbmdsZSBlbnRpdHkgYmFzZWQgb24gYSBwcmVkaWNhdGVcbiAgICovXG4gIGZpbmQgPSAocHJlZGljYXRlOiBGaW5kUHJlZGljYXRlPENUPik6IEVudGl0eTxDVD4gfCBudWxsID0+IHtcbiAgICBmb3IgKGNvbnN0IGVudGl0eSBvZiB0aGlzLmVudGl0aWVzLnZhbHVlcygpKSB7XG4gICAgICBpZiAocHJlZGljYXRlKGVudGl0eSkpIHtcbiAgICAgICAgcmV0dXJuIGVudGl0eTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfTtcblxuICAvKipcbiAgICogXCJmaW5kc1wiIGFsbCBlbnRpdGllcyBiYXNlZCBvbiBhIHByZWRpY2F0ZSwga2luZGEgbGlrZSBmaWx0ZXIuXG4gICAqL1xuICBmaW5kQWxsID0gKHByZWRpY2F0ZTogRmluZFByZWRpY2F0ZTxDVD4pOiBFbnRpdHk8Q1Q+W10gPT4ge1xuICAgIGNvbnN0IHJlc3VsdHM6IEVudGl0eTxDVD5bXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBlbnRpdHkgb2YgdGhpcy5lbnRpdGllcy52YWx1ZXMoKSkge1xuICAgICAgaWYgKHByZWRpY2F0ZShlbnRpdHkpKSB7XG4gICAgICAgIHJlc3VsdHMucHVzaChlbnRpdHkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXN1bHRzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBcImxvY2F0ZXNcIiBhIHNpbmdsZSBlbnRpdHkgYmFzZWQgb24gaXRzIENvbXBvbmVudHMuXG4gICAqL1xuICBsb2NhdGUgPSAoY1R5cGVzOiBDVCB8IENUW10pOiBFbnRpdHk8Q1Q+IHwgbnVsbCA9PiB7XG4gICAgZm9yIChjb25zdCBlbnRpdHkgb2YgdGhpcy5lbnRpdGllcy52YWx1ZXMoKSkge1xuICAgICAgaWYgKGVudGl0eS5jb21wb25lbnRzLmhhcyhjVHlwZXMpKSB7XG4gICAgICAgIHJldHVybiBlbnRpdHk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG5cbiAgLyoqXG4gICAqIExvY2F0ZXMgYWxsIGVudGl0aWVzIHRoYXQgY29udGFpbiB0aGUgY29tcG9uZW50cyBuYW1lZFxuICAgKi9cbiAgbG9jYXRlQWxsID0gKGNUeXBlczogQ1QgfCBDVFtdKTogRW50aXR5PENUPltdID0+IHtcbiAgICBjb25zdCByZXN1bHRzOiBFbnRpdHk8Q1Q+W10gPSBbXTtcblxuICAgIGZvciAoY29uc3QgZW50aXR5IG9mIHRoaXMuZW50aXRpZXMudmFsdWVzKCkpIHtcbiAgICAgIGlmIChlbnRpdHkuY29tcG9uZW50cy5oYXMoY1R5cGVzKSkge1xuICAgICAgICByZXN1bHRzLnB1c2goZW50aXR5KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfTtcblxuICAvKipcbiAgICogR3JhYnMgdGhlIGZpcnN0IGVudGl0eSwgYW5kIGl0cyByZWxhdGVkIGNvbXBvbmVudCwgdGhhdCBtYXRjaGVzIHRoZSBjb21wb25lbnQgdHlwZS5cbiAgICogQGV4YW1wbGVcbiAgICogYGBgXG4gICAqIGNvbnN0IHsgZW50aXR5LCBjb21wb25lbnQgfSA9IHdvcmxkLmdyYWI8TXlDb21wb25lbnQ+KENvbXBvbmVudHMuTXlDb21wb25lbnQpO1xuICAgKiBgYGBcbiAgICovXG4gIGdyYWIgPSA8Qz4oY1R5cGU6IENUKTogU2luZ2xlQ29tcG9uZW50UmVzcDxDVCwgQz4gfCBudWxsID0+IHtcbiAgICBjb25zdCBlbnRpdHkgPSB0aGlzLmxvY2F0ZShjVHlwZSk7XG5cbiAgICBpZiAoZW50aXR5KSB7XG4gICAgICBjb25zdCBjYyA9XG4gICAgICAgIHRoaXMuY29tcG9uZW50Q29sbGVjdGlvbnMuZ2V0KGVudGl0eS5pZCkgfHxcbiAgICAgICAgbmV3IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+KCk7XG5cbiAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGNjLmdldDxDPihjVHlwZSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGVudGl0eSxcbiAgICAgICAgY29tcG9uZW50LFxuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfTtcblxuICAvKipcbiAgICogR3JhYiBzaW5nbGUgY29tcG9uZW50IGJhc2VkIG9uIGNvbXBvbmVudCB0eXBlIGFuZCBwcmVkaWNhdGUuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYHR5cGVzY3JpcHRcbiAgICogY29uc3QgeyBlbnRpdHksIGNvbXBvbmVudCB9ID0gd29ybGQuZ3JhYkJ5KENvbXBvbmVudHMuRmlyc3RDb21wb25lbnQsIChjb21wKSA9PiBjb21wLmlkID09ICdhd2Vzb21lJylcbiAgICogYGBgXG4gICAqL1xuICBncmFiQnkgPSA8Qz4oXG4gICAgY1R5cGU6IENULFxuICAgIHByZWRpY2F0ZTogR3JhYlByZWRpY2F0ZTxDPlxuICApOiBTaW5nbGVDb21wb25lbnRSZXNwPENULCBDPiB8IG51bGwgPT4ge1xuICAgIGNvbnN0IGVudGl0aWVzID0gdGhpcy5sb2NhdGVBbGwoY1R5cGUpO1xuXG4gICAgZm9yIChjb25zdCBlbnRpdHkgb2YgZW50aXRpZXMpIHtcbiAgICAgIGNvbnN0IGNjID1cbiAgICAgICAgdGhpcy5jb21wb25lbnRDb2xsZWN0aW9ucy5nZXQoZW50aXR5LmlkKSB8fFxuICAgICAgICBuZXcgQ29tcG9uZW50Q29sbGVjdGlvbjxDVD4oKTtcblxuICAgICAgY29uc3QgY29tcG9uZW50ID0gY2MuZ2V0PEM+KGNUeXBlKTtcblxuICAgICAgaWYgKHByZWRpY2F0ZShjb21wb25lbnQpKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgY29tcG9uZW50LFxuICAgICAgICAgIGVudGl0eSxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfTtcblxuICAvKipcbiAgICogR3JhYiBhbGwgdGhlIGNvbXBvbmVudHMgcHJpbWFyaWx5LCBhbmQgdGhlIGVudGl0aWVzIGlmIG5lZWRlZFxuICAgKi9cbiAgZ3JhYkFsbCA9IDxDPihjVHlwZTogQ1QpOiBTaW5nbGVDb21wb25lbnRSZXNwPENULCBDPltdID0+IHtcbiAgICByZXR1cm4gdGhpcy5sb2NhdGVBbGwoY1R5cGUpLm1hcCgoZW50aXR5KSA9PiAoe1xuICAgICAgZW50aXR5LFxuICAgICAgY29tcG9uZW50OiAoZW50aXR5LmNvbXBvbmVudHMuZ2V0KGNUeXBlKSBhcyB1bmtub3duKSBhcyBDLFxuICAgIH0pKTtcbiAgfTtcblxuICAvKipcbiAgICogR2l2ZW4gYW4gZW50aXR5IGlkIGFuZCBjb21wb25lbnRUeXBlLCByZXR1cm5zIGNvbXBvbmVudFxuICAgKi9cbiAgZ2V0ID0gPEM+KGVpZDogRW50aXR5SWQsIGNUeXBlOiBDVCk6IEMgPT4ge1xuICAgIGNvbnN0IGNjID1cbiAgICAgIHRoaXMuY29tcG9uZW50Q29sbGVjdGlvbnMuZ2V0KGVpZCkgfHwgbmV3IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+KCk7XG5cbiAgICByZXR1cm4gY2MuZ2V0PEM+KGNUeXBlKTtcbiAgfTtcblxuXG4gIC8qKlxuICAgKiBTZXQgYSBjb21wb25lbnQgb24gdGhlIGdpdmVuIGVudGl0eVxuICAgKi9cbiAgc2V0ID0gKGVpZDogRW50aXR5SWQsIGNvbXBvbmVudDogQ29tcG9uZW50PENUPik6IHZvaWQgPT4ge1xuICAgIGNvbnN0IGNjID1cbiAgICAgIHRoaXMuY29tcG9uZW50Q29sbGVjdGlvbnMuZ2V0KGVpZCkgfHwgbmV3IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+KCk7XG5cbiAgICBjYy5hZGQoY29tcG9uZW50KTtcblxuICAgIHRoaXMuY29tcG9uZW50Q29sbGVjdGlvbnMuc2V0KGVpZCwgY2MpO1xuXG4gICAgZm9yIChjb25zdCBbY3RBcnIsIGVudGl0eVNldF0gb2YgdGhpcy5lbnRpdGllc0J5Q1R5cGVzKSB7XG4gICAgICBpZiAoY3RBcnIuZXZlcnkoY2MuaGFzKSkge1xuICAgICAgICBlbnRpdHlTZXQuYWRkKGVpZCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBSZW1vdmUgYSBjb21wb25lbnQgZnJvbSB0aGUgZ2l2ZW4gZW50aXR5LlxuICAgKiBOT1RFOiBUaGlzIHdpbGwgY2hhbmdlIHdoYXQgc3lzdGVtcyB3aWxsIGJlIGNhbGxlZCBvbiB0aGUgZW50aXR5LlxuICAgKi9cbiAgcmVtb3ZlID0gKGVpZDogRW50aXR5SWQsIGNUeXBlOiBDVCk6IHZvaWQgPT4ge1xuICAgIGNvbnN0IGNjID1cbiAgICAgIHRoaXMuY29tcG9uZW50Q29sbGVjdGlvbnMuZ2V0KGVpZCkgfHwgbmV3IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+KCk7XG5cbiAgICAvLyByZW1vdmUgZW50aXR5IGZyb20gY3VycmVudCBlbnRpdGllc0J5Q1R5cGVzXG4gICAgZm9yIChjb25zdCBbY3RBcnIsIGVudGl0eVNldF0gb2YgdGhpcy5lbnRpdGllc0J5Q1R5cGVzKSB7XG4gICAgICBpZiAoY3RBcnIuZXZlcnkoY2MuaGFzKSkge1xuICAgICAgICBlbnRpdHlTZXQuZGVsZXRlKGVpZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY2MucmVtb3ZlKGNUeXBlKTtcblxuICAgIC8vIE1vdmUgZW50aXR5SWQgdG8gbmV3IENUeXBlcyBpZiBuZWVkZWQuXG4gICAgZm9yIChjb25zdCBbY3RBcnIsIGVudGl0eVNldF0gb2YgdGhpcy5lbnRpdGllc0J5Q1R5cGVzKSB7XG4gICAgICBpZiAoY3RBcnIuZXZlcnkoY2MuaGFzKSkge1xuICAgICAgICBlbnRpdHlTZXQuYWRkKGVpZCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJlZ2lzdGVyU3lzdGVtKGNUeXBlczogQ1RbXSk6IHZvaWQge1xuICAgIHRoaXMuZW50aXRpZXNCeUNUeXBlcy5zZXQoY1R5cGVzLCBuZXcgU2V0PEVudGl0eUlkPigpKTtcbiAgfVxuXG4gIHJlZ2lzdGVyRW50aXR5KGVudGl0eTogRW50aXR5PENUPik6IHZvaWQge1xuICAgIGNvbnN0IGNjID0gbmV3IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+KCk7XG5cbiAgICB0aGlzLmNvbXBvbmVudENvbGxlY3Rpb25zLnNldChlbnRpdHkuaWQsIGNjKTtcbiAgICB0aGlzLmVudGl0aWVzLnNldChlbnRpdHkuaWQsIGVudGl0eSk7XG4gIH1cblxuICBjbGVhckVudGl0eUNvbXBvbmVudHMoZWlkOiBFbnRpdHlJZCk6IHZvaWQge1xuICAgIHRoaXMuY29tcG9uZW50Q29sbGVjdGlvbnMuc2V0KGVpZCwgbmV3IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+KCkpO1xuXG4gICAgZm9yIChjb25zdCBlbnRpdHlTZXQgb2YgdGhpcy5lbnRpdGllc0J5Q1R5cGVzLnZhbHVlcygpKSB7XG4gICAgICBpZiAoZW50aXR5U2V0LmhhcyhlaWQpKSB7XG4gICAgICAgIGVudGl0eVNldC5kZWxldGUoZWlkKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBkZXN0cm95RW50aXR5KGVpZDogRW50aXR5SWQpOiB2b2lkIHtcbiAgICB0aGlzLmNvbXBvbmVudENvbGxlY3Rpb25zLmRlbGV0ZShlaWQpO1xuICAgIHRoaXMuZW50aXRpZXMuZGVsZXRlKGVpZCk7XG5cbiAgICBmb3IgKGNvbnN0IGVudGl0eVNldCBvZiB0aGlzLmVudGl0aWVzQnlDVHlwZXMudmFsdWVzKCkpIHtcbiAgICAgIGlmIChlbnRpdHlTZXQuaGFzKGVpZCkpIHtcbiAgICAgICAgZW50aXR5U2V0LmRlbGV0ZShlaWQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIiwiLy8gVW5pcXVlIElEIGNyZWF0aW9uIHJlcXVpcmVzIGEgaGlnaCBxdWFsaXR5IHJhbmRvbSAjIGdlbmVyYXRvci4gSW4gdGhlIGJyb3dzZXIgd2UgdGhlcmVmb3JlXG4vLyByZXF1aXJlIHRoZSBjcnlwdG8gQVBJIGFuZCBkbyBub3Qgc3VwcG9ydCBidWlsdC1pbiBmYWxsYmFjayB0byBsb3dlciBxdWFsaXR5IHJhbmRvbSBudW1iZXJcbi8vIGdlbmVyYXRvcnMgKGxpa2UgTWF0aC5yYW5kb20oKSkuXG4vLyBnZXRSYW5kb21WYWx1ZXMgbmVlZHMgdG8gYmUgaW52b2tlZCBpbiBhIGNvbnRleHQgd2hlcmUgXCJ0aGlzXCIgaXMgYSBDcnlwdG8gaW1wbGVtZW50YXRpb24uIEFsc28sXG4vLyBmaW5kIHRoZSBjb21wbGV0ZSBpbXBsZW1lbnRhdGlvbiBvZiBjcnlwdG8gKG1zQ3J5cHRvKSBvbiBJRTExLlxudmFyIGdldFJhbmRvbVZhbHVlcyA9IHR5cGVvZiBjcnlwdG8gIT09ICd1bmRlZmluZWQnICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKGNyeXB0bykgfHwgdHlwZW9mIG1zQ3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgbXNDcnlwdG8uZ2V0UmFuZG9tVmFsdWVzID09PSAnZnVuY3Rpb24nICYmIG1zQ3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKG1zQ3J5cHRvKTtcbnZhciBybmRzOCA9IG5ldyBVaW50OEFycmF5KDE2KTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJuZygpIHtcbiAgaWYgKCFnZXRSYW5kb21WYWx1ZXMpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2NyeXB0by5nZXRSYW5kb21WYWx1ZXMoKSBub3Qgc3VwcG9ydGVkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkI2dldHJhbmRvbXZhbHVlcy1ub3Qtc3VwcG9ydGVkJyk7XG4gIH1cblxuICByZXR1cm4gZ2V0UmFuZG9tVmFsdWVzKHJuZHM4KTtcbn0iLCIvKipcbiAqIENvbnZlcnQgYXJyYXkgb2YgMTYgYnl0ZSB2YWx1ZXMgdG8gVVVJRCBzdHJpbmcgZm9ybWF0IG9mIHRoZSBmb3JtOlxuICogWFhYWFhYWFgtWFhYWC1YWFhYLVhYWFgtWFhYWFhYWFhYWFhYXG4gKi9cbnZhciBieXRlVG9IZXggPSBbXTtcblxuZm9yICh2YXIgaSA9IDA7IGkgPCAyNTY7ICsraSkge1xuICBieXRlVG9IZXgucHVzaCgoaSArIDB4MTAwKS50b1N0cmluZygxNikuc3Vic3RyKDEpKTtcbn1cblxuZnVuY3Rpb24gYnl0ZXNUb1V1aWQoYnVmLCBvZmZzZXRfKSB7XG4gIHZhciBvZmZzZXQgPSBvZmZzZXRfIHx8IDA7IC8vIE5vdGU6IEJlIGNhcmVmdWwgZWRpdGluZyB0aGlzIGNvZGUhICBJdCdzIGJlZW4gdHVuZWQgZm9yIHBlcmZvcm1hbmNlXG4gIC8vIGFuZCB3b3JrcyBpbiB3YXlzIHlvdSBtYXkgbm90IGV4cGVjdC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZC9wdWxsLzQzNFxuXG4gIHJldHVybiAoYnl0ZVRvSGV4W2J1ZltvZmZzZXQgKyAwXV0gKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDFdXSArIGJ5dGVUb0hleFtidWZbb2Zmc2V0ICsgMl1dICsgYnl0ZVRvSGV4W2J1ZltvZmZzZXQgKyAzXV0gKyAnLScgKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDRdXSArIGJ5dGVUb0hleFtidWZbb2Zmc2V0ICsgNV1dICsgJy0nICsgYnl0ZVRvSGV4W2J1ZltvZmZzZXQgKyA2XV0gKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDddXSArICctJyArIGJ5dGVUb0hleFtidWZbb2Zmc2V0ICsgOF1dICsgYnl0ZVRvSGV4W2J1ZltvZmZzZXQgKyA5XV0gKyAnLScgKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDEwXV0gKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDExXV0gKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDEyXV0gKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDEzXV0gKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDE0XV0gKyBieXRlVG9IZXhbYnVmW29mZnNldCArIDE1XV0pLnRvTG93ZXJDYXNlKCk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGJ5dGVzVG9VdWlkOyIsImltcG9ydCBybmcgZnJvbSAnLi9ybmcuanMnO1xuaW1wb3J0IGJ5dGVzVG9VdWlkIGZyb20gJy4vYnl0ZXNUb1V1aWQuanMnO1xuXG5mdW5jdGlvbiB2NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgdmFyIHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgcm5nKSgpOyAvLyBQZXIgNC40LCBzZXQgYml0cyBmb3IgdmVyc2lvbiBhbmQgYGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWRgXG5cbiAgcm5kc1s2XSA9IHJuZHNbNl0gJiAweDBmIHwgMHg0MDtcbiAgcm5kc1s4XSA9IHJuZHNbOF0gJiAweDNmIHwgMHg4MDsgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG5cbiAgaWYgKGJ1Zikge1xuICAgIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICBidWZbb2Zmc2V0ICsgaV0gPSBybmRzW2ldO1xuICAgIH1cblxuICAgIHJldHVybiBidWY7XG4gIH1cblxuICByZXR1cm4gYnl0ZXNUb1V1aWQocm5kcyk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHY0OyIsImltcG9ydCB7IHY0IGFzIHV1aWR2NCB9IGZyb20gJ3V1aWQnO1xuaW1wb3J0IFdvcmxkIGZyb20gJy4vV29ybGQnO1xuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi9Db21wb25lbnQnO1xuaW1wb3J0IENvbXBvbmVudENvbGxlY3Rpb24gZnJvbSAnLi9Db21wb25lbnRDb2xsZWN0aW9uJztcblxuZXhwb3J0IHR5cGUgRW50aXR5SWQgPSBzdHJpbmc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVudGl0eTxDVD4ge1xuICBwcml2YXRlIF9pZDogc3RyaW5nO1xuICBwcml2YXRlIF93b3JsZDogV29ybGQ8Q1Q+O1xuXG4gIGNvbnN0cnVjdG9yKHdvcmxkOiBXb3JsZDxDVD4pIHtcbiAgICB0aGlzLl9pZCA9IHV1aWR2NCgpO1xuICAgIHRoaXMuX3dvcmxkID0gd29ybGQ7XG5cbiAgICAvKlxuICAgIFJlZ2lzdGVyaW5nIHdpdGggdGhlIFdvcmxkLlxuICAgICovXG4gICAgdGhpcy5fd29ybGQucmVnaXN0ZXJFbnRpdHkodGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogQWRkIGEgY29tcG9uZW50IHRvIGFuIEVudGl0eSwgZG9oLlxuICAgKi9cbiAgYWRkKGNvbXBvbmVudDogQ29tcG9uZW50PENUPik6IEVudGl0eTxDVD4ge1xuICAgIHRoaXMuX3dvcmxkLnNldCh0aGlzLl9pZCwgY29tcG9uZW50KTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZXMgaWYgYW4gZW50aXR5IGhhcyBhIGNvbXBvbmVudCByZWxhdGVkIHRvIGl0LlxuICAgKi9cbiAgaGFzKGNUeXBlOiBDVCk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGNjID0gdGhpcy5fd29ybGQuY29tcG9uZW50Q29sbGVjdGlvbnMuZ2V0KHRoaXMuX2lkKSB8fCBuZXcgQ29tcG9uZW50Q29sbGVjdGlvbjxDVD4oKTtcblxuICAgIHJldHVybiBjYy5oYXMoY1R5cGUpO1xuICB9XG5cbiAgZ2V0PEM+KGNUeXBlOiBDVCk6IEMge1xuICAgIGNvbnN0IGNjID0gdGhpcy5fd29ybGQuY29tcG9uZW50Q29sbGVjdGlvbnMuZ2V0KHRoaXMuX2lkKSB8fCBuZXcgQ29tcG9uZW50Q29sbGVjdGlvbjxDVD4oKTtcblxuICAgIGNvbnN0IGNvbXBvbmVudCA9IGNjLmdldDxDPihjVHlwZSk7XG5cbiAgICByZXR1cm4gY29tcG9uZW50O1xuICB9XG5cbiAgZ2V0QWxsKCk6IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+IHtcbiAgICByZXR1cm4gdGhpcy5fd29ybGQuY29tcG9uZW50Q29sbGVjdGlvbnMuZ2V0KHRoaXMuX2lkKSB8fCBuZXcgQ29tcG9uZW50Q29sbGVjdGlvbjxDVD4oKTtcbiAgfVxuXG4gIGdldCBjb21wb25lbnRzKCk6IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+IHtcbiAgICByZXR1cm4gdGhpcy5fd29ybGQuY29tcG9uZW50Q29sbGVjdGlvbnMuZ2V0KHRoaXMuX2lkKSB8fCBuZXcgQ29tcG9uZW50Q29sbGVjdGlvbjxDVD4oKTtcbiAgfVxuXG4gIHJlbW92ZShjVHlwZTogQ1QpOiBFbnRpdHk8Q1Q+IHtcbiAgICB0aGlzLl93b3JsZC5yZW1vdmUodGhpcy5faWQsIGNUeXBlKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLyoqIENsZWFycyBhbGwgY29tcG9uZW50cyBmcm9tIGFuIEVudGl0eSAqL1xuICBjbGVhcigpOiBFbnRpdHk8Q1Q+IHtcbiAgICB0aGlzLl93b3JsZC5jbGVhckVudGl0eUNvbXBvbmVudHModGhpcy5faWQpO1xuXG4gICAgcmV0dXJuIHRoaXNcbiAgfVxuXG4gIGRlc3Ryb3koKTogdm9pZCB7XG4gICAgdGhpcy5fd29ybGQuZGVzdHJveUVudGl0eSh0aGlzLl9pZCk7XG4gIH1cblxuICBnZXQgaWQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5faWQ7XG4gIH1cblxuICBnZXQgd29ybGQoKTogV29ybGQ8Q1Q+IHtcbiAgICByZXR1cm4gdGhpcy5fd29ybGQ7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUVudGl0eTxDVD4oXG4gIHdvcmxkOiBXb3JsZDxDVD4sXG4pOiBFbnRpdHk8Q1Q+IHtcbiAgY29uc3QgZW50aXR5ID0gbmV3IEVudGl0eTxDVD4od29ybGQpO1xuXG4gIHJldHVybiBlbnRpdHk7XG59XG5cblxuIiwiaW1wb3J0IFdvcmxkIGZyb20gJy4vV29ybGQnO1xuaW1wb3J0IEVudGl0eSBmcm9tICcuL0VudGl0eSc7XG5pbXBvcnQgQ29tcG9uZW50Q29sbGVjdGlvbiBmcm9tICcuL0NvbXBvbmVudENvbGxlY3Rpb24nO1xuXG5leHBvcnQgdHlwZSBTeXN0ZW0gPSAoKSA9PiB2b2lkO1xuXG5leHBvcnQgaW50ZXJmYWNlIFN5c3RlbUZ1bmNBcmdzPENUPiB7XG4gIGVudGl0eTogRW50aXR5PENUPjtcbiAgY29tcG9uZW50czogQ29tcG9uZW50Q29sbGVjdGlvbjxDVD47XG4gIHdvcmxkOiBXb3JsZDxDVD47XG4gIGluZGV4OiBudW1iZXI7XG4gIHNpemU6IG51bWJlcjtcbiAgaXNGaXJzdDogYm9vbGVhbjtcbiAgaXNMYXN0OiBib29sZWFuO1xufVxuXG5leHBvcnQgdHlwZSBTeXN0ZW1GdW5jPENUPiA9IChcbiAgc3l0ZW1GdW5jQXJnczogU3lzdGVtRnVuY0FyZ3M8Q1Q+LFxuKSA9PiB2b2lkO1xuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU3lzdGVtPENUPihcbiAgd29ybGQ6IFdvcmxkPENUPixcbiAgY1R5cGVzOiBDVFtdLFxuICBzeXN0ZW1GdW5jOiBTeXN0ZW1GdW5jPENUPlxuKTogU3lzdGVtIHtcbiAgd29ybGQucmVnaXN0ZXJTeXN0ZW0oY1R5cGVzKTtcblxuICByZXR1cm4gKCk6IHZvaWQgPT4ge1xuICAgIGxldCBpbmRleCA9IDA7XG4gICAgY29uc3Qgc2l6ZSA9IHdvcmxkLmVudGl0aWVzQnlDVHlwZXMuc2l6ZTtcblxuICAgIC8vIFVzZWQgZm9yIG1hdGNoaW5nIHRoZSBhcnJheSBvZiBDb21wb25lbnRUeXBlcyB3aGljaCBpcyB0aGUga2V5XG4gICAgLy8gb2Ygd2hlcmUgdGhlIENvbXBvbmVudENvbGxlY3Rpb24gaXMsIHdpdGggdGhlIGFycmF5IG9mIENvbXBvbmVudFR5cGVzXG4gICAgLy8gdGhhdCBhcmUgcGFzc2VzLlxuICAgIC8vIE1pZ2h0IGJlIG5pY2UgaW4gdGhlIGZ1dHVyZSB0byBnbyBiYWNrIHRvIGEgcmVmIGNoZWNrIG9uIGNUeXBlcywgYnV0XG4gICAgLy8gZm9yIG5vdyB0aGlzIGRvZXNuJ3Qgc2VlbSB0byBiZSB0aGF0IG11Y2ggb2YgYSBwZXJmIGhpdC5cbiAgICAvLyBmb3IgKGNvbnN0IGN0IG9mIHdvcmxkLmVudGl0aWVzQnlDVHlwZXMua2V5cygpKSB7XG4gICAgLy8gICBpZiAoY1R5cGVzLmxlbmd0aCA9PT0gY3QubGVuZ3RoICYmIGNUeXBlcy5ldmVyeShjID0+IGN0LmluY2x1ZGVzKGMpKSkge1xuICAgIC8vICAgICBmb3IgKGNvbnN0IGVpZCBvZiB3b3JsZC5lbnRpdGllc0J5Q1R5cGVzLmdldChjVHlwZXMpKSB7XG4gICAgLy8gICAgICAgY29uc3QgYXJnczogU3lzdGVtRnVuY0FyZ3M8Q1Q+ID0ge1xuICAgIC8vICAgICAgICAgZW50aXR5OiB3b3JsZC5lbnRpdGllcy5nZXQoZWlkKSxcbiAgICAvLyAgICAgICAgIGNvbXBvbmVudHM6IHdvcmxkLmNvbXBvbmVudENvbGxlY3Rpb25zLmdldChlaWQpLFxuICAgIC8vICAgICAgICAgd29ybGQsXG4gICAgLy8gICAgICAgICBpbmRleCxcbiAgICAvLyAgICAgICAgIHNpemUsXG4gICAgLy8gICAgICAgICBpc0ZpcnN0OiBpbmRleCA9PT0gMCxcbiAgICAvLyAgICAgICAgIGlzTGFzdDogaW5kZXggKyAxID09PSBzaXplLFxuICAgIC8vICAgICAgIH1cbiAgICBcbiAgICAvLyAgICAgICBzeXN0ZW1GdW5jKGFyZ3MpO1xuICAgIFxuICAgIC8vICAgICAgIGluZGV4ICs9IDE7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgIH1cbiAgICAvLyB9XG5cbiAgICBjb25zdCBjVHlwZUFycnMgPSB3b3JsZC5lbnRpdGllc0J5Q1R5cGVzLmdldChjVHlwZXMpIHx8IG5ldyBTZXQoKTtcblxuICAgIGZvciAoY29uc3QgZWlkIG9mIGNUeXBlQXJycykge1xuICAgICAgY29uc3QgYXJnczogU3lzdGVtRnVuY0FyZ3M8Q1Q+ID0ge1xuICAgICAgICBlbnRpdHk6IHdvcmxkLmVudGl0aWVzLmdldChlaWQpIHx8IG5ldyBFbnRpdHk8Q1Q+KHdvcmxkKSxcbiAgICAgICAgY29tcG9uZW50czogd29ybGQuY29tcG9uZW50Q29sbGVjdGlvbnMuZ2V0KGVpZCkgfHwgbmV3IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+KCksXG4gICAgICAgIHdvcmxkLFxuICAgICAgICBpbmRleCxcbiAgICAgICAgc2l6ZSxcbiAgICAgICAgaXNGaXJzdDogaW5kZXggPT09IDAsXG4gICAgICAgIGlzTGFzdDogaW5kZXggKyAxID09PSBzaXplLFxuICAgICAgfVxuXG4gICAgICBzeXN0ZW1GdW5jKGFyZ3MpO1xuXG4gICAgICBpbmRleCArPSAxO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IFdvcmxkIGZyb20gJy4vV29ybGQnO1xuaW1wb3J0IHsgY3JlYXRlRW50aXR5IH0gZnJvbSAnLi9FbnRpdHknO1xuaW1wb3J0IHsgY3JlYXRlU3lzdGVtIH0gZnJvbSAnLi9TeXN0ZW0nO1xuXG5leHBvcnQge1xuICBXb3JsZCxcbiAgY3JlYXRlRW50aXR5LFxuICBjcmVhdGVTeXN0ZW0sXG59O1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///1\n')}])}));