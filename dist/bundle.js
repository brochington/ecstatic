!function(Q,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("ecstatic",[],n):"object"==typeof exports?exports.ecstatic=n():Q.ecstatic=n()}(window,(function(){return function(Q){var n=window.webpackHotUpdateecstatic;window.webpackHotUpdateecstatic=function(Q,B){!function(Q,n){if(!V[Q]||!y[Q])return;for(var B in y[Q]=!1,n)Object.prototype.hasOwnProperty.call(n,B)&&(b[B]=n[B]);0==--G&&0===u&&Z()}(Q,B),n&&n(Q,B)};var B,e=!0,t="3efab3e406df0cdf40d1",F={},s=[],I=[];function i(Q){var n=N[Q];if(!n)return m;var e=function(e){return n.hot.active?(N[e]?-1===N[e].parents.indexOf(Q)&&N[e].parents.push(Q):(s=[Q],B=e),-1===n.children.indexOf(e)&&n.children.push(e)):(console.warn("[HMR] unexpected require("+e+") from disposed module "+Q),s=[]),m(e)},t=function(Q){return{configurable:!0,enumerable:!0,get:function(){return m[Q]},set:function(n){m[Q]=n}}};for(var F in m)Object.prototype.hasOwnProperty.call(m,F)&&"e"!==F&&"t"!==F&&Object.defineProperty(e,F,t(F));return e.e=function(Q){return"ready"===U&&g("prepare"),u++,m.e(Q).then(n,(function(Q){throw n(),Q}));function n(){u--,"prepare"===U&&(a[Q]||R(Q),0===u&&0===G&&Z())}},e.t=function(Q,n){return 1&n&&(Q=e(Q)),m.t(Q,-2&n)},e}function l(n){var e={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:B!==n,active:!0,accept:function(Q,n){if(void 0===Q)e._selfAccepted=!0;else if("function"==typeof Q)e._selfAccepted=Q;else if("object"==typeof Q)for(var B=0;B<Q.length;B++)e._acceptedDependencies[Q[B]]=n||function(){};else e._acceptedDependencies[Q]=n||function(){}},decline:function(Q){if(void 0===Q)e._selfDeclined=!0;else if("object"==typeof Q)for(var n=0;n<Q.length;n++)e._declinedDependencies[Q[n]]=!0;else e._declinedDependencies[Q]=!0},dispose:function(Q){e._disposeHandlers.push(Q)},addDisposeHandler:function(Q){e._disposeHandlers.push(Q)},removeDisposeHandler:function(Q){var n=e._disposeHandlers.indexOf(Q);n>=0&&e._disposeHandlers.splice(n,1)},invalidate:function(){switch(this._selfInvalidated=!0,U){case"idle":(b={})[n]=Q[n],g("ready");break;case"ready":E(n);break;case"prepare":case"check":case"dispose":case"apply":(C=C||[]).push(n)}},check:x,apply:r,status:function(Q){if(!Q)return U;c.push(Q)},addStatusHandler:function(Q){c.push(Q)},removeStatusHandler:function(Q){var n=c.indexOf(Q);n>=0&&c.splice(n,1)},data:F[n]};return B=void 0,e}var c=[],U="idle";function g(Q){U=Q;for(var n=0;n<c.length;n++)c[n].call(null,Q)}var d,b,o,C,G=0,u=0,a={},y={},V={};function X(Q){return+Q+""===Q?+Q:Q}function x(Q){if("idle"!==U)throw new Error("check() is only allowed in idle status");return e=Q,g("check"),(n=1e4,n=n||1e4,new Promise((function(Q,B){if("undefined"==typeof XMLHttpRequest)return B(new Error("No browser support"));try{var e=new XMLHttpRequest,t=m.p+"hot/hot-update.json";e.open("GET",t,!0),e.timeout=n,e.send(null)}catch(Q){return B(Q)}e.onreadystatechange=function(){if(4===e.readyState)if(0===e.status)B(new Error("Manifest request to "+t+" timed out."));else if(404===e.status)Q();else if(200!==e.status&&304!==e.status)B(new Error("Manifest request to "+t+" failed."));else{try{var n=JSON.parse(e.responseText)}catch(Q){return void B(Q)}Q(n)}}}))).then((function(Q){if(!Q)return g(L()?"ready":"idle"),null;y={},a={},V=Q.c,o=Q.h,g("prepare");var n=new Promise((function(Q,n){d={resolve:Q,reject:n}}));b={};return R(0),"prepare"===U&&0===u&&0===G&&Z(),n}));var n}function R(Q){var n;V[Q]?(y[Q]=!0,G++,(n=document.createElement("script")).charset="utf-8",n.src=m.p+"hot/hot-update.js",document.head.appendChild(n)):a[Q]=!0}function Z(){g("ready");var Q=d;if(d=null,Q)if(e)Promise.resolve().then((function(){return r(e)})).then((function(n){Q.resolve(n)}),(function(n){Q.reject(n)}));else{var n=[];for(var B in b)Object.prototype.hasOwnProperty.call(b,B)&&n.push(X(B));Q.resolve(n)}}function r(n){if("ready"!==U)throw new Error("apply() is only allowed in ready status");return function n(e){var I,i,l,c,U;function d(Q){for(var n=[Q],B={},e=n.map((function(Q){return{chain:[Q],id:Q}}));e.length>0;){var t=e.pop(),F=t.id,s=t.chain;if((c=N[F])&&(!c.hot._selfAccepted||c.hot._selfInvalidated)){if(c.hot._selfDeclined)return{type:"self-declined",chain:s,moduleId:F};if(c.hot._main)return{type:"unaccepted",chain:s,moduleId:F};for(var I=0;I<c.parents.length;I++){var i=c.parents[I],l=N[i];if(l){if(l.hot._declinedDependencies[F])return{type:"declined",chain:s.concat([i]),moduleId:F,parentId:i};-1===n.indexOf(i)&&(l.hot._acceptedDependencies[F]?(B[i]||(B[i]=[]),G(B[i],[F])):(delete B[i],n.push(i),e.push({chain:s.concat([i]),id:i})))}}}}return{type:"accepted",moduleId:Q,outdatedModules:n,outdatedDependencies:B}}function G(Q,n){for(var B=0;B<n.length;B++){var e=n[B];-1===Q.indexOf(e)&&Q.push(e)}}L();var u={},a=[],y={},x=function(){console.warn("[HMR] unexpected require("+Z.moduleId+") to disposed module")};for(var R in b)if(Object.prototype.hasOwnProperty.call(b,R)){var Z;U=X(R),Z=b[R]?d(U):{type:"disposed",moduleId:R};var r=!1,E=!1,p=!1,W="";switch(Z.chain&&(W="\nUpdate propagation: "+Z.chain.join(" -> ")),Z.type){case"self-declined":e.onDeclined&&e.onDeclined(Z),e.ignoreDeclined||(r=new Error("Aborted because of self decline: "+Z.moduleId+W));break;case"declined":e.onDeclined&&e.onDeclined(Z),e.ignoreDeclined||(r=new Error("Aborted because of declined dependency: "+Z.moduleId+" in "+Z.parentId+W));break;case"unaccepted":e.onUnaccepted&&e.onUnaccepted(Z),e.ignoreUnaccepted||(r=new Error("Aborted because "+U+" is not accepted"+W));break;case"accepted":e.onAccepted&&e.onAccepted(Z),E=!0;break;case"disposed":e.onDisposed&&e.onDisposed(Z),p=!0;break;default:throw new Error("Unexception type "+Z.type)}if(r)return g("abort"),Promise.reject(r);if(E)for(U in y[U]=b[U],G(a,Z.outdatedModules),Z.outdatedDependencies)Object.prototype.hasOwnProperty.call(Z.outdatedDependencies,U)&&(u[U]||(u[U]=[]),G(u[U],Z.outdatedDependencies[U]));p&&(G(a,[Z.moduleId]),y[U]=x)}var A,h=[];for(i=0;i<a.length;i++)U=a[i],N[U]&&N[U].hot._selfAccepted&&y[U]!==x&&!N[U].hot._selfInvalidated&&h.push({module:U,parents:N[U].parents.slice(),errorHandler:N[U].hot._selfAccepted});g("dispose"),Object.keys(V).forEach((function(Q){!1===V[Q]&&function(Q){delete installedChunks[Q]}(Q)}));var D,S,v=a.slice();for(;v.length>0;)if(U=v.pop(),c=N[U]){var H={},Y=c.hot._disposeHandlers;for(l=0;l<Y.length;l++)(I=Y[l])(H);for(F[U]=H,c.hot.active=!1,delete N[U],delete u[U],l=0;l<c.children.length;l++){var T=N[c.children[l]];T&&((A=T.parents.indexOf(U))>=0&&T.parents.splice(A,1))}}for(U in u)if(Object.prototype.hasOwnProperty.call(u,U)&&(c=N[U]))for(S=u[U],l=0;l<S.length;l++)D=S[l],(A=c.children.indexOf(D))>=0&&c.children.splice(A,1);g("apply"),void 0!==o&&(t=o,o=void 0);for(U in b=void 0,y)Object.prototype.hasOwnProperty.call(y,U)&&(Q[U]=y[U]);var z=null;for(U in u)if(Object.prototype.hasOwnProperty.call(u,U)&&(c=N[U])){S=u[U];var J=[];for(i=0;i<S.length;i++)if(D=S[i],I=c.hot._acceptedDependencies[D]){if(-1!==J.indexOf(I))continue;J.push(I)}for(i=0;i<J.length;i++){I=J[i];try{I(S)}catch(Q){e.onErrored&&e.onErrored({type:"accept-errored",moduleId:U,dependencyId:S[i],error:Q}),e.ignoreErrored||z||(z=Q)}}}for(i=0;i<h.length;i++){var f=h[i];U=f.module,s=f.parents,B=U;try{m(U)}catch(Q){if("function"==typeof f.errorHandler)try{f.errorHandler(Q)}catch(n){e.onErrored&&e.onErrored({type:"self-accept-error-handler-errored",moduleId:U,error:n,originalError:Q}),e.ignoreErrored||z||(z=n),z||(z=Q)}else e.onErrored&&e.onErrored({type:"self-accept-errored",moduleId:U,error:Q}),e.ignoreErrored||z||(z=Q)}}if(z)return g("fail"),Promise.reject(z);if(C)return n(e).then((function(Q){return a.forEach((function(n){Q.indexOf(n)<0&&Q.push(n)})),Q}));return g("idle"),new Promise((function(Q){Q(a)}))}(n=n||{})}function L(){if(C)return b||(b={}),C.forEach(E),C=void 0,!0}function E(n){Object.prototype.hasOwnProperty.call(b,n)||(b[n]=Q[n])}var N={};function m(n){if(N[n])return N[n].exports;var B=N[n]={i:n,l:!1,exports:{},hot:l(n),parents:(I=s,s=[],I),children:[]};return Q[n].call(B.exports,B,B.exports,i(n)),B.l=!0,B.exports}return m.m=Q,m.c=N,m.d=function(Q,n,B){m.o(Q,n)||Object.defineProperty(Q,n,{enumerable:!0,get:B})},m.r=function(Q){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(Q,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Q,"__esModule",{value:!0})},m.t=function(Q,n){if(1&n&&(Q=m(Q)),8&n)return Q;if(4&n&&"object"==typeof Q&&Q&&Q.__esModule)return Q;var B=Object.create(null);if(m.r(B),Object.defineProperty(B,"default",{enumerable:!0,value:Q}),2&n&&"string"!=typeof Q)for(var e in Q)m.d(B,e,function(n){return Q[n]}.bind(null,e));return B},m.n=function(Q){var n=Q&&Q.__esModule?function(){return Q.default}:function(){return Q};return m.d(n,"a",n),n},m.o=function(Q,n){return Object.prototype.hasOwnProperty.call(Q,n)},m.p="/static/",m.h=function(){return t},i(0)(m.s=0)}([function(Q,n,B){Q.exports=B(1)},function(module,__webpack_exports__,__webpack_require__){"use strict";eval('// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, "World", function() { return /* reexport */ World_World; });\n__webpack_require__.d(__webpack_exports__, "createEntity", function() { return /* reexport */ createEntity; });\n__webpack_require__.d(__webpack_exports__, "createSystem", function() { return /* reexport */ createSystem; });\n\n// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/rng.js\n// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nfunction rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where "this" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== \'undefined\' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== \'undefined\' && typeof msCrypto.getRandomValues === \'function\' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error(\'crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported\');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}\n// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/regex.js\n/* harmony default export */ var regex = (/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i);\n// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/validate.js\n\n\nfunction validate(uuid) {\n  return typeof uuid === \'string\' && regex.test(uuid);\n}\n\n/* harmony default export */ var esm_browser_validate = (validate);\n// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/stringify.js\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var stringify_i = 0; stringify_i < 256; ++stringify_i) {\n  byteToHex.push((stringify_i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It\'s been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + \'-\' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + \'-\' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + \'-\' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + \'-\' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it\'s likely due to one\n  // of the following:\n  // - One or more input array values don\'t map to a hex octet (leading to\n  // "undefined" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!esm_browser_validate(uuid)) {\n    throw TypeError(\'Stringified UUID is invalid\');\n  }\n\n  return uuid;\n}\n\n/* harmony default export */ var esm_browser_stringify = (stringify);\n// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/v4.js\n\n\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return esm_browser_stringify(rnds);\n}\n\n/* harmony default export */ var esm_browser_v4 = (v4);\n// CONCATENATED MODULE: ./src/guards.ts\n// export function classIsCompType(cl: any)\nfunction isComponentInstance(Class, comp) {\n  if (!comp) {\n    return false;\n  }\n\n  if (!(comp instanceof Class)) {\n    return false;\n  }\n\n  return true;\n}\nfunction isComponentName(possibleName, entitiesByCTypes) {\n  // string\n  if (typeof possibleName !== \'string\') {\n    return false;\n  }\n\n  for (const a of entitiesByCTypes.keys()) {\n    if (a.includes(possibleName)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n// CONCATENATED MODULE: ./src/ComponentCollection.ts\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n// CT is a Union, like `type = typeof FirstComponent | typeof SecondComponent`.\nclass ComponentCollection_ComponentCollection {\n  constructor() {\n    _defineProperty(this, "components", new Map());\n\n    _defineProperty(this, "add", component => {\n      this.components.set(component.constructor.name, component);\n    });\n\n    _defineProperty(this, "update", (cl, func) => {\n      const c = this.components.get(cl.name);\n\n      if (isComponentInstance(cl, c)) {\n        const updatedComponent = func(c);\n        this.components.set(cl.name, updatedComponent);\n      }\n    });\n\n    _defineProperty(this, "remove", cType => {\n      this.components.delete(cType.name);\n    });\n\n    _defineProperty(this, "get", cl => {\n      const comp = this.components.get(cl.name);\n\n      if (isComponentInstance(cl, comp)) {\n        return comp;\n      } else {\n        throw new Error(`ComponentCollection does not have component of type ${cl.name}`);\n      }\n    });\n\n    _defineProperty(this, "has", cType => {\n      return Array.isArray(cType) ? cType.every(ct => this.components.has(ct.name) === true) : this.components.has(cType.name);\n    });\n\n    _defineProperty(this, "hasByName", cName => {\n      return Array.isArray(cName) ? cName.every(ct => this.components.has(ct) === true) : this.components.has(cName);\n    });\n  }\n\n  /**\n   * Get the component type names that are currently being used in the collection.\n   */\n  get componentTypes() {\n    return [...this.components.keys()];\n  }\n  /**\n   * Get the current number of components that are in the collection.\n   */\n\n\n  get size() {\n    return this.components.size;\n  }\n\n  toDevComponents() {\n    const obj = {};\n\n    for (const [compName, comp] of this.components) {\n      obj[compName] = comp;\n    }\n\n    return obj;\n  }\n\n}\n// CONCATENATED MODULE: ./src/DevEntity.ts\nfunction DevEntity_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nclass DevEntity {\n  constructor(entity, world) {\n    DevEntity_defineProperty(this, "id", void 0);\n\n    DevEntity_defineProperty(this, "components", void 0);\n\n    DevEntity_defineProperty(this, "tags", void 0);\n\n    this.id = entity.id;\n    this.components = entity.components.toDevComponents(), this.tags = [...entity.tags]; // get all the systems that would trigger with this entity...\n  }\n\n}\n\n/* harmony default export */ var src_DevEntity = (DevEntity);\n// CONCATENATED MODULE: ./src/Entity.ts\nfunction Entity_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\nclass Entity_Entity {\n  constructor(world) {\n    Entity_defineProperty(this, "_id", void 0);\n\n    Entity_defineProperty(this, "_world", void 0);\n\n    this._id = esm_browser_v4();\n    this._world = world;\n    /*\n    Registering with the World.\n    */\n\n    this._world.registerEntity(this);\n  }\n  /**\n   * Add a component to an Entity, doh.\n   */\n\n\n  add(component) {\n    this._world.set(this._id, component);\n\n    return this;\n  }\n  /**\n   * Add a tag to a component\n   */\n\n\n  addTag(tag) {\n    const entitySet = this._world.entitiesByTags.has(tag) ? this._world.entitiesByTags.get(tag) : new Set();\n\n    if (entitySet) {\n      entitySet.add(this._id);\n\n      this._world.entitiesByTags.set(tag, entitySet);\n    }\n\n    return this;\n  }\n  /**\n   * Determines if an entity has a component related to it.\n   */\n\n\n  has(cType) {\n    const cc = this._world.componentCollections.get(this._id) || new ComponentCollection_ComponentCollection();\n    return cc.has(cType);\n  }\n  /**\n   * Check to see if an entity tagged with a given tag.\n   */\n\n\n  hasTag(tag) {\n    if (this._world.entitiesByTags.has(tag)) {\n      const entitySet = this._world.entitiesByTags.get(tag);\n\n      if (entitySet) {\n        return entitySet.has(this._id);\n      }\n    }\n\n    return false;\n  }\n  /**\n   * Get a component that belongs to an entity.\n   */\n\n\n  get(cl) {\n    const cc = this._world.componentCollections.get(this._id) || new ComponentCollection_ComponentCollection();\n    const component = cc.get(cl);\n    return component;\n  }\n  /**\n   * Get all components that have been added to an entity, via a ComponentCollection\n   */\n\n\n  getAll() {\n    return this._world.componentCollections.get(this._id) || new ComponentCollection_ComponentCollection();\n  }\n  /**\n   * Remove a component from an entity.\n   * @param cType A component class, eg MyComponent\n   */\n\n\n  remove(cType) {\n    this._world.remove(this._id, cType);\n\n    return this;\n  }\n  /**\n   * Remove a tag from an entity\n   */\n\n\n  removeTag(tag) {\n    if (this._world.entitiesByTags.has(tag)) {\n      const entitySet = this._world.entitiesByTags.get(tag);\n\n      if (entitySet) {\n        entitySet.delete(this._id);\n\n        if (entitySet.size === 0) {\n          this._world.entitiesByTags.delete(tag);\n        }\n      }\n    }\n\n    return this;\n  }\n  /** Clears all components from an Entity */\n\n\n  clear() {\n    this._world.clearEntityComponents(this._id);\n\n    return this;\n  }\n  /**\n   * Remove all tags on an entity\n   */\n\n\n  clearTags() {\n    for (const [tag, entitySet] of this._world.entitiesByTags.entries()) {\n      entitySet.delete(this._id);\n\n      if (entitySet.size === 0) {\n        this._world.entitiesByTags.delete(tag);\n      }\n    }\n\n    return this;\n  }\n\n  destroy() {\n    this._world.destroyEntity(this._id);\n  }\n\n  get id() {\n    return this._id;\n  }\n\n  get world() {\n    return this._world;\n  }\n  /**\n   * Get all components that have been added to an entity, via a ComponentCollection.\n   * Does the same thing as entityInstance.getAll().\n   */\n\n\n  get components() {\n    return this._world.componentCollections.get(this._id) || new ComponentCollection_ComponentCollection();\n  }\n  /**\n   * Retrieves all the tags that have been added to this entity.\n   */\n\n\n  get tags() {\n    const tags = new Set();\n\n    for (const [tag, entitySet] of this._world.entitiesByTags.entries()) {\n      if (entitySet.has(this._id)) {\n        tags.add(tag);\n      }\n    }\n\n    return tags;\n  }\n\n  toDevEntity() {\n    return new src_DevEntity(this);\n  }\n\n}\nfunction createEntity(world) {\n  const entity = new Entity_Entity(world);\n  return entity;\n}\n// CONCATENATED MODULE: ./src/System.ts\n\n\n\n/**\n * This is how you create a System.\n * @example\n * ```\n * createSystem(world, [\'ComponentType\'], ({ entity }) => \'Do fun system things here.\')\n * ```\n */\nfunction createSystem(world, cTypes, systemFunc) {\n  const cNames = cTypes.map(ct => ct.name);\n  world.registerSystem(cNames, systemFunc.name);\n  return () => {\n    let index = 0;\n    const size = world.entitiesByCTypes.size; // Used for matching the array of ComponentTypes which is the key\n    // of where the ComponentCollection is, with the array of ComponentTypes\n    // that are passes.\n    // Might be nice in the future to go back to a ref check on cTypes, but\n    // for now this doesn\'t seem to be that much of a perf hit.\n    // for (const ct of world.entitiesByCTypes.keys()) {\n    //   if (cTypes.length === ct.length && cTypes.every(c => ct.includes(c))) {\n    //     for (const eid of world.entitiesByCTypes.get(cTypes)) {\n    //       const args: SystemFuncArgs<CT> = {\n    //         entity: world.entities.get(eid),\n    //         components: world.componentCollections.get(eid),\n    //         world,\n    //         index,\n    //         size,\n    //         isFirst: index === 0,\n    //         isLast: index + 1 === size,\n    //       }\n    //       systemFunc(args);\n    //       index += 1;\n    //     }\n    //   }\n    // }\n\n    const cTypeArrs = world.entitiesByCTypes.get(cNames) || new Set();\n\n    for (const eid of cTypeArrs) {\n      const args = {\n        entity: world.entities.get(eid) || new Entity_Entity(world),\n        components: world.componentCollections.get(eid) || new ComponentCollection_ComponentCollection(),\n        world,\n        index,\n        size,\n        isFirst: index === 0,\n        isLast: index + 1 === size\n      };\n      systemFunc(args);\n      index += 1;\n    }\n  };\n}\n// CONCATENATED MODULE: ./src/DevTools.ts\nfunction DevTools_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nclass DevTools {\n  constructor(world) {\n    DevTools_defineProperty(this, "world", void 0);\n\n    this.world = world;\n  } // log a table of systems, and the components for them.\n\n\n  logSystemCompTable() {\n    const things = [];\n\n    for (const [systemName, compNames] of this.world.compNamesBySystemName) {\n      things.push({\n        systemName,\n        components: compNames.join(\',\')\n      });\n    }\n\n    console.table(things);\n  } // Would be nice to list all the systems that will apply to an entity.\n\n\n  get entities() {\n    return [...this.world.entities.values()].map(e => e.toDevEntity());\n  }\n\n}\n\n/* harmony default export */ var src_DevTools = (DevTools);\n// CONCATENATED MODULE: ./src/World.ts\nfunction World_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\n\nclass World_World {\n  constructor() {\n    World_defineProperty(this, "componentCollections", new Map());\n\n    World_defineProperty(this, "entities", new Map());\n\n    World_defineProperty(this, "entitiesByCTypes", new Map());\n\n    World_defineProperty(this, "entitiesByTags", new Map());\n\n    World_defineProperty(this, "compNamesBySystemName", new Map());\n\n    World_defineProperty(this, "dev", void 0);\n\n    World_defineProperty(this, "find", predicate => {\n      for (const entity of this.entities.values()) {\n        if (predicate(entity)) {\n          return entity;\n        }\n      }\n\n      return null;\n    });\n\n    World_defineProperty(this, "findAll", predicate => {\n      const results = [];\n\n      for (const entity of this.entities.values()) {\n        if (predicate(entity)) {\n          results.push(entity);\n        }\n      }\n\n      return results;\n    });\n\n    World_defineProperty(this, "locate", cl => {\n      for (const entity of this.entities.values()) {\n        // console.log("entity?", entity.components, cl.name);\n        if (entity.components.has(cl)) {\n          return entity;\n        }\n      }\n\n      return null;\n    });\n\n    World_defineProperty(this, "locateAll", cl => {\n      const results = [];\n\n      for (const entity of this.entities.values()) {\n        if (entity.components.has(cl)) {\n          results.push(entity);\n        }\n      }\n\n      return results;\n    });\n\n    World_defineProperty(this, "grab", cl => {\n      // const entity = this.locate((cl as unknown) as CT[keyof CT]);\n      const entity = this.locate(cl);\n\n      if (entity) {\n        const cc = this.componentCollections.get(entity.id) || new ComponentCollection_ComponentCollection();\n        const component = cc.get(cl);\n        return {\n          entity,\n          component\n        };\n      }\n\n      return null;\n    });\n\n    World_defineProperty(this, "grabBy", (cl, predicate) => {\n      const entities = this.locateAll(cl);\n\n      for (const entity of entities) {\n        const cc = this.componentCollections.get(entity.id) || new ComponentCollection_ComponentCollection();\n        const component = cc.get(cl);\n\n        if (predicate(component)) {\n          return {\n            component,\n            entity\n          };\n        }\n      }\n\n      return null;\n    });\n\n    World_defineProperty(this, "grabAll", cl => {\n      const entities = this.locateAll(cl);\n      return entities.map(entity => {\n        return {\n          entity,\n          component: entity.components.get(cl)\n        };\n      });\n    });\n\n    World_defineProperty(this, "get", (eid, cl) => {\n      const cc = this.componentCollections.get(eid) || new ComponentCollection_ComponentCollection();\n      return cc.get(cl);\n    });\n\n    World_defineProperty(this, "getComponent", (cl, defaultValue) => {\n      const result = this.grab(cl);\n\n      if (!result) {\n        return defaultValue ? defaultValue : null;\n      }\n\n      return result.component;\n    });\n\n    World_defineProperty(this, "getTagged", tag => {\n      const tagEntityIds = this.entitiesByTags.get(tag);\n\n      if (tagEntityIds) {\n        const entityId = tagEntityIds.values().next().value;\n        const entity = this.entities.get(entityId);\n\n        if (entity) {\n          return entity;\n        }\n      }\n\n      return null;\n    });\n\n    World_defineProperty(this, "getAllTagged", tag => {\n      let entities = []; // eslint-disable-line\n\n      const tagEntityIds = this.entitiesByTags.get(tag);\n\n      if (tagEntityIds) {\n        for (const entityId of tagEntityIds) {\n          const entity = this.entities.get(entityId);\n\n          if (entity) {\n            entities.push(entity);\n          }\n        }\n      }\n\n      return entities;\n    });\n\n    World_defineProperty(this, "set", (eid, component) => {\n      const cc = this.componentCollections.get(eid) || new ComponentCollection_ComponentCollection();\n      cc.add(component);\n      this.componentCollections.set(eid, cc);\n\n      for (const [ctArr, entitySet] of this.entitiesByCTypes) {\n        if (ctArr.every(cc.hasByName)) {\n          entitySet.add(eid);\n        }\n      }\n\n      return this;\n    });\n\n    World_defineProperty(this, "remove", (eid, cType) => {\n      const cc = this.componentCollections.get(eid) || new ComponentCollection_ComponentCollection(); // remove entity from current entitiesByCTypes\n\n      for (const [ctArr, entitySet] of this.entitiesByCTypes) {\n        if (ctArr.every(cc.hasByName)) {\n          entitySet.delete(eid);\n        }\n      }\n\n      cc.remove(cType); // Move entityId to new CTypes if needed.\n\n      for (const [ctArr, entitySet] of this.entitiesByCTypes) {\n        if (ctArr.every(cc.hasByName)) {\n          entitySet.add(eid);\n        }\n      }\n\n      return this;\n    });\n\n    this.dev = new src_DevTools(this);\n  }\n  /**\n   * "finds" a single entity based on a predicate\n   */\n\n\n  /**\n   * Internal method used in setting up a new system.\n   */\n  registerSystem(cNames, systemName) {\n    this.compNamesBySystemName.set(systemName, [...cNames]);\n    this.entitiesByCTypes.set(cNames, new Set());\n    return this;\n  }\n  /**\n   * an alias for createSystem().\n   */\n\n\n  createSystem(cl, systemFunc) {\n    const system = createSystem(this, cl, systemFunc);\n    return system;\n  }\n\n  registerEntity(entity) {\n    const cc = new ComponentCollection_ComponentCollection();\n    this.componentCollections.set(entity.id, cc);\n    this.entities.set(entity.id, entity);\n    return this;\n  }\n  /**\n   * Remove all components that belong to an entity.\n   */\n\n\n  clearEntityComponents(eid) {\n    this.componentCollections.set(eid, new ComponentCollection_ComponentCollection());\n\n    for (const entitySet of this.entitiesByCTypes.values()) {\n      if (entitySet.has(eid)) {\n        entitySet.delete(eid);\n      }\n    }\n\n    return this;\n  }\n  /**\n   * Create an entity that is in the world.\n   * Basically just new Entity(world), but saves an import of Entity.\n   */\n\n\n  createEntity() {\n    const entity = new Entity_Entity(this);\n    return entity;\n  }\n  /**\n   * Destroys an entity.\n   * Same as entity.destroy().\n   */\n\n\n  destroyEntity(eid) {\n    this.componentCollections.delete(eid);\n    this.entities.delete(eid);\n\n    for (const entitySet of this.entitiesByCTypes.values()) {\n      if (entitySet.has(eid)) {\n        entitySet.delete(eid);\n      }\n    } // remove any tag associations with destroyed entities.\n\n\n    for (const [tag, entitySet] of this.entitiesByTags) {\n      if (entitySet.has(eid)) {\n        entitySet.delete(eid);\n      }\n\n      if (entitySet.size === 0) {\n        this.entitiesByTags.delete(tag);\n      }\n    }\n\n    return this;\n  }\n\n}\n// CONCATENATED MODULE: ./src/index.ts\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9lY3N0YXRpYy8uL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLWJyb3dzZXIvcm5nLmpzP2Q4ZjgiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3JlZ2V4LmpzPzQwZDYiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3ZhbGlkYXRlLmpzPzA2ZTQiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3N0cmluZ2lmeS5qcz81OGNmIiwid2VicGFjazovL2Vjc3RhdGljLy4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci92NC5qcz9lYzI2Iiwid2VicGFjazovL2Vjc3RhdGljLy4vc3JjL2d1YXJkcy50cz8zYjU3Iiwid2VicGFjazovL2Vjc3RhdGljLy4vc3JjL0NvbXBvbmVudENvbGxlY3Rpb24udHM/NTFjNCIsIndlYnBhY2s6Ly9lY3N0YXRpYy8uL3NyYy9EZXZFbnRpdHkudHM/ZDE0MiIsIndlYnBhY2s6Ly9lY3N0YXRpYy8uL3NyYy9FbnRpdHkudHM/YWM2OCIsIndlYnBhY2s6Ly9lY3N0YXRpYy8uL3NyYy9TeXN0ZW0udHM/MzI0OCIsIndlYnBhY2s6Ly9lY3N0YXRpYy8uL3NyYy9EZXZUb29scy50cz9lMDFhIiwid2VicGFjazovL2Vjc3RhdGljLy4vc3JjL1dvcmxkLnRzP2NjMGIiLCJ3ZWJwYWNrOi8vZWNzdGF0aWMvLi9zcmMvaW5kZXgudHM/ZmZiNCJdLCJuYW1lcyI6WyJpc0NvbXBvbmVudEluc3RhbmNlIiwiQ2xhc3MiLCJjb21wIiwiaXNDb21wb25lbnROYW1lIiwicG9zc2libGVOYW1lIiwiZW50aXRpZXNCeUNUeXBlcyIsImEiLCJrZXlzIiwiaW5jbHVkZXMiLCJDb21wb25lbnRDb2xsZWN0aW9uIiwiTWFwIiwiY29tcG9uZW50IiwiY29tcG9uZW50cyIsInNldCIsImNvbnN0cnVjdG9yIiwibmFtZSIsImNsIiwiZnVuYyIsImMiLCJnZXQiLCJ1cGRhdGVkQ29tcG9uZW50IiwiY1R5cGUiLCJkZWxldGUiLCJFcnJvciIsIkFycmF5IiwiaXNBcnJheSIsImV2ZXJ5IiwiY3QiLCJoYXMiLCJjTmFtZSIsImNvbXBvbmVudFR5cGVzIiwic2l6ZSIsInRvRGV2Q29tcG9uZW50cyIsIm9iaiIsImNvbXBOYW1lIiwiRGV2RW50aXR5IiwiZW50aXR5Iiwid29ybGQiLCJpZCIsInRhZ3MiLCJFbnRpdHkiLCJfaWQiLCJ1dWlkdjQiLCJfd29ybGQiLCJyZWdpc3RlckVudGl0eSIsImFkZCIsImFkZFRhZyIsInRhZyIsImVudGl0eVNldCIsImVudGl0aWVzQnlUYWdzIiwiU2V0IiwiY2MiLCJjb21wb25lbnRDb2xsZWN0aW9ucyIsImhhc1RhZyIsImdldEFsbCIsInJlbW92ZSIsInJlbW92ZVRhZyIsImNsZWFyIiwiY2xlYXJFbnRpdHlDb21wb25lbnRzIiwiY2xlYXJUYWdzIiwiZW50cmllcyIsImRlc3Ryb3kiLCJkZXN0cm95RW50aXR5IiwidG9EZXZFbnRpdHkiLCJjcmVhdGVFbnRpdHkiLCJjcmVhdGVTeXN0ZW0iLCJjVHlwZXMiLCJzeXN0ZW1GdW5jIiwiY05hbWVzIiwibWFwIiwicmVnaXN0ZXJTeXN0ZW0iLCJpbmRleCIsImNUeXBlQXJycyIsImVpZCIsImFyZ3MiLCJlbnRpdGllcyIsImlzRmlyc3QiLCJpc0xhc3QiLCJEZXZUb29scyIsImxvZ1N5c3RlbUNvbXBUYWJsZSIsInRoaW5ncyIsInN5c3RlbU5hbWUiLCJjb21wTmFtZXMiLCJjb21wTmFtZXNCeVN5c3RlbU5hbWUiLCJwdXNoIiwiam9pbiIsImNvbnNvbGUiLCJ0YWJsZSIsInZhbHVlcyIsImUiLCJXb3JsZCIsInByZWRpY2F0ZSIsInJlc3VsdHMiLCJsb2NhdGUiLCJsb2NhdGVBbGwiLCJkZWZhdWx0VmFsdWUiLCJyZXN1bHQiLCJncmFiIiwidGFnRW50aXR5SWRzIiwiZW50aXR5SWQiLCJuZXh0IiwidmFsdWUiLCJjdEFyciIsImhhc0J5TmFtZSIsImRldiIsIkRldnRvb2xzIiwic3lzdGVtIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ2U7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsQzs7QUNsQmUsd0RBQWMsRUFBRSxVQUFVLEVBQUUsZUFBZSxFQUFFLGdCQUFnQixFQUFFLFVBQVUsR0FBRyx5Q0FBeUMsRTs7QUNBckc7O0FBRS9CO0FBQ0EscUNBQXFDLEtBQUs7QUFDMUM7O0FBRWUsaUVBQVEsRTs7QUNOYztBQUNyQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSxTQUFTLFdBQUMsS0FBSyxDQUFDLFdBQUMsT0FBTyxHQUFHLFdBQUM7QUFDNUIsa0JBQWtCLFdBQUM7QUFDbkI7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5Z0JBQXlnQjtBQUN6Z0I7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBTyxvQkFBUTtBQUNmO0FBQ0E7O0FBRUE7QUFDQTs7QUFFZSxtRUFBUyxFOztBQzdCRztBQUNZOztBQUV2QztBQUNBO0FBQ0EsK0NBQStDLEdBQUcsSUFBSTs7QUFFdEQ7QUFDQSxrQ0FBa0M7O0FBRWxDO0FBQ0E7O0FBRUEsbUJBQW1CLFFBQVE7QUFDM0I7QUFDQTs7QUFFQTtBQUNBOztBQUVBLFNBQVMscUJBQVM7QUFDbEI7O0FBRWUscURBQUUsRTs7QUNuQmpCO0FBRU8sU0FBU0EsbUJBQVQsQ0FDTEMsS0FESyxFQUVMQyxJQUZLLEVBRytCO0FBQ3BDLE1BQUksQ0FBQ0EsSUFBTCxFQUFXO0FBQ1QsV0FBTyxLQUFQO0FBQ0Q7O0FBRUQsTUFBSSxFQUFFQSxJQUFJLFlBQVlELEtBQWxCLENBQUosRUFBOEI7QUFDNUIsV0FBTyxLQUFQO0FBQ0Q7O0FBRUQsU0FBTyxJQUFQO0FBQ0Q7QUFHTSxTQUFTRSxlQUFULENBQ0xDLFlBREssRUFFTEMsZ0JBRkssRUFHeUI7QUFDOUI7QUFDQSxNQUFJLE9BQU9ELFlBQVAsS0FBd0IsUUFBNUIsRUFBc0M7QUFDcEMsV0FBTyxLQUFQO0FBQ0Q7O0FBRUQsT0FBSyxNQUFNRSxDQUFYLElBQWdCRCxnQkFBZ0IsQ0FBQ0UsSUFBakIsRUFBaEIsRUFBeUM7QUFDdkMsUUFBSUQsQ0FBQyxDQUFDRSxRQUFGLENBQVdKLFlBQVgsQ0FBSixFQUE4QjtBQUM1QixhQUFPLElBQVA7QUFDRDtBQUNGOztBQUVELFNBQU8sS0FBUDtBQUNELEM7Ozs7QUN0Q0Q7QUFJQTtBQUNlLE1BQU1LLHVDQUFOLENBQWlEO0FBQUE7QUFBQSx3Q0FDbEIsSUFBSUMsR0FBSixFQURrQjs7QUFBQSxpQ0FLdkRDLFNBQUQsSUFBdUM7QUFDM0MsV0FBS0MsVUFBTCxDQUFnQkMsR0FBaEIsQ0FBb0JGLFNBQVMsQ0FBQ0csV0FBVixDQUFzQkMsSUFBMUMsRUFBZ0RKLFNBQWhEO0FBQ0QsS0FQNkQ7O0FBQUEsb0NBU3JELENBQ1BLLEVBRE8sRUFFUEMsSUFGTyxLQUdFO0FBQ1QsWUFBTUMsQ0FBQyxHQUFHLEtBQUtOLFVBQUwsQ0FBZ0JPLEdBQWhCLENBQW9CSCxFQUFFLENBQUNELElBQXZCLENBQVY7O0FBRUEsVUFBSWYsbUJBQW1CLENBQUNnQixFQUFELEVBQUtFLENBQUwsQ0FBdkIsRUFBZ0M7QUFDOUIsY0FBTUUsZ0JBQWdCLEdBQUdILElBQUksQ0FBQ0MsQ0FBRCxDQUE3QjtBQUNBLGFBQUtOLFVBQUwsQ0FBZ0JDLEdBQWhCLENBQW9CRyxFQUFFLENBQUNELElBQXZCLEVBQTZCSyxnQkFBN0I7QUFDRDtBQUNGLEtBbkI2RDs7QUFBQSxvQ0F5QnBEQyxLQUFELElBQXFCO0FBQzVCLFdBQUtULFVBQUwsQ0FBZ0JVLE1BQWhCLENBQXVCRCxLQUFLLENBQUNOLElBQTdCO0FBQ0QsS0EzQjZEOztBQUFBLGlDQXFDcERDLEVBQUosSUFBOEM7QUFDbEQsWUFBTWQsSUFBSSxHQUFHLEtBQUtVLFVBQUwsQ0FBZ0JPLEdBQWhCLENBQW9CSCxFQUFFLENBQUNELElBQXZCLENBQWI7O0FBRUEsVUFBSWYsbUJBQW1CLENBQUlnQixFQUFKLEVBQVFkLElBQVIsQ0FBdkIsRUFBc0M7QUFDcEMsZUFBT0EsSUFBUDtBQUNELE9BRkQsTUFFTztBQUNMLGNBQU0sSUFBSXFCLEtBQUosQ0FDSCx1REFBc0RQLEVBQUUsQ0FBQ0QsSUFBSyxFQUQzRCxDQUFOO0FBR0Q7QUFDRixLQS9DNkQ7O0FBQUEsaUNBaUV2RE0sS0FBRCxJQUErQjtBQUNuQyxhQUFPRyxLQUFLLENBQUNDLE9BQU4sQ0FBY0osS0FBZCxJQUNIQSxLQUFLLENBQUNLLEtBQU4sQ0FBYUMsRUFBRCxJQUFRLEtBQUtmLFVBQUwsQ0FBZ0JnQixHQUFoQixDQUFvQkQsRUFBRSxDQUFDWixJQUF2QixNQUFpQyxJQUFyRCxDQURHLEdBRUgsS0FBS0gsVUFBTCxDQUFnQmdCLEdBQWhCLENBQW9CUCxLQUFLLENBQUNOLElBQTFCLENBRko7QUFHRCxLQXJFNkQ7O0FBQUEsdUNBNkVqRGMsS0FBRCxJQUF1QztBQUNqRCxhQUFPTCxLQUFLLENBQUNDLE9BQU4sQ0FBY0ksS0FBZCxJQUNIQSxLQUFLLENBQUNILEtBQU4sQ0FBWUMsRUFBRSxJQUFJLEtBQUtmLFVBQUwsQ0FBZ0JnQixHQUFoQixDQUFvQkQsRUFBcEIsTUFBNEIsSUFBOUMsQ0FERyxHQUVILEtBQUtmLFVBQUwsQ0FBZ0JnQixHQUFoQixDQUFvQkMsS0FBcEIsQ0FGSjtBQUdELEtBakY2RDtBQUFBOztBQW1GOUQ7QUFDRjtBQUNBO0FBQ0UsTUFBSUMsY0FBSixHQUErQjtBQUM3QixXQUFPLENBQUMsR0FBRyxLQUFLbEIsVUFBTCxDQUFnQkwsSUFBaEIsRUFBSixDQUFQO0FBQ0Q7QUFFRDtBQUNGO0FBQ0E7OztBQUNFLE1BQUl3QixJQUFKLEdBQW1CO0FBQ2pCLFdBQU8sS0FBS25CLFVBQUwsQ0FBZ0JtQixJQUF2QjtBQUNEOztBQUVEQyxpQkFBZSxHQUFxQztBQUNsRCxVQUFNQyxHQUFxQyxHQUFHLEVBQTlDOztBQUNBLFNBQUssTUFBTSxDQUFDQyxRQUFELEVBQVdoQyxJQUFYLENBQVgsSUFBK0IsS0FBS1UsVUFBcEMsRUFBZ0Q7QUFDOUNxQixTQUFHLENBQUNDLFFBQUQsQ0FBSCxHQUFnQmhDLElBQWhCO0FBQ0Q7O0FBRUQsV0FBTytCLEdBQVA7QUFDRDs7QUF4RzZELEM7Ozs7QUNEaEUsTUFBTUUsU0FBTixDQUF1QztBQU9yQ3JCLGFBQVcsQ0FBQ3NCLE1BQUQsRUFBcUJDLEtBQXJCLEVBQXVDO0FBQUE7O0FBQUE7O0FBQUE7O0FBQ2hELFNBQUtDLEVBQUwsR0FBVUYsTUFBTSxDQUFDRSxFQUFqQjtBQUNBLFNBQUsxQixVQUFMLEdBQWtCd0IsTUFBTSxDQUFDeEIsVUFBUCxDQUFrQm9CLGVBQWxCLEVBQWxCLEVBQ0EsS0FBS08sSUFBTCxHQUFZLENBQUMsR0FBR0gsTUFBTSxDQUFDRyxJQUFYLENBRFosQ0FGZ0QsQ0FLaEQ7QUFDRDs7QUFib0M7O0FBZ0J4QkosMkRBQWYsRTs7OztBQ3BCQTtBQUVBO0FBR0E7QUFNZSxNQUFNSyxhQUFOLENBQW9DO0FBSWpEMUIsYUFBVyxDQUFDdUIsS0FBRCxFQUFtQjtBQUFBOztBQUFBOztBQUM1QixTQUFLSSxHQUFMLEdBQVdDLGNBQU0sRUFBakI7QUFDQSxTQUFLQyxNQUFMLEdBQWNOLEtBQWQ7QUFFQTtBQUNKO0FBQ0E7O0FBQ0ksU0FBS00sTUFBTCxDQUFZQyxjQUFaLENBQTJCLElBQTNCO0FBQ0Q7QUFFRDtBQUNGO0FBQ0E7OztBQUNFQyxLQUFHLENBQUNsQyxTQUFELEVBQW9DO0FBQ3JDLFNBQUtnQyxNQUFMLENBQVk5QixHQUFaLENBQWdCLEtBQUs0QixHQUFyQixFQUEwQjlCLFNBQTFCOztBQUVBLFdBQU8sSUFBUDtBQUNEO0FBRUQ7QUFDRjtBQUNBOzs7QUFDRW1DLFFBQU0sQ0FBQ0MsR0FBRCxFQUFpQjtBQUNyQixVQUFNQyxTQUFTLEdBQUcsS0FBS0wsTUFBTCxDQUFZTSxjQUFaLENBQTJCckIsR0FBM0IsQ0FBK0JtQixHQUEvQixJQUNkLEtBQUtKLE1BQUwsQ0FBWU0sY0FBWixDQUEyQjlCLEdBQTNCLENBQStCNEIsR0FBL0IsQ0FEYyxHQUVkLElBQUlHLEdBQUosRUFGSjs7QUFJQSxRQUFJRixTQUFKLEVBQWU7QUFDYkEsZUFBUyxDQUFDSCxHQUFWLENBQWMsS0FBS0osR0FBbkI7O0FBQ0EsV0FBS0UsTUFBTCxDQUFZTSxjQUFaLENBQTJCcEMsR0FBM0IsQ0FBK0JrQyxHQUEvQixFQUFvQ0MsU0FBcEM7QUFDRDs7QUFFRCxXQUFPLElBQVA7QUFDRDtBQUVEO0FBQ0Y7QUFDQTs7O0FBQ0VwQixLQUFHLENBQUNQLEtBQUQsRUFBcUI7QUFDdEIsVUFBTThCLEVBQUUsR0FBRyxLQUFLUixNQUFMLENBQVlTLG9CQUFaLENBQWlDakMsR0FBakMsQ0FBcUMsS0FBS3NCLEdBQTFDLEtBQWtELElBQUloQyx1Q0FBSixFQUE3RDtBQUVBLFdBQU8wQyxFQUFFLENBQUN2QixHQUFILENBQU9QLEtBQVAsQ0FBUDtBQUNEO0FBRUQ7QUFDRjtBQUNBOzs7QUFDRWdDLFFBQU0sQ0FBQ04sR0FBRCxFQUFvQjtBQUN4QixRQUFJLEtBQUtKLE1BQUwsQ0FBWU0sY0FBWixDQUEyQnJCLEdBQTNCLENBQStCbUIsR0FBL0IsQ0FBSixFQUF5QztBQUN2QyxZQUFNQyxTQUFTLEdBQUcsS0FBS0wsTUFBTCxDQUFZTSxjQUFaLENBQTJCOUIsR0FBM0IsQ0FBK0I0QixHQUEvQixDQUFsQjs7QUFDQSxVQUFJQyxTQUFKLEVBQWU7QUFDYixlQUFPQSxTQUFTLENBQUNwQixHQUFWLENBQWMsS0FBS2EsR0FBbkIsQ0FBUDtBQUNEO0FBQ0Y7O0FBRUQsV0FBTyxLQUFQO0FBQ0Q7QUFFRDtBQUNGO0FBQ0E7OztBQUNFdEIsS0FBRyxDQUFJSCxFQUFKLEVBQTJDO0FBQzVDLFVBQU1tQyxFQUFFLEdBQUcsS0FBS1IsTUFBTCxDQUFZUyxvQkFBWixDQUFpQ2pDLEdBQWpDLENBQXFDLEtBQUtzQixHQUExQyxLQUFrRCxJQUFJaEMsdUNBQUosRUFBN0Q7QUFFQSxVQUFNRSxTQUFTLEdBQUd3QyxFQUFFLENBQUNoQyxHQUFILENBQVVILEVBQVYsQ0FBbEI7QUFFQSxXQUFPTCxTQUFQO0FBQ0Q7QUFFRDtBQUNGO0FBQ0E7OztBQUNFMkMsUUFBTSxHQUE0QjtBQUNoQyxXQUFPLEtBQUtYLE1BQUwsQ0FBWVMsb0JBQVosQ0FBaUNqQyxHQUFqQyxDQUFxQyxLQUFLc0IsR0FBMUMsS0FBa0QsSUFBSWhDLHVDQUFKLEVBQXpEO0FBQ0Q7QUFFRDtBQUNGO0FBQ0E7QUFDQTs7O0FBQ0U4QyxRQUFNLENBQUNsQyxLQUFELEVBQWtCO0FBQ3RCLFNBQUtzQixNQUFMLENBQVlZLE1BQVosQ0FBbUIsS0FBS2QsR0FBeEIsRUFBNkJwQixLQUE3Qjs7QUFFQSxXQUFPLElBQVA7QUFDRDtBQUVEO0FBQ0Y7QUFDQTs7O0FBQ0VtQyxXQUFTLENBQUNULEdBQUQsRUFBaUI7QUFDeEIsUUFBSSxLQUFLSixNQUFMLENBQVlNLGNBQVosQ0FBMkJyQixHQUEzQixDQUErQm1CLEdBQS9CLENBQUosRUFBeUM7QUFDdkMsWUFBTUMsU0FBUyxHQUFHLEtBQUtMLE1BQUwsQ0FBWU0sY0FBWixDQUEyQjlCLEdBQTNCLENBQStCNEIsR0FBL0IsQ0FBbEI7O0FBRUEsVUFBSUMsU0FBSixFQUFlO0FBQ2JBLGlCQUFTLENBQUMxQixNQUFWLENBQWlCLEtBQUttQixHQUF0Qjs7QUFFQSxZQUFJTyxTQUFTLENBQUNqQixJQUFWLEtBQW1CLENBQXZCLEVBQTBCO0FBQ3hCLGVBQUtZLE1BQUwsQ0FBWU0sY0FBWixDQUEyQjNCLE1BQTNCLENBQWtDeUIsR0FBbEM7QUFDRDtBQUNGO0FBQ0Y7O0FBQ0QsV0FBTyxJQUFQO0FBQ0Q7QUFFRDs7O0FBQ0FVLE9BQUssR0FBUztBQUNaLFNBQUtkLE1BQUwsQ0FBWWUscUJBQVosQ0FBa0MsS0FBS2pCLEdBQXZDOztBQUVBLFdBQU8sSUFBUDtBQUNEO0FBRUQ7QUFDRjtBQUNBOzs7QUFDRWtCLFdBQVMsR0FBUztBQUNoQixTQUFLLE1BQU0sQ0FBQ1osR0FBRCxFQUFNQyxTQUFOLENBQVgsSUFBK0IsS0FBS0wsTUFBTCxDQUFZTSxjQUFaLENBQTJCVyxPQUEzQixFQUEvQixFQUFxRTtBQUNuRVosZUFBUyxDQUFDMUIsTUFBVixDQUFpQixLQUFLbUIsR0FBdEI7O0FBRUEsVUFBSU8sU0FBUyxDQUFDakIsSUFBVixLQUFtQixDQUF2QixFQUEwQjtBQUN4QixhQUFLWSxNQUFMLENBQVlNLGNBQVosQ0FBMkIzQixNQUEzQixDQUFrQ3lCLEdBQWxDO0FBQ0Q7QUFDRjs7QUFFRCxXQUFPLElBQVA7QUFDRDs7QUFFRGMsU0FBTyxHQUFTO0FBQ2QsU0FBS2xCLE1BQUwsQ0FBWW1CLGFBQVosQ0FBMEIsS0FBS3JCLEdBQS9CO0FBQ0Q7O0FBRUQsTUFBSUgsRUFBSixHQUFpQjtBQUNmLFdBQU8sS0FBS0csR0FBWjtBQUNEOztBQUVELE1BQUlKLEtBQUosR0FBdUI7QUFDckIsV0FBTyxLQUFLTSxNQUFaO0FBQ0Q7QUFFRDtBQUNGO0FBQ0E7QUFDQTs7O0FBQ0UsTUFBSS9CLFVBQUosR0FBMEM7QUFDeEMsV0FBTyxLQUFLK0IsTUFBTCxDQUFZUyxvQkFBWixDQUFpQ2pDLEdBQWpDLENBQXFDLEtBQUtzQixHQUExQyxLQUFrRCxJQUFJaEMsdUNBQUosRUFBekQ7QUFDRDtBQUVEO0FBQ0Y7QUFDQTs7O0FBQ0UsTUFBSThCLElBQUosR0FBcUI7QUFDbkIsVUFBTUEsSUFBSSxHQUFHLElBQUlXLEdBQUosRUFBYjs7QUFDQSxTQUFLLE1BQU0sQ0FBQ0gsR0FBRCxFQUFNQyxTQUFOLENBQVgsSUFBK0IsS0FBS0wsTUFBTCxDQUFZTSxjQUFaLENBQTJCVyxPQUEzQixFQUEvQixFQUFxRTtBQUNuRSxVQUFJWixTQUFTLENBQUNwQixHQUFWLENBQWMsS0FBS2EsR0FBbkIsQ0FBSixFQUE2QjtBQUMzQkYsWUFBSSxDQUFDTSxHQUFMLENBQVNFLEdBQVQ7QUFDRDtBQUNGOztBQUVELFdBQU9SLElBQVA7QUFDRDs7QUFFRHdCLGFBQVcsR0FBa0I7QUFDM0IsV0FBTyxJQUFJNUIsYUFBSixDQUFrQixJQUFsQixDQUFQO0FBQ0Q7O0FBdEtnRDtBQXlLNUMsU0FBUzZCLFlBQVQsQ0FDTDNCLEtBREssRUFFTztBQUNaLFFBQU1ELE1BQU0sR0FBRyxJQUFJSSxhQUFKLENBQWVILEtBQWYsQ0FBZjtBQUVBLFNBQU9ELE1BQVA7QUFDRCxDOztBQ3pMRDtBQUNBOztBQStDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPLFNBQVM2QixZQUFULENBQ0w1QixLQURLLEVBRUw2QixNQUZLLEVBR0xDLFVBSEssRUFJRztBQUNSLFFBQU1DLE1BQU0sR0FBR0YsTUFBTSxDQUFDRyxHQUFQLENBQVcxQyxFQUFFLElBQUlBLEVBQUUsQ0FBQ1osSUFBcEIsQ0FBZjtBQUNBc0IsT0FBSyxDQUFDaUMsY0FBTixDQUFxQkYsTUFBckIsRUFBNkJELFVBQVUsQ0FBQ3BELElBQXhDO0FBRUEsU0FBTyxNQUFZO0FBQ2pCLFFBQUl3RCxLQUFLLEdBQUcsQ0FBWjtBQUNBLFVBQU14QyxJQUFJLEdBQUdNLEtBQUssQ0FBQ2hDLGdCQUFOLENBQXVCMEIsSUFBcEMsQ0FGaUIsQ0FJakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsVUFBTXlDLFNBQVMsR0FBR25DLEtBQUssQ0FBQ2hDLGdCQUFOLENBQXVCYyxHQUF2QixDQUEyQmlELE1BQTNCLEtBQXNDLElBQUlsQixHQUFKLEVBQXhEOztBQUVBLFNBQUssTUFBTXVCLEdBQVgsSUFBa0JELFNBQWxCLEVBQTZCO0FBQzNCLFlBQU1FLElBQXdCLEdBQUc7QUFDL0J0QyxjQUFNLEVBQUVDLEtBQUssQ0FBQ3NDLFFBQU4sQ0FBZXhELEdBQWYsQ0FBbUJzRCxHQUFuQixLQUEyQixJQUFJakMsYUFBSixDQUFlSCxLQUFmLENBREo7QUFFL0J6QixrQkFBVSxFQUFFeUIsS0FBSyxDQUFDZSxvQkFBTixDQUEyQmpDLEdBQTNCLENBQStCc0QsR0FBL0IsS0FBdUMsSUFBSWhFLHVDQUFKLEVBRnBCO0FBRy9CNEIsYUFIK0I7QUFJL0JrQyxhQUorQjtBQUsvQnhDLFlBTCtCO0FBTS9CNkMsZUFBTyxFQUFFTCxLQUFLLEtBQUssQ0FOWTtBQU8vQk0sY0FBTSxFQUFFTixLQUFLLEdBQUcsQ0FBUixLQUFjeEM7QUFQUyxPQUFqQztBQVVBb0MsZ0JBQVUsQ0FBQ08sSUFBRCxDQUFWO0FBRUFILFdBQUssSUFBSSxDQUFUO0FBQ0Q7QUFDRixHQTlDRDtBQStDRCxDOzs7O0FDNUdELE1BQU1PLFFBQU4sQ0FBc0M7QUFHcENoRSxhQUFXLENBQUN1QixLQUFELEVBQW1CO0FBQUE7O0FBQzVCLFNBQUtBLEtBQUwsR0FBYUEsS0FBYjtBQUNELEdBTG1DLENBT3BDOzs7QUFDQTBDLG9CQUFrQixHQUFTO0FBQ3pCLFVBQU1DLE1BQU0sR0FBRyxFQUFmOztBQUVBLFNBQUssTUFBTSxDQUFDQyxVQUFELEVBQWFDLFNBQWIsQ0FBWCxJQUFzQyxLQUFLN0MsS0FBTCxDQUFXOEMscUJBQWpELEVBQXdFO0FBQ3RFSCxZQUFNLENBQUNJLElBQVAsQ0FBWTtBQUFFSCxrQkFBRjtBQUFjckUsa0JBQVUsRUFBRXNFLFNBQVMsQ0FBQ0csSUFBVixDQUFlLEdBQWY7QUFBMUIsT0FBWjtBQUNEOztBQUVEQyxXQUFPLENBQUNDLEtBQVIsQ0FBY1AsTUFBZDtBQUNELEdBaEJtQyxDQWtCcEM7OztBQUVBLE1BQUlMLFFBQUosR0FBZ0M7QUFDOUIsV0FBTyxDQUFDLEdBQUcsS0FBS3RDLEtBQUwsQ0FBV3NDLFFBQVgsQ0FBb0JhLE1BQXBCLEVBQUosRUFBa0NuQixHQUFsQyxDQUFzQ29CLENBQUMsSUFBSUEsQ0FBQyxDQUFDMUIsV0FBRixFQUEzQyxDQUFQO0FBQ0Q7O0FBdEJtQzs7QUF5QnZCZSx5REFBZixFOzs7O0FDNUJBO0FBQ0E7QUFFQTtBQUNBO0FBSWUsTUFBTVksV0FBTixDQUFtQztBQWFoRDVFLGFBQVcsR0FBRztBQUFBLHVEQVppRCxJQUFJSixHQUFKLEVBWWpEOztBQUFBLDJDQVZ3QixJQUFJQSxHQUFKLEVBVXhCOztBQUFBLG1EQVJtQyxJQUFJQSxHQUFKLEVBUW5DOztBQUFBLGlEQU40QixJQUFJQSxHQUFKLEVBTTVCOztBQUFBLHdEQUppQyxJQUFJQSxHQUFKLEVBSWpDOztBQUFBOztBQUFBLHVDQU9OaUYsU0FBRCxJQUFtRTtBQUN4RSxXQUFLLE1BQU12RCxNQUFYLElBQXFCLEtBQUt1QyxRQUFMLENBQWNhLE1BQWQsRUFBckIsRUFBNkM7QUFDM0MsWUFBSUcsU0FBUyxDQUFDdkQsTUFBRCxDQUFiLEVBQXVCO0FBQ3JCLGlCQUFPQSxNQUFQO0FBQ0Q7QUFDRjs7QUFFRCxhQUFPLElBQVA7QUFDRCxLQWZhOztBQUFBLDBDQW9CSHVELFNBQUQsSUFBOEQ7QUFDdEUsWUFBTUMsT0FBcUIsR0FBRyxFQUE5Qjs7QUFFQSxXQUFLLE1BQU14RCxNQUFYLElBQXFCLEtBQUt1QyxRQUFMLENBQWNhLE1BQWQsRUFBckIsRUFBNkM7QUFDM0MsWUFBSUcsU0FBUyxDQUFDdkQsTUFBRCxDQUFiLEVBQXVCO0FBQ3JCd0QsaUJBQU8sQ0FBQ1IsSUFBUixDQUFhaEQsTUFBYjtBQUNEO0FBQ0Y7O0FBRUQsYUFBT3dELE9BQVA7QUFDRCxLQTlCYTs7QUFBQSx5Q0FtQ0o1RSxFQUFELElBQXNDO0FBQzdDLFdBQUssTUFBTW9CLE1BQVgsSUFBcUIsS0FBS3VDLFFBQUwsQ0FBY2EsTUFBZCxFQUFyQixFQUE2QztBQUMzQztBQUNBLFlBQUlwRCxNQUFNLENBQUN4QixVQUFQLENBQWtCZ0IsR0FBbEIsQ0FBc0JaLEVBQXRCLENBQUosRUFBK0I7QUFDN0IsaUJBQU9vQixNQUFQO0FBQ0Q7QUFDRjs7QUFFRCxhQUFPLElBQVA7QUFDRCxLQTVDYTs7QUFBQSw0Q0FpRERwQixFQUFELElBQWlDO0FBQzNDLFlBQU00RSxPQUFxQixHQUFHLEVBQTlCOztBQUVBLFdBQUssTUFBTXhELE1BQVgsSUFBcUIsS0FBS3VDLFFBQUwsQ0FBY2EsTUFBZCxFQUFyQixFQUE2QztBQUMzQyxZQUFJcEQsTUFBTSxDQUFDeEIsVUFBUCxDQUFrQmdCLEdBQWxCLENBQXNCWixFQUF0QixDQUFKLEVBQStCO0FBQzdCNEUsaUJBQU8sQ0FBQ1IsSUFBUixDQUFhaEQsTUFBYjtBQUNEO0FBQ0Y7O0FBRUQsYUFBT3dELE9BQVA7QUFDRCxLQTNEYTs7QUFBQSx1Q0FxRVo1RSxFQURLLElBRWlFO0FBQ3RFO0FBQ0EsWUFBTW9CLE1BQU0sR0FBRyxLQUFLeUQsTUFBTCxDQUFhN0UsRUFBYixDQUFmOztBQUVBLFVBQUlvQixNQUFKLEVBQVk7QUFDVixjQUFNZSxFQUFFLEdBQ04sS0FBS0Msb0JBQUwsQ0FBMEJqQyxHQUExQixDQUE4QmlCLE1BQU0sQ0FBQ0UsRUFBckMsS0FDQSxJQUFJN0IsdUNBQUosRUFGRjtBQUlBLGNBQU1FLFNBQVMsR0FBR3dDLEVBQUUsQ0FBQ2hDLEdBQUgsQ0FBVUgsRUFBVixDQUFsQjtBQUVBLGVBQU87QUFDTG9CLGdCQURLO0FBRUx6QjtBQUZLLFNBQVA7QUFJRDs7QUFFRCxhQUFPLElBQVA7QUFDRCxLQXhGYTs7QUFBQSx5Q0FrR0wsQ0FDUEssRUFETyxFQUVQMkUsU0FGTyxLQUcrRDtBQUN0RSxZQUFNaEIsUUFBUSxHQUFHLEtBQUttQixTQUFMLENBQWdCOUUsRUFBaEIsQ0FBakI7O0FBRUEsV0FBSyxNQUFNb0IsTUFBWCxJQUFxQnVDLFFBQXJCLEVBQStCO0FBQzdCLGNBQU14QixFQUFFLEdBQ04sS0FBS0Msb0JBQUwsQ0FBMEJqQyxHQUExQixDQUE4QmlCLE1BQU0sQ0FBQ0UsRUFBckMsS0FDQSxJQUFJN0IsdUNBQUosRUFGRjtBQUlBLGNBQU1FLFNBQVMsR0FBR3dDLEVBQUUsQ0FBQ2hDLEdBQUgsQ0FBVUgsRUFBVixDQUFsQjs7QUFFQSxZQUFJMkUsU0FBUyxDQUFDaEYsU0FBRCxDQUFiLEVBQTBCO0FBQ3hCLGlCQUFPO0FBQ0xBLHFCQURLO0FBRUx5QjtBQUZLLFdBQVA7QUFJRDtBQUNGOztBQUVELGFBQU8sSUFBUDtBQUNELEtBeEhhOztBQUFBLDBDQThIWnBCLEVBRFEsSUFFeUQ7QUFDakUsWUFBTTJELFFBQVEsR0FBRyxLQUFLbUIsU0FBTCxDQUFnQjlFLEVBQWhCLENBQWpCO0FBRUEsYUFBTzJELFFBQVEsQ0FBQ04sR0FBVCxDQUFjakMsTUFBRCxJQUFZO0FBQzlCLGVBQU87QUFDTEEsZ0JBREs7QUFFTHpCLG1CQUFTLEVBQUV5QixNQUFNLENBQUN4QixVQUFQLENBQWtCTyxHQUFsQixDQUF5QkgsRUFBekI7QUFGTixTQUFQO0FBSUQsT0FMTSxDQUFQO0FBTUQsS0F4SWE7O0FBQUEsc0NBNklSLENBQUl5RCxHQUFKLEVBQW1CekQsRUFBbkIsS0FBNkQ7QUFDakUsWUFBTW1DLEVBQUUsR0FDTixLQUFLQyxvQkFBTCxDQUEwQmpDLEdBQTFCLENBQThCc0QsR0FBOUIsS0FBc0MsSUFBSWhFLHVDQUFKLEVBRHhDO0FBR0EsYUFBTzBDLEVBQUUsQ0FBQ2hDLEdBQUgsQ0FBVUgsRUFBVixDQUFQO0FBQ0QsS0FsSmE7O0FBQUEsK0NBMEpDLENBQ2JBLEVBRGEsRUFFYitFLFlBRmEsS0FHc0I7QUFDbkMsWUFBTUMsTUFBTSxHQUFHLEtBQUtDLElBQUwsQ0FBVWpGLEVBQVYsQ0FBZjs7QUFFQSxVQUFJLENBQUNnRixNQUFMLEVBQWE7QUFDWCxlQUFPRCxZQUFZLEdBQUdBLFlBQUgsR0FBa0IsSUFBckM7QUFDRDs7QUFFRCxhQUFPQyxNQUFNLENBQUNyRixTQUFkO0FBQ0QsS0FyS2E7O0FBQUEsNENBMEtEb0MsR0FBRCxJQUFpQztBQUMzQyxZQUFNbUQsWUFBWSxHQUFHLEtBQUtqRCxjQUFMLENBQW9COUIsR0FBcEIsQ0FBd0I0QixHQUF4QixDQUFyQjs7QUFFQSxVQUFJbUQsWUFBSixFQUFrQjtBQUNoQixjQUFNQyxRQUFRLEdBQUdELFlBQVksQ0FBQ1YsTUFBYixHQUFzQlksSUFBdEIsR0FBNkJDLEtBQTlDO0FBRUEsY0FBTWpFLE1BQU0sR0FBRyxLQUFLdUMsUUFBTCxDQUFjeEQsR0FBZCxDQUFrQmdGLFFBQWxCLENBQWY7O0FBRUEsWUFBSS9ELE1BQUosRUFBWTtBQUNWLGlCQUFPQSxNQUFQO0FBQ0Q7QUFDRjs7QUFFRCxhQUFPLElBQVA7QUFDRCxLQXhMYTs7QUFBQSwrQ0E4TEVXLEdBQUQsSUFBNEI7QUFDekMsVUFBSTRCLFFBQXNCLEdBQUcsRUFBN0IsQ0FEeUMsQ0FDUjs7QUFFakMsWUFBTXVCLFlBQVksR0FBRyxLQUFLakQsY0FBTCxDQUFvQjlCLEdBQXBCLENBQXdCNEIsR0FBeEIsQ0FBckI7O0FBRUEsVUFBSW1ELFlBQUosRUFBa0I7QUFDaEIsYUFBSyxNQUFNQyxRQUFYLElBQXVCRCxZQUF2QixFQUFxQztBQUNuQyxnQkFBTTlELE1BQU0sR0FBRyxLQUFLdUMsUUFBTCxDQUFjeEQsR0FBZCxDQUFrQmdGLFFBQWxCLENBQWY7O0FBQ0EsY0FBSS9ELE1BQUosRUFBWTtBQUNWdUMsb0JBQVEsQ0FBQ1MsSUFBVCxDQUFjaEQsTUFBZDtBQUNEO0FBQ0Y7QUFDRjs7QUFFRCxhQUFPdUMsUUFBUDtBQUNELEtBN01hOztBQUFBLHNDQWtOUixDQUFDRixHQUFELEVBQWdCOUQsU0FBaEIsS0FBc0Q7QUFDMUQsWUFBTXdDLEVBQUUsR0FDTixLQUFLQyxvQkFBTCxDQUEwQmpDLEdBQTFCLENBQThCc0QsR0FBOUIsS0FBc0MsSUFBSWhFLHVDQUFKLEVBRHhDO0FBR0EwQyxRQUFFLENBQUNOLEdBQUgsQ0FBT2xDLFNBQVA7QUFFQSxXQUFLeUMsb0JBQUwsQ0FBMEJ2QyxHQUExQixDQUE4QjRELEdBQTlCLEVBQW1DdEIsRUFBbkM7O0FBRUEsV0FBSyxNQUFNLENBQUNtRCxLQUFELEVBQVF0RCxTQUFSLENBQVgsSUFBaUMsS0FBSzNDLGdCQUF0QyxFQUF3RDtBQUN0RCxZQUFLaUcsS0FBRCxDQUFvQjVFLEtBQXBCLENBQTBCeUIsRUFBRSxDQUFDb0QsU0FBN0IsQ0FBSixFQUE2QztBQUMzQ3ZELG1CQUFTLENBQUNILEdBQVYsQ0FBYzRCLEdBQWQ7QUFDRDtBQUNGOztBQUVELGFBQU8sSUFBUDtBQUNELEtBak9hOztBQUFBLHlDQXVPTCxDQUFDQSxHQUFELEVBQWdCcEQsS0FBaEIsS0FBb0M7QUFDM0MsWUFBTThCLEVBQUUsR0FDTixLQUFLQyxvQkFBTCxDQUEwQmpDLEdBQTFCLENBQThCc0QsR0FBOUIsS0FBc0MsSUFBSWhFLHVDQUFKLEVBRHhDLENBRDJDLENBSTNDOztBQUNBLFdBQUssTUFBTSxDQUFDNkYsS0FBRCxFQUFRdEQsU0FBUixDQUFYLElBQWlDLEtBQUszQyxnQkFBdEMsRUFBd0Q7QUFDdEQsWUFBS2lHLEtBQUQsQ0FBb0I1RSxLQUFwQixDQUEwQnlCLEVBQUUsQ0FBQ29ELFNBQTdCLENBQUosRUFBNkM7QUFDM0N2RCxtQkFBUyxDQUFDMUIsTUFBVixDQUFpQm1ELEdBQWpCO0FBQ0Q7QUFDRjs7QUFFRHRCLFFBQUUsQ0FBQ0ksTUFBSCxDQUFVbEMsS0FBVixFQVgyQyxDQWEzQzs7QUFDQSxXQUFLLE1BQU0sQ0FBQ2lGLEtBQUQsRUFBUXRELFNBQVIsQ0FBWCxJQUFpQyxLQUFLM0MsZ0JBQXRDLEVBQXdEO0FBQ3RELFlBQUtpRyxLQUFELENBQW9CNUUsS0FBcEIsQ0FBMEJ5QixFQUFFLENBQUNvRCxTQUE3QixDQUFKLEVBQTZDO0FBQzNDdkQsbUJBQVMsQ0FBQ0gsR0FBVixDQUFjNEIsR0FBZDtBQUNEO0FBQ0Y7O0FBRUQsYUFBTyxJQUFQO0FBQ0QsS0E1UGE7O0FBQ1osU0FBSytCLEdBQUwsR0FBVyxJQUFJQyxZQUFKLENBQWEsSUFBYixDQUFYO0FBQ0Q7QUFFRDtBQUNGO0FBQ0E7OztBQXdQRTtBQUNGO0FBQ0E7QUFDRW5DLGdCQUFjLENBQUNGLE1BQUQsRUFBbUJhLFVBQW5CLEVBQTZDO0FBQ3pELFNBQUtFLHFCQUFMLENBQTJCdEUsR0FBM0IsQ0FBK0JvRSxVQUEvQixFQUEyQyxDQUFDLEdBQUdiLE1BQUosQ0FBM0M7QUFDQSxTQUFLL0QsZ0JBQUwsQ0FBc0JRLEdBQXRCLENBQTBCdUQsTUFBMUIsRUFBa0MsSUFBSWxCLEdBQUosRUFBbEM7QUFFQSxXQUFPLElBQVA7QUFDRDtBQUVEO0FBQ0Y7QUFDQTs7O0FBQ0VlLGNBQVksQ0FBQ2pELEVBQUQsRUFBV21ELFVBQVgsRUFBK0M7QUFDekQsVUFBTXVDLE1BQU0sR0FBR3pDLFlBQVksQ0FBSyxJQUFMLEVBQVdqRCxFQUFYLEVBQWVtRCxVQUFmLENBQTNCO0FBRUEsV0FBT3VDLE1BQVA7QUFDRDs7QUFFRDlELGdCQUFjLENBQUNSLE1BQUQsRUFBZ0M7QUFDNUMsVUFBTWUsRUFBRSxHQUFHLElBQUkxQyx1Q0FBSixFQUFYO0FBRUEsU0FBSzJDLG9CQUFMLENBQTBCdkMsR0FBMUIsQ0FBOEJ1QixNQUFNLENBQUNFLEVBQXJDLEVBQXlDYSxFQUF6QztBQUNBLFNBQUt3QixRQUFMLENBQWM5RCxHQUFkLENBQWtCdUIsTUFBTSxDQUFDRSxFQUF6QixFQUE2QkYsTUFBN0I7QUFFQSxXQUFPLElBQVA7QUFDRDtBQUVEO0FBQ0Y7QUFDQTs7O0FBQ0VzQix1QkFBcUIsQ0FBQ2UsR0FBRCxFQUFzQjtBQUN6QyxTQUFLckIsb0JBQUwsQ0FBMEJ2QyxHQUExQixDQUE4QjRELEdBQTlCLEVBQW1DLElBQUloRSx1Q0FBSixFQUFuQzs7QUFFQSxTQUFLLE1BQU11QyxTQUFYLElBQXdCLEtBQUszQyxnQkFBTCxDQUFzQm1GLE1BQXRCLEVBQXhCLEVBQXdEO0FBQ3RELFVBQUl4QyxTQUFTLENBQUNwQixHQUFWLENBQWM2QyxHQUFkLENBQUosRUFBd0I7QUFDdEJ6QixpQkFBUyxDQUFDMUIsTUFBVixDQUFpQm1ELEdBQWpCO0FBQ0Q7QUFDRjs7QUFFRCxXQUFPLElBQVA7QUFDRDtBQUVEO0FBQ0Y7QUFDQTtBQUNBOzs7QUFDRVQsY0FBWSxHQUFlO0FBQ3pCLFVBQU01QixNQUFNLEdBQUcsSUFBSUksYUFBSixDQUFXLElBQVgsQ0FBZjtBQUVBLFdBQU9KLE1BQVA7QUFDRDtBQUVEO0FBQ0Y7QUFDQTtBQUNBOzs7QUFDRTBCLGVBQWEsQ0FBQ1csR0FBRCxFQUEyQjtBQUN0QyxTQUFLckIsb0JBQUwsQ0FBMEI5QixNQUExQixDQUFpQ21ELEdBQWpDO0FBQ0EsU0FBS0UsUUFBTCxDQUFjckQsTUFBZCxDQUFxQm1ELEdBQXJCOztBQUVBLFNBQUssTUFBTXpCLFNBQVgsSUFBd0IsS0FBSzNDLGdCQUFMLENBQXNCbUYsTUFBdEIsRUFBeEIsRUFBd0Q7QUFDdEQsVUFBSXhDLFNBQVMsQ0FBQ3BCLEdBQVYsQ0FBYzZDLEdBQWQsQ0FBSixFQUF3QjtBQUN0QnpCLGlCQUFTLENBQUMxQixNQUFWLENBQWlCbUQsR0FBakI7QUFDRDtBQUNGLEtBUnFDLENBVXRDOzs7QUFDQSxTQUFLLE1BQU0sQ0FBQzFCLEdBQUQsRUFBTUMsU0FBTixDQUFYLElBQStCLEtBQUtDLGNBQXBDLEVBQW9EO0FBQ2xELFVBQUlELFNBQVMsQ0FBQ3BCLEdBQVYsQ0FBYzZDLEdBQWQsQ0FBSixFQUF3QjtBQUN0QnpCLGlCQUFTLENBQUMxQixNQUFWLENBQWlCbUQsR0FBakI7QUFDRDs7QUFFRCxVQUFJekIsU0FBUyxDQUFDakIsSUFBVixLQUFtQixDQUF2QixFQUEwQjtBQUN4QixhQUFLa0IsY0FBTCxDQUFvQjNCLE1BQXBCLENBQTJCeUIsR0FBM0I7QUFDRDtBQUNGOztBQUVELFdBQU8sSUFBUDtBQUNEOztBQTFWK0MsQzs7QUNSbEQ7QUFDQTtBQUNBIiwiZmlsZSI6IjEuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBVbmlxdWUgSUQgY3JlYXRpb24gcmVxdWlyZXMgYSBoaWdoIHF1YWxpdHkgcmFuZG9tICMgZ2VuZXJhdG9yLiBJbiB0aGUgYnJvd3NlciB3ZSB0aGVyZWZvcmVcbi8vIHJlcXVpcmUgdGhlIGNyeXB0byBBUEkgYW5kIGRvIG5vdCBzdXBwb3J0IGJ1aWx0LWluIGZhbGxiYWNrIHRvIGxvd2VyIHF1YWxpdHkgcmFuZG9tIG51bWJlclxuLy8gZ2VuZXJhdG9ycyAobGlrZSBNYXRoLnJhbmRvbSgpKS5cbnZhciBnZXRSYW5kb21WYWx1ZXM7XG52YXIgcm5kczggPSBuZXcgVWludDhBcnJheSgxNik7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBybmcoKSB7XG4gIC8vIGxhenkgbG9hZCBzbyB0aGF0IGVudmlyb25tZW50cyB0aGF0IG5lZWQgdG8gcG9seWZpbGwgaGF2ZSBhIGNoYW5jZSB0byBkbyBzb1xuICBpZiAoIWdldFJhbmRvbVZhbHVlcykge1xuICAgIC8vIGdldFJhbmRvbVZhbHVlcyBuZWVkcyB0byBiZSBpbnZva2VkIGluIGEgY29udGV4dCB3aGVyZSBcInRoaXNcIiBpcyBhIENyeXB0byBpbXBsZW1lbnRhdGlvbi4gQWxzbyxcbiAgICAvLyBmaW5kIHRoZSBjb21wbGV0ZSBpbXBsZW1lbnRhdGlvbiBvZiBjcnlwdG8gKG1zQ3J5cHRvKSBvbiBJRTExLlxuICAgIGdldFJhbmRvbVZhbHVlcyA9IHR5cGVvZiBjcnlwdG8gIT09ICd1bmRlZmluZWQnICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKGNyeXB0bykgfHwgdHlwZW9mIG1zQ3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgbXNDcnlwdG8uZ2V0UmFuZG9tVmFsdWVzID09PSAnZnVuY3Rpb24nICYmIG1zQ3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKG1zQ3J5cHRvKTtcblxuICAgIGlmICghZ2V0UmFuZG9tVmFsdWVzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NyeXB0by5nZXRSYW5kb21WYWx1ZXMoKSBub3Qgc3VwcG9ydGVkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkI2dldHJhbmRvbXZhbHVlcy1ub3Qtc3VwcG9ydGVkJyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGdldFJhbmRvbVZhbHVlcyhybmRzOCk7XG59IiwiZXhwb3J0IGRlZmF1bHQgL14oPzpbMC05YS1mXXs4fS1bMC05YS1mXXs0fS1bMS01XVswLTlhLWZdezN9LVs4OWFiXVswLTlhLWZdezN9LVswLTlhLWZdezEyfXwwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDApJC9pOyIsImltcG9ydCBSRUdFWCBmcm9tICcuL3JlZ2V4LmpzJztcblxuZnVuY3Rpb24gdmFsaWRhdGUodXVpZCkge1xuICByZXR1cm4gdHlwZW9mIHV1aWQgPT09ICdzdHJpbmcnICYmIFJFR0VYLnRlc3QodXVpZCk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHZhbGlkYXRlOyIsImltcG9ydCB2YWxpZGF0ZSBmcm9tICcuL3ZhbGlkYXRlLmpzJztcbi8qKlxuICogQ29udmVydCBhcnJheSBvZiAxNiBieXRlIHZhbHVlcyB0byBVVUlEIHN0cmluZyBmb3JtYXQgb2YgdGhlIGZvcm06XG4gKiBYWFhYWFhYWC1YWFhYLVhYWFgtWFhYWC1YWFhYWFhYWFhYWFhcbiAqL1xuXG52YXIgYnl0ZVRvSGV4ID0gW107XG5cbmZvciAodmFyIGkgPSAwOyBpIDwgMjU2OyArK2kpIHtcbiAgYnl0ZVRvSGV4LnB1c2goKGkgKyAweDEwMCkudG9TdHJpbmcoMTYpLnN1YnN0cigxKSk7XG59XG5cbmZ1bmN0aW9uIHN0cmluZ2lmeShhcnIpIHtcbiAgdmFyIG9mZnNldCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogMDtcbiAgLy8gTm90ZTogQmUgY2FyZWZ1bCBlZGl0aW5nIHRoaXMgY29kZSEgIEl0J3MgYmVlbiB0dW5lZCBmb3IgcGVyZm9ybWFuY2VcbiAgLy8gYW5kIHdvcmtzIGluIHdheXMgeW91IG1heSBub3QgZXhwZWN0LiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkL3B1bGwvNDM0XG4gIHZhciB1dWlkID0gKGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgM11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA0XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDVdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA3XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDhdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOV1dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxM11dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNV1dKS50b0xvd2VyQ2FzZSgpOyAvLyBDb25zaXN0ZW5jeSBjaGVjayBmb3IgdmFsaWQgVVVJRC4gIElmIHRoaXMgdGhyb3dzLCBpdCdzIGxpa2VseSBkdWUgdG8gb25lXG4gIC8vIG9mIHRoZSBmb2xsb3dpbmc6XG4gIC8vIC0gT25lIG9yIG1vcmUgaW5wdXQgYXJyYXkgdmFsdWVzIGRvbid0IG1hcCB0byBhIGhleCBvY3RldCAobGVhZGluZyB0b1xuICAvLyBcInVuZGVmaW5lZFwiIGluIHRoZSB1dWlkKVxuICAvLyAtIEludmFsaWQgaW5wdXQgdmFsdWVzIGZvciB0aGUgUkZDIGB2ZXJzaW9uYCBvciBgdmFyaWFudGAgZmllbGRzXG5cbiAgaWYgKCF2YWxpZGF0ZSh1dWlkKSkge1xuICAgIHRocm93IFR5cGVFcnJvcignU3RyaW5naWZpZWQgVVVJRCBpcyBpbnZhbGlkJyk7XG4gIH1cblxuICByZXR1cm4gdXVpZDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgc3RyaW5naWZ5OyIsImltcG9ydCBybmcgZnJvbSAnLi9ybmcuanMnO1xuaW1wb3J0IHN0cmluZ2lmeSBmcm9tICcuL3N0cmluZ2lmeS5qcyc7XG5cbmZ1bmN0aW9uIHY0KG9wdGlvbnMsIGJ1Ziwgb2Zmc2V0KSB7XG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICB2YXIgcm5kcyA9IG9wdGlvbnMucmFuZG9tIHx8IChvcHRpb25zLnJuZyB8fCBybmcpKCk7IC8vIFBlciA0LjQsIHNldCBiaXRzIGZvciB2ZXJzaW9uIGFuZCBgY2xvY2tfc2VxX2hpX2FuZF9yZXNlcnZlZGBcblxuICBybmRzWzZdID0gcm5kc1s2XSAmIDB4MGYgfCAweDQwO1xuICBybmRzWzhdID0gcm5kc1s4XSAmIDB4M2YgfCAweDgwOyAvLyBDb3B5IGJ5dGVzIHRvIGJ1ZmZlciwgaWYgcHJvdmlkZWRcblxuICBpZiAoYnVmKSB7XG4gICAgb2Zmc2V0ID0gb2Zmc2V0IHx8IDA7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDE2OyArK2kpIHtcbiAgICAgIGJ1ZltvZmZzZXQgKyBpXSA9IHJuZHNbaV07XG4gICAgfVxuXG4gICAgcmV0dXJuIGJ1ZjtcbiAgfVxuXG4gIHJldHVybiBzdHJpbmdpZnkocm5kcyk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHY0OyIsImltcG9ydCBFbnRpdHksIHsgRW50aXR5SWQgfSBmcm9tIFwiLi9FbnRpdHlcIjtcbmltcG9ydCB7IENvbXBUeXBlcyB9IGZyb20gJ2ludGVyZmFjZXMnO1xuaW1wb3J0IENvbXBvbmVudENvbGxlY3Rpb24gZnJvbSAnLi9Db21wb25lbnRDb2xsZWN0aW9uJztcblxuLy8gZXhwb3J0IGZ1bmN0aW9uIGNsYXNzSXNDb21wVHlwZShjbDogYW55KVxuXG5leHBvcnQgZnVuY3Rpb24gaXNDb21wb25lbnRJbnN0YW5jZTxUPihcbiAgQ2xhc3M6IG5ldyAoLi4uYXJnczogYW55KSA9PiBULFxuICBjb21wOiBhbnlcbik6IGNvbXAgaXMgSW5zdGFuY2VUeXBlPHR5cGVvZiBDbGFzcz4ge1xuICBpZiAoIWNvbXApIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBpZiAoIShjb21wIGluc3RhbmNlb2YgQ2xhc3MpKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGlzQ29tcG9uZW50TmFtZTxDVCBleHRlbmRzIENvbXBUeXBlczxDVD4+KFxuICBwb3NzaWJsZU5hbWU6IGFueSxcbiAgZW50aXRpZXNCeUNUeXBlczogTWFwPChrZXlvZiBDVClbXSwgU2V0PEVudGl0eUlkPj5cbik6IHBvc3NpYmxlTmFtZSBpcyBDVFtrZXlvZiBDVF0ge1xuICAvLyBzdHJpbmdcbiAgaWYgKHR5cGVvZiBwb3NzaWJsZU5hbWUgIT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgZm9yIChjb25zdCBhIG9mIGVudGl0aWVzQnlDVHlwZXMua2V5cygpKSB7XG4gICAgaWYgKGEuaW5jbHVkZXMocG9zc2libGVOYW1lKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuIiwiaW1wb3J0IHsgaXNDb21wb25lbnRJbnN0YW5jZSB9IGZyb20gXCIuL2d1YXJkc1wiO1xuXG50eXBlIENsYXNzPFQ+ID0geyBuZXcgKC4uLmFyZ3M6IGFueVtdKTogVCB9O1xuXG4vLyBDVCBpcyBhIFVuaW9uLCBsaWtlIGB0eXBlID0gdHlwZW9mIEZpcnN0Q29tcG9uZW50IHwgdHlwZW9mIFNlY29uZENvbXBvbmVudGAuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21wb25lbnRDb2xsZWN0aW9uPENUIGV4dGVuZHMgQ2xhc3M8YW55Pj4ge1xuICBjb21wb25lbnRzOiBNYXA8c3RyaW5nLCBJbnN0YW5jZVR5cGU8Q1Q+PiA9IG5ldyBNYXAoKTtcblxuICAvLyBpbnN0YW5jZSBvZiBhIGNvbXBvbmVudFxuICAvLyBhZGQgPSAoY29tcG9uZW50OiBJbnN0YW5jZVR5cGU8Q1Rba2V5b2YgQ1RdPik6IHZvaWQgPT4ge1xuICBhZGQgPSAoY29tcG9uZW50OiBJbnN0YW5jZVR5cGU8Q1Q+KTogdm9pZCA9PiB7XG4gICAgdGhpcy5jb21wb25lbnRzLnNldChjb21wb25lbnQuY29uc3RydWN0b3IubmFtZSwgY29tcG9uZW50KTtcbiAgfTtcblxuICB1cGRhdGUgPSA8VD4oXG4gICAgY2w6IENsYXNzPFQ+LFxuICAgIGZ1bmM6IChjOiBJbnN0YW5jZVR5cGU8dHlwZW9mIGNsPikgPT4gSW5zdGFuY2VUeXBlPHR5cGVvZiBjbD5cbiAgKTogdm9pZCA9PiB7XG4gICAgY29uc3QgYyA9IHRoaXMuY29tcG9uZW50cy5nZXQoY2wubmFtZSk7XG5cbiAgICBpZiAoaXNDb21wb25lbnRJbnN0YW5jZShjbCwgYykpIHtcbiAgICAgIGNvbnN0IHVwZGF0ZWRDb21wb25lbnQgPSBmdW5jKGMpO1xuICAgICAgdGhpcy5jb21wb25lbnRzLnNldChjbC5uYW1lLCB1cGRhdGVkQ29tcG9uZW50IGFzIEluc3RhbmNlVHlwZTxDVD4pO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlIGEgY29tcG9uZW50LlxuICAgKiBAcGFyYW0gY1R5cGUgQ2xhc3Mgb2YgY29tcG9uZW50IHRvIHJlbW92ZS5cbiAgICovXG4gIHJlbW92ZSA9IChjVHlwZTogQ1QpOiB2b2lkID0+IHtcbiAgICB0aGlzLmNvbXBvbmVudHMuZGVsZXRlKGNUeXBlLm5hbWUpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBHZXQgYSBjb21wb25lbnQgdGhhdCBtYXRjaGVzIHRoZSBwYXNzZWQgY2xhc3MuXG4gICAqIFdpbGwgdGhyb3cgYW4gZXJyb3IgaWYgYW4gaW5zdGFuY2Ugb2YgdGhlIGdpdmVuIGNvbXBvbmVudFxuICAgKiBkb2Vzbid0IGV4aXN0IGluIHRoZSBjb2xsZWN0aW9uLCBzbyBpZiB5b3UgZG9uJ3Qga25vdyBpZiBpdCdzIHNhZmVcbiAgICogdG8gZ2V0IGEgY29tcG9uZW50LCB5b3Ugc2hvdWxkIHRlc3Qgd2l0aCBoYXMoKSBvciBoYXNCeU5hbWUoKSBmaXJzdC5cbiAgICogWW91IGhhdmUgYmVlbiB3YXJuZWQuXG4gICAqIEBwYXJhbSBjbCBjb21wb25lbnQgQ2xhc3MgcmVmZXJlbmNlLlxuICAgKi9cbiAgZ2V0ID0gPFQ+KGNsOiBDbGFzczxUPik6IEluc3RhbmNlVHlwZTx0eXBlb2YgY2w+ID0+IHtcbiAgICBjb25zdCBjb21wID0gdGhpcy5jb21wb25lbnRzLmdldChjbC5uYW1lKTtcblxuICAgIGlmIChpc0NvbXBvbmVudEluc3RhbmNlPFQ+KGNsLCBjb21wKSkge1xuICAgICAgcmV0dXJuIGNvbXA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYENvbXBvbmVudENvbGxlY3Rpb24gZG9lcyBub3QgaGF2ZSBjb21wb25lbnQgb2YgdHlwZSAke2NsLm5hbWV9YFxuICAgICAgKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gUG9zc2libGUgb3RoZXIgd2F5IHRvIHdyaXRlIGEgZ2V0IG1ldGhvZCB0aGF0IG1haW50YWlucyB0aGUgdHlwZSBvZiB0aGVcbiAgLy8gQ29tcG9uZW50IHRocm91Z2hvdXQuIEtlZXBpbmcgYXJvdW5kIGZvciBub3cgYXJlIGEgcmVmZXJlbmNlLlxuICAvLyBnZXQ8VSBleHRlbmRzIENUPihjb21wQ2xhc3M6IENsYXNzPFU+KTogVSB7XG4gIC8vICAgaWYgKCF0aGlzLmNvbXBvbmVudHMuaGFzKGNvbXBDbGFzcy5uYW1lKSkge1xuICAvLyAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAvLyAgICAgICBgQ29tcG9uZW50Q29sbGVjdGlvbiBkb2VzIG5vdCBoYXZlIGNvbXBvbmVudCBvZiB0eXBlICR7Y29tcENsYXNzLm5hbWV9YFxuICAvLyAgICAgKTtcbiAgLy8gICB9XG5cbiAgLy8gICByZXR1cm4gdGhpcy5jb21wb25lbnRzLmdldChjb21wQ2xhc3MubmFtZSkhIGFzIHVua25vd24gYXMgVTtcbiAgLy8gfVxuXG4gIC8qKlxuICAgKiBUZXN0IHRvIHNlZSBpZiB0aGUgY29sbGVjdGlvbiBjb250YWlucyBhIHNwZWNpZmljIENsYXNzIG9yIENsYXNzZXMuXG4gICAqIEBwYXJhbSBjVHlwZSBjb21wb25lbnQgQ2xhc3MsIG9yIGFycmF5IG9mIGNvbXBvbmVudCBDbGFzc2VzLlxuICAgKi9cbiAgaGFzID0gKGNUeXBlOiBDVCB8IENUW10pOiBib29sZWFuID0+IHtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheShjVHlwZSlcbiAgICAgID8gY1R5cGUuZXZlcnkoKGN0KSA9PiB0aGlzLmNvbXBvbmVudHMuaGFzKGN0Lm5hbWUpID09PSB0cnVlKVxuICAgICAgOiB0aGlzLmNvbXBvbmVudHMuaGFzKGNUeXBlLm5hbWUpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBUZXN0IHRvIHNlZSBpZiB0aGUgY29sbGVjdGlvbiBoYXMgYSBjb21wb25lbnQgaW5zdGFuY2UgYmFzZWQgb24gYVxuICAgKiBjbGFzcyBuYW1lLiBTb21lIGJ1aWxkIHN0ZXBzL21pbmlmaWVycyB3aWxsIGNoYW5nZSB0aGUgbmFtZSBvZiBDbGFzc2VzLFxuICAgKiBzbyBpdCdzIHVzdWFsbHkgYmVzdCB0byBwYXNzIGluIGEgTXlDbGFzcy5uYW1lIGluc3RlYWQgb2YgJ015Q2xhc3MnLlxuICAgKiBAcGFyYW0gY05hbWUgVGhlIG5hbWUgb2YgYSBDbGFzcywgb3IgYXJyYXkgb2YgQ2xhc3MgbmFtZXMuXG4gICAqL1xuICBoYXNCeU5hbWUgPSAoY05hbWU6IHN0cmluZyB8IHN0cmluZ1tdKTogYm9vbGVhbiA9PiB7XG4gICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoY05hbWUpXG4gICAgICA/IGNOYW1lLmV2ZXJ5KGN0ID0+IHRoaXMuY29tcG9uZW50cy5oYXMoY3QpID09PSB0cnVlKVxuICAgICAgOiB0aGlzLmNvbXBvbmVudHMuaGFzKGNOYW1lKTtcbiAgfTtcblxuICAvKipcbiAgICogR2V0IHRoZSBjb21wb25lbnQgdHlwZSBuYW1lcyB0aGF0IGFyZSBjdXJyZW50bHkgYmVpbmcgdXNlZCBpbiB0aGUgY29sbGVjdGlvbi5cbiAgICovXG4gIGdldCBjb21wb25lbnRUeXBlcygpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIFsuLi50aGlzLmNvbXBvbmVudHMua2V5cygpXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGN1cnJlbnQgbnVtYmVyIG9mIGNvbXBvbmVudHMgdGhhdCBhcmUgaW4gdGhlIGNvbGxlY3Rpb24uXG4gICAqL1xuICBnZXQgc2l6ZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmNvbXBvbmVudHMuc2l6ZTtcbiAgfVxuXG4gIHRvRGV2Q29tcG9uZW50cygpOiBSZWNvcmQ8c3RyaW5nLCBJbnN0YW5jZVR5cGU8Q1Q+PiB7XG4gICAgY29uc3Qgb2JqOiBSZWNvcmQ8c3RyaW5nLCBJbnN0YW5jZVR5cGU8Q1Q+PiA9IHt9O1xuICAgIGZvciAoY29uc3QgW2NvbXBOYW1lLCBjb21wXSBvZiB0aGlzLmNvbXBvbmVudHMpIHtcbiAgICAgIG9ialtjb21wTmFtZV0gPSBjb21wO1xuICAgIH1cblxuICAgIHJldHVybiBvYmo7XG4gIH1cbn1cbiIsImltcG9ydCBXb3JsZCwgeyBDbGFzcyB9IGZyb20gXCIuL1dvcmxkXCI7XG5pbXBvcnQgRW50aXR5IGZyb20gXCIuL0VudGl0eVwiO1xuaW1wb3J0IHsgVGFnIH0gZnJvbSBcIi4vVGFnXCI7XG5cbmNsYXNzIERldkVudGl0eTxDVCBleHRlbmRzIENsYXNzPGFueT4+IHtcbiAgaWQ6IHN0cmluZztcblxuICBjb21wb25lbnRzOiBSZWNvcmQ8c3RyaW5nLCBJbnN0YW5jZVR5cGU8Q1Q+PjtcblxuICB0YWdzOiBUYWdbXTtcblxuICBjb25zdHJ1Y3RvcihlbnRpdHk6IEVudGl0eTxDVD4sIHdvcmxkOiBXb3JsZDxDVD4pIHtcbiAgICB0aGlzLmlkID0gZW50aXR5LmlkO1xuICAgIHRoaXMuY29tcG9uZW50cyA9IGVudGl0eS5jb21wb25lbnRzLnRvRGV2Q29tcG9uZW50cygpLFxuICAgIHRoaXMudGFncyA9IFsuLi5lbnRpdHkudGFnc107XG5cbiAgICAvLyBnZXQgYWxsIHRoZSBzeXN0ZW1zIHRoYXQgd291bGQgdHJpZ2dlciB3aXRoIHRoaXMgZW50aXR5Li4uXG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRGV2RW50aXR5O1xuIiwiaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCc7XG5pbXBvcnQgV29ybGQgZnJvbSAnLi9Xb3JsZCc7XG5pbXBvcnQgQ29tcG9uZW50Q29sbGVjdGlvbiBmcm9tICcuL0NvbXBvbmVudENvbGxlY3Rpb24nO1xuaW1wb3J0IHsgVGFnIH0gZnJvbSAnLi9UYWcnO1xuaW1wb3J0IHsgQ29tcFR5cGVzIH0gZnJvbSAnaW50ZXJmYWNlcyc7XG5pbXBvcnQgRGV2RW50aXR5IGZyb20gJy4vRGV2RW50aXR5JztcblxuZXhwb3J0IHR5cGUgRW50aXR5SWQgPSBzdHJpbmc7XG5cbnR5cGUgQ2xhc3M8VD4gPSB7IG5ldyAoLi4uYXJnczogYW55W10pOiBUIH07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEVudGl0eTxDVCBleHRlbmRzIENsYXNzPGFueT4+IHtcbiAgcHJpdmF0ZSBfaWQ6IHN0cmluZztcbiAgcHJpdmF0ZSBfd29ybGQ6IFdvcmxkPENUPjtcblxuICBjb25zdHJ1Y3Rvcih3b3JsZDogV29ybGQ8Q1Q+KSB7XG4gICAgdGhpcy5faWQgPSB1dWlkdjQoKTtcbiAgICB0aGlzLl93b3JsZCA9IHdvcmxkO1xuXG4gICAgLypcbiAgICBSZWdpc3RlcmluZyB3aXRoIHRoZSBXb3JsZC5cbiAgICAqL1xuICAgIHRoaXMuX3dvcmxkLnJlZ2lzdGVyRW50aXR5KHRoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZCBhIGNvbXBvbmVudCB0byBhbiBFbnRpdHksIGRvaC5cbiAgICovXG4gIGFkZChjb21wb25lbnQ6IEluc3RhbmNlVHlwZTxDVD4pOiB0aGlzIHtcbiAgICB0aGlzLl93b3JsZC5zZXQodGhpcy5faWQsIGNvbXBvbmVudCk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGQgYSB0YWcgdG8gYSBjb21wb25lbnRcbiAgICovXG4gIGFkZFRhZyh0YWc6IFRhZyk6IHRoaXMge1xuICAgIGNvbnN0IGVudGl0eVNldCA9IHRoaXMuX3dvcmxkLmVudGl0aWVzQnlUYWdzLmhhcyh0YWcpXG4gICAgICA/IHRoaXMuX3dvcmxkLmVudGl0aWVzQnlUYWdzLmdldCh0YWcpXG4gICAgICA6IG5ldyBTZXQ8RW50aXR5SWQ+KCk7XG5cbiAgICBpZiAoZW50aXR5U2V0KSB7XG4gICAgICBlbnRpdHlTZXQuYWRkKHRoaXMuX2lkKTtcbiAgICAgIHRoaXMuX3dvcmxkLmVudGl0aWVzQnlUYWdzLnNldCh0YWcsIGVudGl0eVNldCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiBhbiBlbnRpdHkgaGFzIGEgY29tcG9uZW50IHJlbGF0ZWQgdG8gaXQuXG4gICAqL1xuICBoYXMoY1R5cGU6IENUKTogYm9vbGVhbiB7XG4gICAgY29uc3QgY2MgPSB0aGlzLl93b3JsZC5jb21wb25lbnRDb2xsZWN0aW9ucy5nZXQodGhpcy5faWQpIHx8IG5ldyBDb21wb25lbnRDb2xsZWN0aW9uPENUPigpO1xuXG4gICAgcmV0dXJuIGNjLmhhcyhjVHlwZSk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgdG8gc2VlIGlmIGFuIGVudGl0eSB0YWdnZWQgd2l0aCBhIGdpdmVuIHRhZy5cbiAgICovXG4gIGhhc1RhZyh0YWc6IFRhZyk6IGJvb2xlYW4ge1xuICAgIGlmICh0aGlzLl93b3JsZC5lbnRpdGllc0J5VGFncy5oYXModGFnKSkge1xuICAgICAgY29uc3QgZW50aXR5U2V0ID0gdGhpcy5fd29ybGQuZW50aXRpZXNCeVRhZ3MuZ2V0KHRhZyk7XG4gICAgICBpZiAoZW50aXR5U2V0KSB7XG4gICAgICAgIHJldHVybiBlbnRpdHlTZXQuaGFzKHRoaXMuX2lkKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgY29tcG9uZW50IHRoYXQgYmVsb25ncyB0byBhbiBlbnRpdHkuXG4gICAqL1xuICBnZXQ8VD4oY2w6IENsYXNzPFQ+KTogSW5zdGFuY2VUeXBlPHR5cGVvZiBjbD4ge1xuICAgIGNvbnN0IGNjID0gdGhpcy5fd29ybGQuY29tcG9uZW50Q29sbGVjdGlvbnMuZ2V0KHRoaXMuX2lkKSB8fCBuZXcgQ29tcG9uZW50Q29sbGVjdGlvbjxDVD4oKTtcblxuICAgIGNvbnN0IGNvbXBvbmVudCA9IGNjLmdldDxUPihjbCk7XG5cbiAgICByZXR1cm4gY29tcG9uZW50O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbGwgY29tcG9uZW50cyB0aGF0IGhhdmUgYmVlbiBhZGRlZCB0byBhbiBlbnRpdHksIHZpYSBhIENvbXBvbmVudENvbGxlY3Rpb25cbiAgICovXG4gIGdldEFsbCgpOiBDb21wb25lbnRDb2xsZWN0aW9uPENUPiB7XG4gICAgcmV0dXJuIHRoaXMuX3dvcmxkLmNvbXBvbmVudENvbGxlY3Rpb25zLmdldCh0aGlzLl9pZCkgfHwgbmV3IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+KCk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGEgY29tcG9uZW50IGZyb20gYW4gZW50aXR5LlxuICAgKiBAcGFyYW0gY1R5cGUgQSBjb21wb25lbnQgY2xhc3MsIGVnIE15Q29tcG9uZW50XG4gICAqL1xuICByZW1vdmUoY1R5cGU6IENUKTogdGhpcyB7XG4gICAgdGhpcy5fd29ybGQucmVtb3ZlKHRoaXMuX2lkLCBjVHlwZSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgYSB0YWcgZnJvbSBhbiBlbnRpdHlcbiAgICovXG4gIHJlbW92ZVRhZyh0YWc6IFRhZyk6IHRoaXMge1xuICAgIGlmICh0aGlzLl93b3JsZC5lbnRpdGllc0J5VGFncy5oYXModGFnKSkge1xuICAgICAgY29uc3QgZW50aXR5U2V0ID0gdGhpcy5fd29ybGQuZW50aXRpZXNCeVRhZ3MuZ2V0KHRhZyk7XG4gICAgICBcbiAgICAgIGlmIChlbnRpdHlTZXQpIHtcbiAgICAgICAgZW50aXR5U2V0LmRlbGV0ZSh0aGlzLl9pZCk7XG5cbiAgICAgICAgaWYgKGVudGl0eVNldC5zaXplID09PSAwKSB7XG4gICAgICAgICAgdGhpcy5fd29ybGQuZW50aXRpZXNCeVRhZ3MuZGVsZXRlKHRhZyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKiogQ2xlYXJzIGFsbCBjb21wb25lbnRzIGZyb20gYW4gRW50aXR5ICovXG4gIGNsZWFyKCk6IHRoaXMge1xuICAgIHRoaXMuX3dvcmxkLmNsZWFyRW50aXR5Q29tcG9uZW50cyh0aGlzLl9pZCk7XG5cbiAgICByZXR1cm4gdGhpc1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhbGwgdGFncyBvbiBhbiBlbnRpdHlcbiAgICovXG4gIGNsZWFyVGFncygpOiB0aGlzIHtcbiAgICBmb3IgKGNvbnN0IFt0YWcsIGVudGl0eVNldF0gb2YgdGhpcy5fd29ybGQuZW50aXRpZXNCeVRhZ3MuZW50cmllcygpKSB7XG4gICAgICBlbnRpdHlTZXQuZGVsZXRlKHRoaXMuX2lkKTtcblxuICAgICAgaWYgKGVudGl0eVNldC5zaXplID09PSAwKSB7XG4gICAgICAgIHRoaXMuX3dvcmxkLmVudGl0aWVzQnlUYWdzLmRlbGV0ZSh0YWcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgZGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLl93b3JsZC5kZXN0cm95RW50aXR5KHRoaXMuX2lkKTtcbiAgfVxuXG4gIGdldCBpZCgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl9pZDtcbiAgfVxuXG4gIGdldCB3b3JsZCgpOiBXb3JsZDxDVD4ge1xuICAgIHJldHVybiB0aGlzLl93b3JsZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYWxsIGNvbXBvbmVudHMgdGhhdCBoYXZlIGJlZW4gYWRkZWQgdG8gYW4gZW50aXR5LCB2aWEgYSBDb21wb25lbnRDb2xsZWN0aW9uLlxuICAgKiBEb2VzIHRoZSBzYW1lIHRoaW5nIGFzIGVudGl0eUluc3RhbmNlLmdldEFsbCgpLlxuICAgKi9cbiAgZ2V0IGNvbXBvbmVudHMoKTogQ29tcG9uZW50Q29sbGVjdGlvbjxDVD4ge1xuICAgIHJldHVybiB0aGlzLl93b3JsZC5jb21wb25lbnRDb2xsZWN0aW9ucy5nZXQodGhpcy5faWQpIHx8IG5ldyBDb21wb25lbnRDb2xsZWN0aW9uPENUPigpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJldHJpZXZlcyBhbGwgdGhlIHRhZ3MgdGhhdCBoYXZlIGJlZW4gYWRkZWQgdG8gdGhpcyBlbnRpdHkuXG4gICAqL1xuICBnZXQgdGFncygpOiBTZXQ8VGFnPiB7XG4gICAgY29uc3QgdGFncyA9IG5ldyBTZXQ8VGFnPigpO1xuICAgIGZvciAoY29uc3QgW3RhZywgZW50aXR5U2V0XSBvZiB0aGlzLl93b3JsZC5lbnRpdGllc0J5VGFncy5lbnRyaWVzKCkpIHtcbiAgICAgIGlmIChlbnRpdHlTZXQuaGFzKHRoaXMuX2lkKSkge1xuICAgICAgICB0YWdzLmFkZCh0YWcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0YWdzO1xuICB9XG5cbiAgdG9EZXZFbnRpdHkoKTogRGV2RW50aXR5PENUPiB7XG4gICAgcmV0dXJuIG5ldyBEZXZFbnRpdHk8Q1Q+KHRoaXMpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFbnRpdHk8Q1QgZXh0ZW5kcyBDbGFzczxhbnk+PihcbiAgd29ybGQ6IFdvcmxkPENUPixcbik6IEVudGl0eTxDVD4ge1xuICBjb25zdCBlbnRpdHkgPSBuZXcgRW50aXR5PENUPih3b3JsZCk7XG5cbiAgcmV0dXJuIGVudGl0eTtcbn1cblxuXG4iLCJpbXBvcnQgV29ybGQgZnJvbSAnLi9Xb3JsZCc7XG5pbXBvcnQgRW50aXR5IGZyb20gJy4vRW50aXR5JztcbmltcG9ydCBDb21wb25lbnRDb2xsZWN0aW9uIGZyb20gJy4vQ29tcG9uZW50Q29sbGVjdGlvbic7XG5cbnR5cGUgQ2xhc3M8VD4gPSB7IG5ldyAoLi4uYXJnczogYW55W10pOiBUIH07XG5cbmV4cG9ydCB0eXBlIFN5c3RlbSA9ICgpID0+IHZvaWQ7XG5cbi8qKlxuICogQXJndW1lbnRzIHRoYXQgYXJlIHBhc3NlZCBpbnRvIGEgU3lzdGVtIGZ1bmN0aW9uIG9uIGVhY2ggaXRlcmF0aW9uLlxuICogVGhpcyBpcyBob3cgeW91IGFjY2VzIHRoaW5ncyBsaWtlIHRoZSBlbnRpdHkgdGhhdCBwYXJ0aWN1bGFyIGVudGl0eSB0byBhY3Qgb24sXG4gKiBhcyB3ZWxsIGFzIHNvbWUgb3RoZXIgaGVscGZ1bCBwYXJhbXMgbGlrZSBpZiB0aGUgZW50aXR5IGlzIHRoZSBmaXJzdCBvciBsYXN0IGVudGl0eVxuICogaW4gdGhlIGdyb3VwIG9mIGVudGl0aWVzIHRoYXQgYmVpbmcgaXRlcmF0ZWQgb3Zlci5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBTeXN0ZW1GdW5jQXJnczxDVCBleHRlbmRzIENsYXNzPGFueT4+IHtcbiAgLyoqXG4gICAqIFRoZSBjdXJyZW50IGVudGl0eSBiZWluZyBpdGVyYXRlZC5cbiAgICovXG4gIGVudGl0eTogRW50aXR5PENUPjtcbiAgLyoqXG4gICAqIFRoZSBjb21wb25lbnRzIHRoYXQgYmVsb25nIHRvIHRoZSBlbnRpdHlcbiAgICovXG4gIGNvbXBvbmVudHM6IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+O1xuICAvKipcbiAgICogVGhlIFdvcmxkIGluc3RhbmNlLlxuICAgKiBVc2UgdGhpcyB0byBhY2Nlc3Mgb3RoZXIgZW50aXRpZXMuXG4gICAqL1xuICB3b3JsZDogV29ybGQ8Q1Q+O1xuICBpbmRleDogbnVtYmVyO1xuICBzaXplOiBudW1iZXI7XG4gIC8qKlxuICAgKiBJcyB0aGUgZmlyc3QgZW50aXR5IHRvIGJlIGl0ZXJhdGVkIG9uIHRoaXMgcnVuIG9mIGEgc3lzdGVtLlxuICAgKiBIZWxwZnVsIGZvciBzZXR0aW5nIHVwIHN0YXRlIHRoYXQgaXMgdGhlIHNhbWUgZm9yIGFsbCBlbnRpdGllcyBvbmx5IG9uY2UuXG4gICAqL1xuICBpc0ZpcnN0OiBib29sZWFuO1xuICAvKipcbiAgICogSXMgdGhlIGxhc3QgZW50aXR5IHRvIGJlIGl0ZXJhdGVkIG9uIHRoaXMgcnVuIG9mIGEgc3lzdGVtLlxuICAgKiBDYW4gYmUgaGVscGZ1bCB0byB0ZWFyIGRvd24gYW55dGhpbmcgdGhhdCBzaG91bGQgYmUgZGVhbHQgd2l0aCBhZnRlciBhbGwgdGhlIGVudGl0ZXMgaGF2ZSByYW4uXG4gICAqL1xuICBpc0xhc3Q6IGJvb2xlYW47XG59XG5cbi8qKlxuICogRnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgd2hlbiBhIHN5c3RlbSBpcyBydW4uXG4gKi9cbmV4cG9ydCB0eXBlIFN5c3RlbUZ1bmM8Q1QgZXh0ZW5kcyBDbGFzczxDVD4+ID0gKFxuICBzeXRlbUZ1bmNBcmdzOiBTeXN0ZW1GdW5jQXJnczxDVD4sXG4pID0+IHZvaWQ7XG5cbi8qKlxuICogVGhpcyBpcyBob3cgeW91IGNyZWF0ZSBhIFN5c3RlbS5cbiAqIEBleGFtcGxlXG4gKiBgYGBcbiAqIGNyZWF0ZVN5c3RlbSh3b3JsZCwgWydDb21wb25lbnRUeXBlJ10sICh7IGVudGl0eSB9KSA9PiAnRG8gZnVuIHN5c3RlbSB0aGluZ3MgaGVyZS4nKVxuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTeXN0ZW08Q1QgZXh0ZW5kcyBDbGFzczxhbnk+PihcbiAgd29ybGQ6IFdvcmxkPENUPixcbiAgY1R5cGVzOiBDVFtdLFxuICBzeXN0ZW1GdW5jOiBTeXN0ZW1GdW5jPENUPixcbik6IFN5c3RlbSB7XG4gIGNvbnN0IGNOYW1lcyA9IGNUeXBlcy5tYXAoY3QgPT4gY3QubmFtZSk7XG4gIHdvcmxkLnJlZ2lzdGVyU3lzdGVtKGNOYW1lcywgc3lzdGVtRnVuYy5uYW1lKTtcblxuICByZXR1cm4gKCk6IHZvaWQgPT4ge1xuICAgIGxldCBpbmRleCA9IDA7XG4gICAgY29uc3Qgc2l6ZSA9IHdvcmxkLmVudGl0aWVzQnlDVHlwZXMuc2l6ZTtcblxuICAgIC8vIFVzZWQgZm9yIG1hdGNoaW5nIHRoZSBhcnJheSBvZiBDb21wb25lbnRUeXBlcyB3aGljaCBpcyB0aGUga2V5XG4gICAgLy8gb2Ygd2hlcmUgdGhlIENvbXBvbmVudENvbGxlY3Rpb24gaXMsIHdpdGggdGhlIGFycmF5IG9mIENvbXBvbmVudFR5cGVzXG4gICAgLy8gdGhhdCBhcmUgcGFzc2VzLlxuICAgIC8vIE1pZ2h0IGJlIG5pY2UgaW4gdGhlIGZ1dHVyZSB0byBnbyBiYWNrIHRvIGEgcmVmIGNoZWNrIG9uIGNUeXBlcywgYnV0XG4gICAgLy8gZm9yIG5vdyB0aGlzIGRvZXNuJ3Qgc2VlbSB0byBiZSB0aGF0IG11Y2ggb2YgYSBwZXJmIGhpdC5cbiAgICAvLyBmb3IgKGNvbnN0IGN0IG9mIHdvcmxkLmVudGl0aWVzQnlDVHlwZXMua2V5cygpKSB7XG4gICAgLy8gICBpZiAoY1R5cGVzLmxlbmd0aCA9PT0gY3QubGVuZ3RoICYmIGNUeXBlcy5ldmVyeShjID0+IGN0LmluY2x1ZGVzKGMpKSkge1xuICAgIC8vICAgICBmb3IgKGNvbnN0IGVpZCBvZiB3b3JsZC5lbnRpdGllc0J5Q1R5cGVzLmdldChjVHlwZXMpKSB7XG4gICAgLy8gICAgICAgY29uc3QgYXJnczogU3lzdGVtRnVuY0FyZ3M8Q1Q+ID0ge1xuICAgIC8vICAgICAgICAgZW50aXR5OiB3b3JsZC5lbnRpdGllcy5nZXQoZWlkKSxcbiAgICAvLyAgICAgICAgIGNvbXBvbmVudHM6IHdvcmxkLmNvbXBvbmVudENvbGxlY3Rpb25zLmdldChlaWQpLFxuICAgIC8vICAgICAgICAgd29ybGQsXG4gICAgLy8gICAgICAgICBpbmRleCxcbiAgICAvLyAgICAgICAgIHNpemUsXG4gICAgLy8gICAgICAgICBpc0ZpcnN0OiBpbmRleCA9PT0gMCxcbiAgICAvLyAgICAgICAgIGlzTGFzdDogaW5kZXggKyAxID09PSBzaXplLFxuICAgIC8vICAgICAgIH1cbiAgICBcbiAgICAvLyAgICAgICBzeXN0ZW1GdW5jKGFyZ3MpO1xuICAgIFxuICAgIC8vICAgICAgIGluZGV4ICs9IDE7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgIH1cbiAgICAvLyB9XG5cbiAgICBjb25zdCBjVHlwZUFycnMgPSB3b3JsZC5lbnRpdGllc0J5Q1R5cGVzLmdldChjTmFtZXMpIHx8IG5ldyBTZXQoKTtcblxuICAgIGZvciAoY29uc3QgZWlkIG9mIGNUeXBlQXJycykge1xuICAgICAgY29uc3QgYXJnczogU3lzdGVtRnVuY0FyZ3M8Q1Q+ID0ge1xuICAgICAgICBlbnRpdHk6IHdvcmxkLmVudGl0aWVzLmdldChlaWQpIHx8IG5ldyBFbnRpdHk8Q1Q+KHdvcmxkKSxcbiAgICAgICAgY29tcG9uZW50czogd29ybGQuY29tcG9uZW50Q29sbGVjdGlvbnMuZ2V0KGVpZCkgfHwgbmV3IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+KCksXG4gICAgICAgIHdvcmxkLFxuICAgICAgICBpbmRleCxcbiAgICAgICAgc2l6ZSxcbiAgICAgICAgaXNGaXJzdDogaW5kZXggPT09IDAsXG4gICAgICAgIGlzTGFzdDogaW5kZXggKyAxID09PSBzaXplLFxuICAgICAgfVxuXG4gICAgICBzeXN0ZW1GdW5jKGFyZ3MpO1xuXG4gICAgICBpbmRleCArPSAxO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IFdvcmxkLCB7IENsYXNzIH0gZnJvbSAnLi9Xb3JsZCc7XG5pbXBvcnQgRGV2RW50aXR5IGZyb20gJy4vRGV2RW50aXR5JztcblxuY2xhc3MgRGV2VG9vbHM8Q1QgZXh0ZW5kcyBDbGFzczxhbnk+PiB7XG4gIHdvcmxkOiBXb3JsZDxDVD47XG5cbiAgY29uc3RydWN0b3Iod29ybGQ6IFdvcmxkPENUPikge1xuICAgIHRoaXMud29ybGQgPSB3b3JsZDtcbiAgfVxuXG4gIC8vIGxvZyBhIHRhYmxlIG9mIHN5c3RlbXMsIGFuZCB0aGUgY29tcG9uZW50cyBmb3IgdGhlbS5cbiAgbG9nU3lzdGVtQ29tcFRhYmxlKCk6IHZvaWQge1xuICAgIGNvbnN0IHRoaW5ncyA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBbc3lzdGVtTmFtZSwgY29tcE5hbWVzXSBvZiB0aGlzLndvcmxkLmNvbXBOYW1lc0J5U3lzdGVtTmFtZSkge1xuICAgICAgdGhpbmdzLnB1c2goeyBzeXN0ZW1OYW1lLCBjb21wb25lbnRzOiBjb21wTmFtZXMuam9pbignLCcpIH0pO1xuICAgIH1cblxuICAgIGNvbnNvbGUudGFibGUodGhpbmdzKTtcbiAgfVxuXG4gIC8vIFdvdWxkIGJlIG5pY2UgdG8gbGlzdCBhbGwgdGhlIHN5c3RlbXMgdGhhdCB3aWxsIGFwcGx5IHRvIGFuIGVudGl0eS5cblxuICBnZXQgZW50aXRpZXMoKTogRGV2RW50aXR5PENUPltdIHtcbiAgICByZXR1cm4gWy4uLnRoaXMud29ybGQuZW50aXRpZXMudmFsdWVzKCldLm1hcChlID0+IGUudG9EZXZFbnRpdHkoKSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRGV2VG9vbHM7XG4iLCJpbXBvcnQgRW50aXR5LCB7IEVudGl0eUlkIH0gZnJvbSBcIi4vRW50aXR5XCI7XG5pbXBvcnQgQ29tcG9uZW50Q29sbGVjdGlvbiBmcm9tIFwiLi9Db21wb25lbnRDb2xsZWN0aW9uXCI7XG5pbXBvcnQgeyBUYWcgfSBmcm9tIFwiLi9UYWdcIjtcbmltcG9ydCB7IGNyZWF0ZVN5c3RlbSwgU3lzdGVtLCBTeXN0ZW1GdW5jIH0gZnJvbSBcIi4vU3lzdGVtXCI7XG5pbXBvcnQgRGV2dG9vbHMgZnJvbSBcIi4vRGV2VG9vbHNcIjtcblxuZXhwb3J0IHR5cGUgQ2xhc3M8VD4gPSB7IG5ldyAoLi4uYXJnczogYW55W10pOiBUIH07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFdvcmxkPENUIGV4dGVuZHMgQ2xhc3M8YW55Pj4ge1xuICBjb21wb25lbnRDb2xsZWN0aW9uczogTWFwPEVudGl0eUlkLCBDb21wb25lbnRDb2xsZWN0aW9uPENUPj4gPSBuZXcgTWFwKCk7XG5cbiAgZW50aXRpZXM6IE1hcDxFbnRpdHlJZCwgRW50aXR5PENUPj4gPSBuZXcgTWFwKCk7XG5cbiAgZW50aXRpZXNCeUNUeXBlczogTWFwPHN0cmluZ1tdLCBTZXQ8RW50aXR5SWQ+PiA9IG5ldyBNYXAoKTtcblxuICBlbnRpdGllc0J5VGFnczogTWFwPFRhZywgU2V0PEVudGl0eUlkPj4gPSBuZXcgTWFwKCk7XG5cbiAgY29tcE5hbWVzQnlTeXN0ZW1OYW1lOiBNYXA8c3RyaW5nLCBzdHJpbmdbXT4gPSBuZXcgTWFwKCk7XG5cbiAgZGV2OiBEZXZ0b29sczxDVD47XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5kZXYgPSBuZXcgRGV2dG9vbHModGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogXCJmaW5kc1wiIGEgc2luZ2xlIGVudGl0eSBiYXNlZCBvbiBhIHByZWRpY2F0ZVxuICAgKi9cbiAgZmluZCA9IChwcmVkaWNhdGU6IChlbnRpdHk6IEVudGl0eTxDVD4pID0+IGJvb2xlYW4pOiBFbnRpdHk8Q1Q+IHwgbnVsbCA9PiB7XG4gICAgZm9yIChjb25zdCBlbnRpdHkgb2YgdGhpcy5lbnRpdGllcy52YWx1ZXMoKSkge1xuICAgICAgaWYgKHByZWRpY2F0ZShlbnRpdHkpKSB7XG4gICAgICAgIHJldHVybiBlbnRpdHk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG5cbiAgLyoqXG4gICAqIFwiZmluZHNcIiBhbGwgZW50aXRpZXMgYmFzZWQgb24gYSBwcmVkaWNhdGUsIGtpbmRhIGxpa2UgZmlsdGVyLlxuICAgKi9cbiAgZmluZEFsbCA9IChwcmVkaWNhdGU6IChlbnRpdHk6IEVudGl0eTxDVD4pID0+IGJvb2xlYW4pOiBFbnRpdHk8Q1Q+W10gPT4ge1xuICAgIGNvbnN0IHJlc3VsdHM6IEVudGl0eTxDVD5bXSA9IFtdO1xuXG4gICAgZm9yIChjb25zdCBlbnRpdHkgb2YgdGhpcy5lbnRpdGllcy52YWx1ZXMoKSkge1xuICAgICAgaWYgKHByZWRpY2F0ZShlbnRpdHkpKSB7XG4gICAgICAgIHJlc3VsdHMucHVzaChlbnRpdHkpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiByZXN1bHRzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBcImxvY2F0ZXNcIiBhIHNpbmdsZSBlbnRpdHkgYmFzZWQgb24gaXRzIENvbXBvbmVudHMuXG4gICAqL1xuICBsb2NhdGUgPSAoY2w6IENUIHwgQ1RbXSk6IEVudGl0eTxDVD4gfCBudWxsID0+IHtcbiAgICBmb3IgKGNvbnN0IGVudGl0eSBvZiB0aGlzLmVudGl0aWVzLnZhbHVlcygpKSB7XG4gICAgICAvLyBjb25zb2xlLmxvZyhcImVudGl0eT9cIiwgZW50aXR5LmNvbXBvbmVudHMsIGNsLm5hbWUpO1xuICAgICAgaWYgKGVudGl0eS5jb21wb25lbnRzLmhhcyhjbCkpIHtcbiAgICAgICAgcmV0dXJuIGVudGl0eTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfTtcblxuICAvKipcbiAgICogTG9jYXRlcyBhbGwgZW50aXRpZXMgdGhhdCBjb250YWluIHRoZSBjb21wb25lbnRzIG5hbWVkXG4gICAqL1xuICBsb2NhdGVBbGwgPSAoY2w6IENUIHwgQ1RbXSk6IEVudGl0eTxDVD5bXSA9PiB7XG4gICAgY29uc3QgcmVzdWx0czogRW50aXR5PENUPltdID0gW107XG5cbiAgICBmb3IgKGNvbnN0IGVudGl0eSBvZiB0aGlzLmVudGl0aWVzLnZhbHVlcygpKSB7XG4gICAgICBpZiAoZW50aXR5LmNvbXBvbmVudHMuaGFzKGNsKSkge1xuICAgICAgICByZXN1bHRzLnB1c2goZW50aXR5KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0cztcbiAgfTtcblxuICAvKipcbiAgICogR3JhYnMgdGhlIGZpcnN0IGVudGl0eSwgYW5kIGl0cyByZWxhdGVkIGNvbXBvbmVudCwgdGhhdCBtYXRjaGVzIHRoZSBjb21wb25lbnQgdHlwZS5cbiAgICogQGV4YW1wbGVcbiAgICogYGBgXG4gICAqIGNvbnN0IHsgZW50aXR5LCBjb21wb25lbnQgfSA9IHdvcmxkLmdyYWIoTXlDb21wb25lbnQpO1xuICAgKiBgYGBcbiAgICovXG4gIGdyYWIgPSA8VD4oXG4gICAgY2w6IENsYXNzPFQ+XG4gICk6IHsgZW50aXR5OiBFbnRpdHk8Q1Q+OyBjb21wb25lbnQ6IEluc3RhbmNlVHlwZTx0eXBlb2YgY2w+IH0gfCBudWxsID0+IHtcbiAgICAvLyBjb25zdCBlbnRpdHkgPSB0aGlzLmxvY2F0ZSgoY2wgYXMgdW5rbm93bikgYXMgQ1Rba2V5b2YgQ1RdKTtcbiAgICBjb25zdCBlbnRpdHkgPSB0aGlzLmxvY2F0ZSgoY2wgYXMgdW5rbm93bikgYXMgQ1QpO1xuXG4gICAgaWYgKGVudGl0eSkge1xuICAgICAgY29uc3QgY2MgPVxuICAgICAgICB0aGlzLmNvbXBvbmVudENvbGxlY3Rpb25zLmdldChlbnRpdHkuaWQpIHx8XG4gICAgICAgIG5ldyBDb21wb25lbnRDb2xsZWN0aW9uPENUPigpO1xuXG4gICAgICBjb25zdCBjb21wb25lbnQgPSBjYy5nZXQ8VD4oY2wpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBlbnRpdHksXG4gICAgICAgIGNvbXBvbmVudCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdyYWIgc2luZ2xlIGNvbXBvbmVudCBiYXNlZCBvbiBjb21wb25lbnQgdHlwZSBhbmQgcHJlZGljYXRlLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGB0eXBlc2NyaXB0XG4gICAqIGNvbnN0IHsgZW50aXR5LCBjb21wb25lbnQgfSA9IHdvcmxkLmdyYWJCeShGaXJzdENvbXBvbmVudCwgKGNvbXApID0+IGNvbXAuaWQgPT0gJ2F3ZXNvbWUnKVxuICAgKiBgYGBcbiAgICovXG4gIGdyYWJCeSA9IDxUPihcbiAgICBjbDogQ2xhc3M8VD4sXG4gICAgcHJlZGljYXRlOiAoY29tcDogSW5zdGFuY2VUeXBlPHR5cGVvZiBjbD4pID0+IGJvb2xlYW5cbiAgKTogeyBlbnRpdHk6IEVudGl0eTxDVD47IGNvbXBvbmVudDogSW5zdGFuY2VUeXBlPHR5cGVvZiBjbD4gfSB8IG51bGwgPT4ge1xuICAgIGNvbnN0IGVudGl0aWVzID0gdGhpcy5sb2NhdGVBbGwoKGNsIGFzIHVua25vd24pIGFzIENUKTtcblxuICAgIGZvciAoY29uc3QgZW50aXR5IG9mIGVudGl0aWVzKSB7XG4gICAgICBjb25zdCBjYyA9XG4gICAgICAgIHRoaXMuY29tcG9uZW50Q29sbGVjdGlvbnMuZ2V0KGVudGl0eS5pZCkgfHxcbiAgICAgICAgbmV3IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+KCk7XG5cbiAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGNjLmdldDxUPihjbCk7XG5cbiAgICAgIGlmIChwcmVkaWNhdGUoY29tcG9uZW50KSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGNvbXBvbmVudCxcbiAgICAgICAgICBlbnRpdHksXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdyYWIgYWxsIHRoZSBjb21wb25lbnRzIHByaW1hcmlseSwgYW5kIHRoZSBlbnRpdGllcyBpZiBuZWVkZWRcbiAgICovXG4gIGdyYWJBbGwgPSA8VD4oXG4gICAgY2w6IENsYXNzPFQ+XG4gICk6IHsgZW50aXR5OiBFbnRpdHk8Q1Q+OyBjb21wb25lbnQ6IEluc3RhbmNlVHlwZTx0eXBlb2YgY2w+IH1bXSA9PiB7XG4gICAgY29uc3QgZW50aXRpZXMgPSB0aGlzLmxvY2F0ZUFsbCgoY2wgYXMgdW5rbm93bikgYXMgQ1QpO1xuXG4gICAgcmV0dXJuIGVudGl0aWVzLm1hcCgoZW50aXR5KSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBlbnRpdHksXG4gICAgICAgIGNvbXBvbmVudDogZW50aXR5LmNvbXBvbmVudHMuZ2V0PFQ+KGNsKSxcbiAgICAgIH07XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdpdmVuIGFuIGVudGl0eSBpZCBhbmQgY29tcG9uZW50VHlwZSwgcmV0dXJucyBjb21wb25lbnRcbiAgICovXG4gIGdldCA9IDxUPihlaWQ6IEVudGl0eUlkLCBjbDogQ2xhc3M8VD4pOiBJbnN0YW5jZVR5cGU8dHlwZW9mIGNsPiA9PiB7XG4gICAgY29uc3QgY2MgPVxuICAgICAgdGhpcy5jb21wb25lbnRDb2xsZWN0aW9ucy5nZXQoZWlkKSB8fCBuZXcgQ29tcG9uZW50Q29sbGVjdGlvbjxDVD4oKTtcblxuICAgIHJldHVybiBjYy5nZXQ8VD4oY2wpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBGaW5kIGFuZCBnZXQgdGhlIGZpcnN0IGluc3RhbmNlIG9mIGEgY29tcG9uZW50LCB3aXRob3V0IGFueSBhc3NvY2lhdGVkIGVudGl0aWVzLlxuICAgKiBIZWxwZnVsIGlzIHlvdSBrbm93IHRoYXQgb25seSBvbmUgaW5zdGFuY2Ugb2YgYSBjb21wb25lbnQgZXhpc3RzIGFjcm9zcyBhbGwgZW50aXRpZXMuXG4gICAqIEBwYXJhbSBjbCBDb21wb25lbnQgQ2xhc3MgQ29udHJ1Y3RvclxuICAgKiBAcGFyYW0gZGVmYXVsdFZhbHVlIEEgZGVmYXVsdCBjb21wb25lbnQgaW5zdGFuY2UgaWYgbm8gY29tcG9uZW50cyBhcmUgZm91bmQuXG4gICAqL1xuICBnZXRDb21wb25lbnQgPSA8VD4oXG4gICAgY2w6IENsYXNzPFQ+LFxuICAgIGRlZmF1bHRWYWx1ZT86IEluc3RhbmNlVHlwZTx0eXBlb2YgY2w+XG4gICk6IEluc3RhbmNlVHlwZTx0eXBlb2YgY2w+IHwgbnVsbCA9PiB7XG4gICAgY29uc3QgcmVzdWx0ID0gdGhpcy5ncmFiKGNsKTtcblxuICAgIGlmICghcmVzdWx0KSB7XG4gICAgICByZXR1cm4gZGVmYXVsdFZhbHVlID8gZGVmYXVsdFZhbHVlIDogbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0LmNvbXBvbmVudDtcbiAgfTtcblxuICAvKipcbiAgICogR2V0IGFuIGVudGl0eSB0aGF0IGhhcyBiZWVuIHRhZ2dlZCB3aXRoIHRoZSBnaXZlbiB0YWcsIG9yIHJldHVybiBudWxsO1xuICAgKi9cbiAgZ2V0VGFnZ2VkID0gKHRhZzogVGFnKTogRW50aXR5PENUPiB8IG51bGwgPT4ge1xuICAgIGNvbnN0IHRhZ0VudGl0eUlkcyA9IHRoaXMuZW50aXRpZXNCeVRhZ3MuZ2V0KHRhZyk7XG5cbiAgICBpZiAodGFnRW50aXR5SWRzKSB7XG4gICAgICBjb25zdCBlbnRpdHlJZCA9IHRhZ0VudGl0eUlkcy52YWx1ZXMoKS5uZXh0KCkudmFsdWU7XG5cbiAgICAgIGNvbnN0IGVudGl0eSA9IHRoaXMuZW50aXRpZXMuZ2V0KGVudGl0eUlkKTtcblxuICAgICAgaWYgKGVudGl0eSkge1xuICAgICAgICByZXR1cm4gZW50aXR5O1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIC8qKlxuICAgKiBHZXR0IGFsbCBlbnRpdGllcyB0aGF0IGhhdmUgYmVlbiB0YWdnZWQgd2l0aCB0aGUgZ2l2ZW4gdGFnLlxuICAgKiBAcGFyYW0gdGFnIEEgc3RyaW5nIG9yIG51bWJlci5cbiAgICovXG4gIGdldEFsbFRhZ2dlZCA9ICh0YWc6IFRhZyk6IEVudGl0eTxDVD5bXSA9PiB7XG4gICAgbGV0IGVudGl0aWVzOiBFbnRpdHk8Q1Q+W10gPSBbXTsgLy8gZXNsaW50LWRpc2FibGUtbGluZVxuXG4gICAgY29uc3QgdGFnRW50aXR5SWRzID0gdGhpcy5lbnRpdGllc0J5VGFncy5nZXQodGFnKTtcblxuICAgIGlmICh0YWdFbnRpdHlJZHMpIHtcbiAgICAgIGZvciAoY29uc3QgZW50aXR5SWQgb2YgdGFnRW50aXR5SWRzKSB7XG4gICAgICAgIGNvbnN0IGVudGl0eSA9IHRoaXMuZW50aXRpZXMuZ2V0KGVudGl0eUlkKTtcbiAgICAgICAgaWYgKGVudGl0eSkge1xuICAgICAgICAgIGVudGl0aWVzLnB1c2goZW50aXR5KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBlbnRpdGllcztcbiAgfTtcblxuICAvKipcbiAgICogU2V0IGEgY29tcG9uZW50IG9uIHRoZSBnaXZlbiBlbnRpdHlcbiAgICovXG4gIHNldCA9IChlaWQ6IEVudGl0eUlkLCBjb21wb25lbnQ6IEluc3RhbmNlVHlwZTxDVD4pOiB0aGlzID0+IHtcbiAgICBjb25zdCBjYyA9XG4gICAgICB0aGlzLmNvbXBvbmVudENvbGxlY3Rpb25zLmdldChlaWQpIHx8IG5ldyBDb21wb25lbnRDb2xsZWN0aW9uPENUPigpO1xuXG4gICAgY2MuYWRkKGNvbXBvbmVudCk7XG5cbiAgICB0aGlzLmNvbXBvbmVudENvbGxlY3Rpb25zLnNldChlaWQsIGNjKTtcblxuICAgIGZvciAoY29uc3QgW2N0QXJyLCBlbnRpdHlTZXRdIG9mIHRoaXMuZW50aXRpZXNCeUNUeXBlcykge1xuICAgICAgaWYgKChjdEFyciBhcyBzdHJpbmdbXSkuZXZlcnkoY2MuaGFzQnlOYW1lKSkge1xuICAgICAgICBlbnRpdHlTZXQuYWRkKGVpZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhIGNvbXBvbmVudCBmcm9tIHRoZSBnaXZlbiBlbnRpdHkuXG4gICAqIE5PVEU6IFRoaXMgd2lsbCBjaGFuZ2Ugd2hhdCBzeXN0ZW1zIHdpbGwgYmUgY2FsbGVkIG9uIHRoZSBlbnRpdHkuXG4gICAqL1xuICByZW1vdmUgPSAoZWlkOiBFbnRpdHlJZCwgY1R5cGU6IENUKTogdGhpcyA9PiB7XG4gICAgY29uc3QgY2MgPVxuICAgICAgdGhpcy5jb21wb25lbnRDb2xsZWN0aW9ucy5nZXQoZWlkKSB8fCBuZXcgQ29tcG9uZW50Q29sbGVjdGlvbjxDVD4oKTtcblxuICAgIC8vIHJlbW92ZSBlbnRpdHkgZnJvbSBjdXJyZW50IGVudGl0aWVzQnlDVHlwZXNcbiAgICBmb3IgKGNvbnN0IFtjdEFyciwgZW50aXR5U2V0XSBvZiB0aGlzLmVudGl0aWVzQnlDVHlwZXMpIHtcbiAgICAgIGlmICgoY3RBcnIgYXMgc3RyaW5nW10pLmV2ZXJ5KGNjLmhhc0J5TmFtZSkpIHtcbiAgICAgICAgZW50aXR5U2V0LmRlbGV0ZShlaWQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNjLnJlbW92ZShjVHlwZSk7XG5cbiAgICAvLyBNb3ZlIGVudGl0eUlkIHRvIG5ldyBDVHlwZXMgaWYgbmVlZGVkLlxuICAgIGZvciAoY29uc3QgW2N0QXJyLCBlbnRpdHlTZXRdIG9mIHRoaXMuZW50aXRpZXNCeUNUeXBlcykge1xuICAgICAgaWYgKChjdEFyciBhcyBzdHJpbmdbXSkuZXZlcnkoY2MuaGFzQnlOYW1lKSkge1xuICAgICAgICBlbnRpdHlTZXQuYWRkKGVpZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEludGVybmFsIG1ldGhvZCB1c2VkIGluIHNldHRpbmcgdXAgYSBuZXcgc3lzdGVtLlxuICAgKi9cbiAgcmVnaXN0ZXJTeXN0ZW0oY05hbWVzOiBzdHJpbmdbXSwgc3lzdGVtTmFtZTogc3RyaW5nKTogdGhpcyB7XG4gICAgdGhpcy5jb21wTmFtZXNCeVN5c3RlbU5hbWUuc2V0KHN5c3RlbU5hbWUsIFsuLi5jTmFtZXNdKTtcbiAgICB0aGlzLmVudGl0aWVzQnlDVHlwZXMuc2V0KGNOYW1lcywgbmV3IFNldDxFbnRpdHlJZD4oKSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBhbiBhbGlhcyBmb3IgY3JlYXRlU3lzdGVtKCkuXG4gICAqL1xuICBjcmVhdGVTeXN0ZW0oY2w6IENUW10sIHN5c3RlbUZ1bmM6IFN5c3RlbUZ1bmM8Q1Q+KTogU3lzdGVtIHtcbiAgICBjb25zdCBzeXN0ZW0gPSBjcmVhdGVTeXN0ZW08Q1Q+KHRoaXMsIGNsLCBzeXN0ZW1GdW5jKTtcblxuICAgIHJldHVybiBzeXN0ZW07XG4gIH1cblxuICByZWdpc3RlckVudGl0eShlbnRpdHk6IEVudGl0eTxDVD4pOiBXb3JsZDxDVD4ge1xuICAgIGNvbnN0IGNjID0gbmV3IENvbXBvbmVudENvbGxlY3Rpb248Q1Q+KCk7XG5cbiAgICB0aGlzLmNvbXBvbmVudENvbGxlY3Rpb25zLnNldChlbnRpdHkuaWQsIGNjKTtcbiAgICB0aGlzLmVudGl0aWVzLnNldChlbnRpdHkuaWQsIGVudGl0eSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgYWxsIGNvbXBvbmVudHMgdGhhdCBiZWxvbmcgdG8gYW4gZW50aXR5LlxuICAgKi9cbiAgY2xlYXJFbnRpdHlDb21wb25lbnRzKGVpZDogRW50aXR5SWQpOiB0aGlzIHtcbiAgICB0aGlzLmNvbXBvbmVudENvbGxlY3Rpb25zLnNldChlaWQsIG5ldyBDb21wb25lbnRDb2xsZWN0aW9uPENUPigpKTtcblxuICAgIGZvciAoY29uc3QgZW50aXR5U2V0IG9mIHRoaXMuZW50aXRpZXNCeUNUeXBlcy52YWx1ZXMoKSkge1xuICAgICAgaWYgKGVudGl0eVNldC5oYXMoZWlkKSkge1xuICAgICAgICBlbnRpdHlTZXQuZGVsZXRlKGVpZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGFuIGVudGl0eSB0aGF0IGlzIGluIHRoZSB3b3JsZC5cbiAgICogQmFzaWNhbGx5IGp1c3QgbmV3IEVudGl0eSh3b3JsZCksIGJ1dCBzYXZlcyBhbiBpbXBvcnQgb2YgRW50aXR5LlxuICAgKi9cbiAgY3JlYXRlRW50aXR5KCk6IEVudGl0eTxDVD4ge1xuICAgIGNvbnN0IGVudGl0eSA9IG5ldyBFbnRpdHkodGhpcyk7XG5cbiAgICByZXR1cm4gZW50aXR5O1xuICB9XG5cbiAgLyoqXG4gICAqIERlc3Ryb3lzIGFuIGVudGl0eS5cbiAgICogU2FtZSBhcyBlbnRpdHkuZGVzdHJveSgpLlxuICAgKi9cbiAgZGVzdHJveUVudGl0eShlaWQ6IEVudGl0eUlkKTogV29ybGQ8Q1Q+IHtcbiAgICB0aGlzLmNvbXBvbmVudENvbGxlY3Rpb25zLmRlbGV0ZShlaWQpO1xuICAgIHRoaXMuZW50aXRpZXMuZGVsZXRlKGVpZCk7XG5cbiAgICBmb3IgKGNvbnN0IGVudGl0eVNldCBvZiB0aGlzLmVudGl0aWVzQnlDVHlwZXMudmFsdWVzKCkpIHtcbiAgICAgIGlmIChlbnRpdHlTZXQuaGFzKGVpZCkpIHtcbiAgICAgICAgZW50aXR5U2V0LmRlbGV0ZShlaWQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIHJlbW92ZSBhbnkgdGFnIGFzc29jaWF0aW9ucyB3aXRoIGRlc3Ryb3llZCBlbnRpdGllcy5cbiAgICBmb3IgKGNvbnN0IFt0YWcsIGVudGl0eVNldF0gb2YgdGhpcy5lbnRpdGllc0J5VGFncykge1xuICAgICAgaWYgKGVudGl0eVNldC5oYXMoZWlkKSkge1xuICAgICAgICBlbnRpdHlTZXQuZGVsZXRlKGVpZCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChlbnRpdHlTZXQuc2l6ZSA9PT0gMCkge1xuICAgICAgICB0aGlzLmVudGl0aWVzQnlUYWdzLmRlbGV0ZSh0YWcpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9XG59XG4iLCJpbXBvcnQgV29ybGQgZnJvbSAnLi9Xb3JsZCc7XG5pbXBvcnQgeyBjcmVhdGVFbnRpdHkgfSBmcm9tICcuL0VudGl0eSc7XG5pbXBvcnQgeyBjcmVhdGVTeXN0ZW0gfSBmcm9tICcuL1N5c3RlbSc7XG5cbmV4cG9ydCB7XG4gIFdvcmxkLFxuICBjcmVhdGVFbnRpdHksXG4gIGNyZWF0ZVN5c3RlbSxcbn07XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///1\n')}])}));